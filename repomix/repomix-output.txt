This file is a merged representation of the entire codebase, combining all repository files into a single document.
Generated by Repomix on: 2024-12-08T16:48:18.105Z

================================================================
File Summary
================================================================

Purpose:
--------
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.

File Format:
------------
The content is organized as follows:
1. This summary section
2. Repository information
3. Repository structure
4. Multiple file entries, each consisting of:
  a. A separator line (================)
  b. The file path (File: path/to/file)
  c. Another separator line
  d. The full contents of the file
  e. A blank line

Usage Guidelines:
-----------------
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.

Notes:
------
- Some files may have been excluded based on .gitignore rules and Repomix's
  configuration.
- Binary files are not included in this packed representation. Please refer to
  the Repository Structure section for a complete list of file paths, including
  binary files.

Additional Info:
----------------

For more information about Repomix, visit: https://github.com/yamadashy/repomix

================================================================
Repository Structure
================================================================
.eslintrc.json
.gitignore
.repomixignore
jest.config.js
next.config.js
package.json
postcss.config.mjs
README.md
repomix.config.json
scripts/create-nojekyll.js
scripts/find-feature-types.ps1
scripts/find-interfaces.ps1
scripts/fix-imports-v6.js
scripts/fix-imports.js
scripts/reorganise-components.js
scripts/reorganise-features.js
scripts/reorganize-types.js
scripts/update-types.js
serve.json
src/app/about/page.tsx
src/app/error.tsx
src/app/exercise/page.tsx
src/app/history/page.tsx
src/app/layout.tsx
src/app/not-found.tsx
src/app/page.tsx
src/app/replay/page.tsx
src/components/common/CentredImage/index.tsx
src/components/common/Instructions/index.tsx
src/components/common/Instructions/types.ts
src/components/common/Modal/index.tsx
src/components/common/Modal/types.ts
src/components/common/Navigation/index.tsx
src/components/common/OfflineIndicator/index.tsx
src/components/common/PWAPrompt/index.tsx
src/components/features/Cards/components/AnimatedCard.tsx
src/components/features/Cards/components/Card.tsx
src/components/features/Cards/components/CardContent.tsx
src/components/features/Cards/components/CardControls.tsx
src/components/features/Cards/components/CardMoveOptions.tsx
src/components/features/Cards/components/index.ts
src/components/features/Cards/components/MobileCardActions/index.tsx
src/components/features/Cards/components/styles.ts
src/components/features/Cards/hooks/useCardDragAnimation.ts
src/components/features/Cards/types.ts
src/components/features/Categories/components/CategoryColumn/index.tsx
src/components/features/Categories/components/Mobile/CategorySelectionOverlay.tsx
src/components/features/Categories/constants/categories.ts
src/components/features/Categories/types.ts
src/components/features/Categories/utils/categoryUtils.ts
src/components/features/Exercise/commands/BaseCommand.ts
src/components/features/Exercise/commands/Command.ts
src/components/features/Exercise/commands/DropCommand.ts
src/components/features/Exercise/commands/MoveCommand.ts
src/components/features/Exercise/components/CoreValueReasoning/index.tsx
src/components/features/Exercise/components/Results/index.tsx
src/components/features/Exercise/hooks/useCommands.ts
src/components/features/Exercise/hooks/useGameInit.ts
src/components/features/Exercise/hooks/useGameState.ts
src/components/features/Exercise/hooks/useSession.ts
src/components/features/Exercise/types.ts
src/components/features/Exercise/utils/index.ts
src/components/features/Exercise/utils/sessionLoader.ts
src/components/features/Exercise/utils/sessionUtils.ts
src/components/features/History/components/DeleteConfirmationModal/index.tsx
src/components/features/History/components/SessionList/DesktopSessionList.tsx
src/components/features/History/components/SessionList/index.tsx
src/components/features/History/components/SessionList/MobileSessionList.tsx
src/components/features/History/contexts/SessionSelectionContext.tsx
src/components/features/History/hooks/useHistoryInit.ts
src/components/features/History/types.ts
src/components/features/Home/components/StartScreen/index.tsx
src/components/features/Home/types.ts
src/components/features/Home/utils/index.ts
src/components/features/Home/utils/valuesUtils.ts
src/components/features/Replay/components/MobileReplayCategories/index.tsx
src/components/features/Replay/components/ReplayClient/index.tsx
src/components/features/Replay/components/ReplayColumn/index.tsx
src/components/features/Replay/hooks/useCardAnimation.ts
src/components/features/Replay/hooks/useReplayState.ts
src/components/features/Replay/types.ts
src/components/features/Round/CategoryGrid.tsx
src/components/features/Round/components/Mobile/MobileCardControls.tsx
src/components/features/Round/components/Mobile/MobileCategoryRow.tsx
src/components/features/Round/components/Mobile/MobileSelectionOverlay.tsx
src/components/features/Round/components/MobileCardView.tsx
src/components/features/Round/components/MobileCategoryList.tsx
src/components/features/Round/components/StatusMessage.tsx
src/components/features/Round/hooks/useMobileInteractions.ts
src/components/features/Round/hooks/useMobileView.ts
src/components/features/Round/hooks/useRoundHandlers.ts
src/components/features/Round/hooks/useRoundState.ts
src/components/features/Round/hooks/useRoundStatus.ts
src/components/features/Round/hooks/useRoundValidation.ts
src/components/features/Round/index.ts
src/components/features/Round/RoundActions.tsx
src/components/features/Round/RoundHeader.tsx
src/components/features/Round/RoundUI.tsx
src/components/features/Round/RoundUIDebug.tsx
src/components/features/Round/types.ts
src/components/features/Round/utils/categoryUtils.ts
src/config/config.json
src/data/values.json
src/hooks/useSessionReconstruction.ts
src/lib/contexts/MobileContext.tsx
src/lib/db/indexedDB.ts
src/lib/hooks/useAnimation.ts
src/lib/hooks/usePWA.ts
src/lib/store/store.ts
src/lib/types/Animation.ts
src/lib/types/BaseCommand.ts
src/lib/types/Categories.ts
src/lib/types/Category.ts
src/lib/types/CategoryName.ts
src/lib/types/Command.ts
src/lib/types/CompletedSession.ts
src/lib/types/Context.ts
src/lib/types/DropCommandPayload.ts
src/lib/types/index.ts
src/lib/types/MoveCommandPayload.ts
src/lib/types/Position.ts
src/lib/types/PWA.ts
src/lib/types/Round.ts
src/lib/types/serviceWorker.d.ts
src/lib/types/Session.ts
src/lib/types/SessionReconstruction.ts
src/lib/types/StoreState.ts
src/lib/types/Value.ts
src/lib/utils/animation/index.ts
src/lib/utils/animation/transitions.ts
src/lib/utils/animation/variants.ts
src/lib/utils/cache/index.ts
src/lib/utils/config/envUtils.ts
src/lib/utils/config/gameConfig.ts
src/lib/utils/config/index.ts
src/lib/utils/debug/index.ts
src/lib/utils/dom/index.ts
src/lib/utils/email/emailUtils.ts
src/lib/utils/index.ts
src/lib/utils/storage/cacheUtils.ts
src/lib/utils/storage/index.ts
src/lib/utils/storage/storeUtils.ts
src/lib/worker/index.ts
src/styles/globals.css
tailwind.config.ts
tests/components/Card.test.tsx
tests/lighthouse/localhost_3000-20241207T170739.json
tests/setup.ts
tests/utils/mockData.ts
tsconfig.json

================================================================
Repository Files
================================================================

================
File: .eslintrc.json
================
{
  "extends": [
    "next",
    "next/core-web-vitals"
  ],
  "rules": {
    "@next/next/no-img-element": "off"
  }
}

================
File: .gitignore
================
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/versions

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# PWA files
/public/sw.js
/public/workbox-*.js
/public/worker-*.js
/public/sw.js.map
/public/workbox-*.js.map
/public/worker-*.js.map
/public/fallback-*.js

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# env files (can opt-in for commiting if needed)
.env*

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts

/repomix

================
File: .repomixignore
================
# Add patterns to ignore here, one per line
# Example:
*.log
tmp/
repomix/
public/
out/
node_modules/
.vscode/
.github/

================
File: jest.config.js
================
const nextJest = require('next/jest');

const createJestConfig = nextJest({
  dir: './',
});

const customJestConfig = {
  setupFilesAfterEnv: ['<rootDir>/tests/setup.ts'],
  testEnvironment: 'jest-environment-jsdom',
  moduleNameMapper: {
    '^@/(.*)$': '<rootDir>/src/$1',
  },
};

module.exports = createJestConfig(customJestConfig);

================
File: next.config.js
================
const withPWA = require('next-pwa')({
  dest: 'public',
  register: true,
  skipWaiting: true, // Changed to true
  disable: process.env.NODE_ENV === 'development',
  buildExcludes: [/middleware-manifest\.json$/],
  publicExcludes: ['!manifest.webmanifest'],
  runtimeCaching: [
    {
      urlPattern: /^https?.*/,
      handler: 'NetworkFirst',
      options: {
        cacheName: 'core-values-cache',
        expiration: {
          maxEntries: 200,
          maxAgeSeconds: 24 * 60 * 60 // 24 hours
        },
        networkTimeoutSeconds: 10,
        backgroundSync: {
          name: 'core-values-queue',
          options: {
            maxRetentionTime: 24 * 60 // Retry for max of 24 Hours
          }
        }
      }
    }
  ]
})

/** @type {import('next').NextConfig} */
// const nextConfig = {
//   reactStrictMode: true,
//   output: 'export',
//   images: {
//     unoptimized: true
//   },
//   basePath: process.env.NODE_ENV === 'production' ? '' : '',
//   webpack: (config) => {
//     config.experiments = {
//       ...config.experiments,
//       asyncWebAssembly: false,
//       syncWebAssembly: false,
//     };
//     return config;
//   },
//   env: {
//     BUILD_TIME: new Date().toISOString(),
//     CACHE_VERSION: Date.now().toString(),
//     NEXT_PUBLIC_VERSION: process.env.NEXT_PUBLIC_VERSION || require('./package.json').version
//   }
// }

const nextConfig = {
  reactStrictMode: true,
  webpack: (config, { dev, isServer }) => {
    // Production optimizations only
    if (!dev && !isServer) {
      config.optimization = {
        ...config.optimization,
        mergeDuplicateChunks: true,
        minimize: true,
        moduleIds: 'deterministic',
        splitChunks: {
          chunks: 'all',
          minSize: 20000,
          minRemainingSize: 0,
          minChunks: 1,
          maxAsyncRequests: 30,
          maxInitialRequests: 30,
          cacheGroups: {
            defaultVendors: {
              test: /[\\/]node_modules[\\/]/,
              priority: -10,
              reuseExistingChunk: true,
            },
            default: {
              minChunks: 2,
              priority: -20,
              reuseExistingChunk: true,
            },
          },
        },
      };
    }
    return config;
  },
}

module.exports = withPWA(nextConfig);

================
File: package.json
================
{
  "name": "digitalanalogue9.github.io",
  "version": "1.0.0",
  "private": true,
  "scripts": {
    "clean": "rimraf .next && rimraf node_modules/.cache",
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "test": "jest",
    "export": "next export",
    "test:watch": "jest --watch",
    "reorganise": "node scripts/reorganise-features.js"
  },
  "dependencies": {
    "@heroicons/react": "^2.1.5",
    "framer-motion": "^11.11.11",
    "idb": "^8.0.0",
    "next": "^15.0.3",
    "next-pwa": "^5.6.0",
    "react": "^18.3.1",
    "react-dnd": "^16.0.1",
    "react-dnd-html5-backend": "^16.0.1",
    "react-dom": "^18.3.1",
    "zustand": "^5.0.1"
  },
  "devDependencies": {
    "@babel/generator": "^7.26.2",
    "@babel/parser": "^7.26.2",
    "@babel/traverse": "^7.25.9",
    "@babel/types": "^7.26.0",
    "@testing-library/jest-dom": "^6.6.3",
    "@testing-library/react": "^16.0.1",
    "@types/jest": "^29.5.14",
    "@types/node": "^22.9.0",
    "@types/react": "^18.3.12",
    "@types/react-dom": "^18.3.1",
    "autoprefixer": "^10.4.20",
    "eslint": "^9.14.0",
    "eslint-config-next": "15.0.3",
    "fs-extra": "^11.2.0",
    "glob": "^11.0.0",
    "jest": "^29.7.0",
    "jest-environment-jsdom": "^29.7.0",
    "postcss": "^8.4.47",
    "tailwindcss": "^3.4.14",
    "typescript": "^5.6.3"
  }
}

================
File: postcss.config.mjs
================
/** @type {import('postcss-load-config').Config} */
const config = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
};

export default config;

================
File: README.md
================
This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).

# Core Values Application

A web application to help individuals discover and prioritise their personal values through an interactive card sorting exercise.

## Features

- Interactive drag-and-drop interface for sorting values
- Multiple rounds of refinement 
- Progress saving using IndexedDB
- History view of previous sessions
- Printable results
- Responsive design
## Getting Started

First, run the development server:

### Prerequisites

- Node.js 18.x or higher
- npm 9.x or higher

### Installation

1. Clone the repository:
```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
git clone https://github.com/digitalanalogue9/digitalanalogue9.github.io.git
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.

================
File: repomix.config.json
================
{
  "output": {
    "filePath": "repomix\\repomix-output.txt",
    "style": "plain",
    "removeComments": false,
    "removeEmptyLines": false,
    "topFilesLength": 5,
    "showLineNumbers": false,
    "copyToClipboard": false
  },
  "include": [],
  "ignore": {
    "useGitignore": true,
    "useDefaultPatterns": true,
    "customPatterns": []
  },
  "security": {
    "enableSecurityCheck": true
  }
}

================
File: scripts/create-nojekyll.js
================
const fs = require('fs');
const path = require('path');

const nojekyllPath = path.join(process.cwd(), 'out', '.nojekyll');

try {
  fs.writeFileSync(nojekyllPath, '');
  console.log('.nojekyll file created successfully');
} catch (err) {
  console.error('Error creating .nojekyll file:', err);
  process.exit(1);
}

================
File: scripts/find-feature-types.ps1
================
$srcPath = "src/components/features"
$features = Get-ChildItem -Path $srcPath -Directory

foreach ($feature in $features) {
    Write-Output "`nAnalyzing feature: $($feature.Name)"
    
    # Check if types.ts exists
    $typesFile = Join-Path $feature.FullName "types.ts"
    if (Test-Path $typesFile) {
        Write-Output "✓ Has types.ts"
    } else {
        Write-Output "✗ No types.ts file"
    }
    
    # Find files with interface definitions
    Write-Output "`nSearching for interface definitions..."
    $files = Get-ChildItem -Path $feature.FullName -Recurse -Include *.ts,*.tsx |
        Where-Object { $_.Name -ne "types.ts" }
    
    foreach ($file in $files) {
        $content = Get-Content $file.FullName -Raw
        if ($content -match "export\s+interface\s+\w+") {
            Write-Output "`nFile with interfaces: $($file.FullName)"
            $matches = [regex]::Matches($content, "(?ms)export\s+interface\s+\w+[^{]*{[^}]*}")
            foreach ($match in $matches) {
                Write-Output "`nInterface found:"
                Write-Output $match.Value
            }
        }
    }
}

================
File: scripts/find-interfaces.ps1
================
$searchPath = "src"
$pattern = "export\s+interface\s+\w+"

Write-Output "Scanning for interface definitions in $searchPath..."
Write-Output "----------------------------------------`n"

Get-ChildItem -Path $searchPath -Recurse -Include *.tsx,*.ts | 
Where-Object { $_.Name -ne "types.ts" } |
ForEach-Object {
    $content = Get-Content $_.FullName -Raw
    if ($content -match $pattern) {
        Write-Output "File: $($_.FullName)"
        # Extract and display the interface definitions
        $matches = [regex]::Matches($content, "(?ms)export\s+interface\s+\w+[^{]*{[^}]*}")
        foreach ($match in $matches) {
            Write-Output "`nInterface found:"
            Write-Output $match.Value
            Write-Output "----------------------------------------"
        }
    }
}

Write-Output "`nScan complete."

================
File: scripts/fix-imports-v6.js
================
const fs = require('fs-extra');
const path = require('path');
const glob = require('glob');
const parser = require('@babel/parser');
const traverse = require('@babel/traverse').default;
const generate = require('@babel/generator').default;

const ROOT = process.cwd();
const SRC = path.join(ROOT, 'src');

const importMappings = {
  // Types
  '@/types': '@/lib/types',
  '@/types/Value': '@/lib/types',

  // Commands
  '@/commands/DropCommand': '@/components/features/Exercise/commands/DropCommand',
  '@/commands/MoveCommand': '@/components/features/Exercise/commands/MoveCommand',
  '@/commands/BaseCommand': '@/components/features/Exercise/commands/BaseCommand',
  '@/commands': '@/components/features/Exercise/commands',

  // Components
  '@/components/Round': '@/components/features/Round',
  '@/components/Card': '@/components/features/Cards/components',
  '@/components/Results': '@/components/features/Exercise/components/Results',
  '@/components/StartScreen': '@/components/features/Exercise/components/StartScreen',
  '@/components/Instructions': '@/components/common/Instructions',
  '@/components/PWAPrompt': '@/components/common/PWAPrompt',
  '@/components/CategoryColumn': '@/components/features/Categories/components/CategoryColumn',
  '../components/Round': '@/components/features/Round',
  '../components/StartScreen': '@/components/features/Exercise/components/StartScreen',
  '../components/Instructions': '@/components/common/Instructions',
  '../CategoryColumn': '@/components/features/Categories/components/CategoryColumn',
  './Card': '@/components/features/Cards/components',

  // Hooks
  '@/hooks/useGameState': '@/components/features/Exercise/hooks/useGameState',
  '@/hooks/useSession': '@/components/features/Exercise/hooks/useSession',
  '@/hooks/useCommands': '@/components/features/Exercise/hooks/useCommands',
  '@/hooks/usePWA': '@/lib/hooks/usePWA',
  '../hooks/useGameState': '@/components/features/Exercise/hooks/useGameState',
  '../hooks/useSession': '@/components/features/Exercise/hooks/useSession',
  '../hooks/usePWA': '@/lib/hooks/usePWA',

  // Utils
  '@/utils': '@/lib/utils',
  '@/utils/storage': '@/lib/utils/storage',
  '@/utils/cache': '@/lib/utils/cache',
  '../utils/storage': '@/lib/utils/storage',
  '@/utils/debug/renderLogger': '@/lib/utils/debug/renderLogger',
  '@/utils/config': '@/lib/utils/config',
  '@/utils/categoryUtils': '@/components/features/Categories/utils/categoryUtils',

  // DB
  '@/db/indexedDB': '@/lib/db/indexedDB',
  '../db/indexedDB': '@/lib/db/indexedDB',

  // Store
  '@/store/store': '@/lib/store/store',

  // Contexts
  '@/contexts/MobileContext': '@/lib/contexts/MobileContext',

  // Data
  '../data/values.json': '@/data/values.json',
};

async function updateImports(filePath) {
  try {
    const content = await fs.readFile(filePath, 'utf-8');
    let modified = false;

    // Parse the file
    const ast = parser.parse(content, {
      sourceType: 'module',
      plugins: ['typescript', 'jsx']
    });

    // Track any imports that weren't mapped
    const unmappedImports = new Set();

    traverse(ast, {
      ImportDeclaration(path) {
        const importPath = path.node.source.value;
        let wasUpdated = false;

        // Handle both absolute and relative imports
        if (importPath.startsWith('@/') || importPath.startsWith('.')) {
          for (const [oldPath, newPath] of Object.entries(importMappings)) {
            if (importPath === oldPath || importPath.startsWith(oldPath + '/')) {
              path.node.source.value = importPath.replace(oldPath, newPath);
              modified = true;
              wasUpdated = true;
              break;
            }
          }

          if (!wasUpdated && (importPath.startsWith('@/') || importPath.startsWith('..'))) {
            unmappedImports.add(importPath);
          }
        }
      }
    });

    if (modified) {
      const output = generate(ast, {}, content);
      await fs.writeFile(filePath, output.code);
      console.log(`✓ Updated imports in: ${filePath}`);
    }

    if (unmappedImports.size > 0) {
      console.log(`\n⚠️  Unmapped imports in ${filePath}:`);
      unmappedImports.forEach(imp => console.log(`   ${imp}`));
    }

  } catch (error) {
    console.error(`\n✗ Error processing ${filePath}:`, error.message);
    console.error(`   File: ${filePath}`);
  }
}

async function main() {
  try {
    console.log('Starting import path updates...');
    
    // Get all TypeScript/JavaScript files
    const files = glob.sync('**/*.{ts,tsx}', {
      cwd: SRC,
      absolute: true,
      nodir: true,
      windowsPathsNoEscape: true
    });
    
    console.log(`Found ${files.length} files to process`);

    if (files.length === 0) {
      console.log('No files found to process');
      return;
    }

    // Sort files to process in a predictable order
    files.sort();
    
    let processedCount = 0;
    let errorCount = 0;
    
    // Process each file
    for (const file of files) {
      try {
        await updateImports(file);
        processedCount++;
      } catch (error) {
        errorCount++;
        console.error(`Failed to process ${file}:`, error);
      }
    }

    console.log('\nImport updates complete!');
    console.log(`Processed ${processedCount} files`);
    if (errorCount > 0) console.log(`Encountered ${errorCount} errors`);

  } catch (error) {
    console.error('Error during import updates:', error);
    process.exit(1);
  }
}

main();

================
File: scripts/fix-imports.js
================
const fs = require('fs-extra');
const path = require('path');
const glob = require('glob');
const parser = require('@babel/parser');
const traverse = require('@babel/traverse').default;
const generate = require('@babel/generator').default;

const ROOT = process.cwd();
const SRC = path.join(ROOT, 'src');

// Comprehensive import mappings based on the new structure
const importMappings = {
  // Base mappings for major sections
  '@/components/features': '@/components/features',
  '@/components/common': '@/components/common',
  '@/lib': '@/lib',

  // Feature-specific mappings
  '@/components/Round': '@/components/features/Round',
  '@/components/Card': '@/components/features/Cards/components',
  '@/components/History': '@/components/features/History/components',
  '@/components/Replay': '@/components/features/Replay/components',
  '@/components/CategoryColumn': '@/components/features/Categories/components/CategoryColumn',
  '@/components/StartScreen': '@/components/features/Exercise/components/StartScreen',
  '@/components/Results': '@/components/features/Exercise/components/Results',
  '@/components/CoreValueReasoning': '@/components/features/Exercise/components/CoreValueReasoning',

  // Common components
  '@/components/Navigation': '@/components/common/Navigation',
  '@/components/Instructions': '@/components/common/Instructions',
  '@/components/PWAPrompt': '@/components/common/PWAPrompt',
  '@/components/OfflineIndicator': '@/components/common/OfflineIndicator',
  '@/components/CentredImage': '@/components/common/CentredImage',

  // Hooks
  '@/hooks/useGameState': '@/components/features/Exercise/hooks/useGameState',
  '@/hooks/useCommands': '@/components/features/Exercise/hooks/useCommands',
  '@/hooks/useSession': '@/components/features/Exercise/hooks/useSession',
  '@/hooks/useCardDragAnimation': '@/components/features/Cards/hooks/useCardDragAnimation',
  '@/hooks/useSessionReconstruction': '@/components/features/Replay/hooks/useSessionReconstruction',
  '@/hooks/useAnimation': '@/lib/hooks/useAnimation',
  '@/hooks/usePWA': '@/lib/hooks/usePWA',

  // Utils
  '@/utils/storage': '@/lib/utils/storage',
  '@/utils/cache': '@/lib/utils/cache',
  '@/utils/email': '@/lib/utils/email',
  '@/utils/dom': '@/lib/utils/dom',
  '@/utils/config': '@/lib/utils/config',
  '@/utils/animation': '@/lib/utils/animation',
  '@/utils/debug': '@/lib/utils/debug',
  '@/utils/game': '@/components/features/Exercise/utils',
  '@/utils/categoryUtils': '@/components/features/Categories/utils/categoryUtils',

  // Types
  '@/types': '@/lib/types',

  // Other core items
  '@/db': '@/lib/db',
  '@/store': '@/lib/store',
  '@/contexts': '@/lib/contexts',
  '@/constants': '@/components/features/Categories/constants',

  // Relative path mappings
  '../components/Round': '@/components/features/Round',
  '../components/StartScreen': '@/components/features/Exercise/components/StartScreen',
  '../components/Instructions': '@/components/common/Instructions',
  '../components/Navigation': '@/components/common/Navigation',
  '../components/PWAPrompt': '@/components/common/PWAPrompt',
  '../hooks/useGameState': '@/components/features/Exercise/hooks/useGameState',
  '../hooks/useSession': '@/components/features/Exercise/hooks/useSession',
  '../hooks/usePWA': '@/lib/hooks/usePWA',
  '../db/indexedDB': '@/lib/db/indexedDB',
  '../utils/storage': '@/lib/utils/storage',
  '../utils/cache': '@/lib/utils/cache',
  '../data/values.json': '@/data/values.json'
};

function createRelativeMapping(importPath) {
  // Convert relative paths to absolute paths for consistent handling
  if (importPath.startsWith('../')) {
    const absolutePath = importPath.replace('../', '@/');
    for (const [oldPath, newPath] of Object.entries(importMappings)) {
      if (absolutePath.startsWith(oldPath)) {
        return newPath + absolutePath.slice(oldPath.length);
      }
    }
  }
  return null;
}

async function updateImports(filePath) {
  try {
    const content = await fs.readFile(filePath, 'utf-8');
    let modified = false;

    // Parse the file
    const ast = parser.parse(content, {
      sourceType: 'module',
      plugins: ['typescript', 'jsx']
    });

    // Track any imports that weren't mapped
    const unmappedImports = new Set();

    traverse(ast, {
      ImportDeclaration(path) {
        const importPath = path.node.source.value;
        let wasUpdated = false;

        // Handle relative paths
        if (importPath.startsWith('../')) {
          const newPath = createRelativeMapping(importPath);
          if (newPath) {
            path.node.source.value = newPath;
            modified = true;
            wasUpdated = true;
          }
        } 
        // Handle absolute paths
        else if (importPath.startsWith('@/')) {
          for (const [oldPath, newPath] of Object.entries(importMappings)) {
            if (importPath.startsWith(oldPath)) {
              path.node.source.value = importPath.replace(oldPath, newPath);
              modified = true;
              wasUpdated = true;
              break;
            }
          }
        }

        if (!wasUpdated && (importPath.startsWith('@/') || importPath.startsWith('..'))) {
          unmappedImports.add(importPath);
        }
      }
    });

    if (modified) {
      const output = generate(ast, {}, content);
      await fs.writeFile(filePath, output.code);
      console.log(`✓ Updated imports in: ${filePath}`);
    }

    if (unmappedImports.size > 0) {
      console.log(`\n⚠️  Unmapped imports in ${filePath}:`);
      unmappedImports.forEach(imp => console.log(`   ${imp}`));
    }

  } catch (error) {
    console.error(`\n✗ Error processing ${filePath}:`, error.message);
    console.error(`   File: ${filePath}`);
  }
}

async function main() {
    try {
        console.log('Starting import path updates...');
        console.log('Source directory:', SRC);

        // Modified glob pattern for Windows
        const files = glob.sync('**/*.{ts,tsx}', {
            cwd: SRC,
            absolute: true,
            nodir: true,
            windowsPathsNoEscape: true
        });

        console.log(`Found ${files.length} files to process`);

        if (files.length === 0) {
            console.log('Searched in:', SRC);
            console.log('No files found. Please check the path.');
            return;
        }

        // Sort files to process in a predictable order
        files.sort();

        // Log first few files to verify correct paths
        console.log('\nFirst few files to process:');
        files.slice(0, 5).forEach(f => console.log(f));

        let processedCount = 0;
        let errorCount = 0;

        // Process each file
        for (const file of files) {
            try {
                await updateImports(file);
                processedCount++;
            } catch (error) {
                errorCount++;
                console.error(`Failed to process ${file}:`, error);
            }
        }

        console.log('\nImport updates complete!');
        console.log(`Processed ${processedCount} files`);
        if (errorCount > 0) console.log(`Encountered ${errorCount} errors`);

    } catch (error) {
        console.error('Error during import updates:', error);
        process.exit(1);
    }
}

main();

================
File: scripts/reorganise-components.js
================
const fs = require('fs-extra');
const path = require('path');
const glob = require('glob');
const parser = require('@babel/parser');
const traverse = require('@babel/traverse').default;
const generate = require('@babel/generator').default;
const t = require('@babel/types');
const readline = require('readline');

const ROOT = process.cwd();

// Create readline interface
const rl = readline.createInterface({
  input: process.stdin,
  output: process.stdout
});

const question = (query) => new Promise((resolve) => rl.question(query, resolve));

// Define the desired order of sections
const SECTION_ORDER = [
  'imports',
  'interfaces',
  'types',
  'constants',
  'refs',
  'hooks',
  'state',
  'effects',
  'handlers',
  'render'
];

function identifySection(node) {
  if (t.isVariableDeclaration(node)) {
    // Check for useState
    if (node.declarations.some(dec => 
      t.isCallExpression(dec.init) && 
      t.isIdentifier(dec.init.callee) && 
      dec.init.callee.name === 'useState'
    )) {
      return 'state';
    }
    
    // Check for useRef
    if (node.declarations.some(dec => 
      t.isCallExpression(dec.init) && 
      t.isIdentifier(dec.init.callee) && 
      dec.init.callee.name === 'useRef'
    )) {
      return 'refs';
    }
    
    // Check for other hooks
    if (node.declarations.some(dec => 
      t.isCallExpression(dec.init) && 
      t.isIdentifier(dec.init.callee) && 
      dec.init.callee.name.startsWith('use')
    )) {
      return 'hooks';
    }

    // Check for constants
    if (node.kind === 'const' && !node.declarations.some(dec => 
      t.isCallExpression(dec.init) && 
      t.isIdentifier(dec.init.callee) && 
      dec.init.callee.name.startsWith('use')
    )) {
      return 'constants';
    }
  }

  // Check for useEffect
  if (t.isExpressionStatement(node) && 
      t.isCallExpression(node.expression) && 
      t.isIdentifier(node.expression.callee) && 
      node.expression.callee.name === 'useEffect') {
    return 'effects';
  }

  // Check for handlers
  if (t.isFunctionDeclaration(node) || 
      (t.isVariableDeclaration(node) && 
       node.declarations.some(dec => 
         t.isArrowFunctionExpression(dec.init) || 
         t.isFunctionExpression(dec.init)
       ))) {
    const name = t.isFunctionDeclaration(node) ? 
      node.id.name : 
      node.declarations[0].id.name;
    if (name.startsWith('handle') || name.includes('Handler')) {
      return 'handlers';
    }
  }

  // Check for interfaces and types
  if (t.isTSInterfaceDeclaration(node)) {
    return 'interfaces';
  }
  if (t.isTSTypeAliasDeclaration(node)) {
    return 'types';
  }

  return null;
}

async function analyzeComponent(filePath) {
  const content = await fs.readFile(filePath, 'utf-8');
  const issues = [];
  
  try {
    const ast = parser.parse(content, {
      sourceType: 'module',
      plugins: ['typescript', 'jsx']
    });

    let componentBody = null;
    let currentSectionOrder = [];

    traverse(ast, {
      FunctionDeclaration(path) {
        if (path.node.body.type === 'BlockStatement') {
          componentBody = path;
          path.node.body.body.forEach(node => {
            const section = identifySection(node);
            if (section) {
              currentSectionOrder.push(section);
            }
          });
        }
      },
      ArrowFunctionExpression(path) {
        if (path.node.body.type === 'BlockStatement') {
          componentBody = path;
          path.node.body.body.forEach(node => {
            const section = identifySection(node);
            if (section) {
              currentSectionOrder.push(section);
            }
          });
        }
      }
    });

    if (!componentBody) {
      return null;
    }

    // Check for section order issues
    let lastSectionIndex = -1;
    currentSectionOrder.forEach((section, index) => {
      const sectionIndex = SECTION_ORDER.indexOf(section);
      if (sectionIndex < lastSectionIndex) {
        issues.push(`${section} appears after ${SECTION_ORDER[lastSectionIndex]}`);
      }
      lastSectionIndex = Math.max(lastSectionIndex, sectionIndex);
    });

    return {
      hasIssues: issues.length > 0,
      issues,
      currentOrder: currentSectionOrder
    };

  } catch (error) {
    console.error(`Error analyzing ${filePath}:`, error);
    return null;
  }
}

async function analyzeComponentStructure(filePath) {
  const content = await fs.readFile(filePath, 'utf-8');
  const details = {
    stateDeclarations: [],
    hooksUsed: [],
    effectsCount: 0,
    handlersCount: 0,
    orderIssues: []
  };
  
  try {
    const ast = parser.parse(content, {
      sourceType: 'module',
      plugins: ['typescript', 'jsx']
    });

    traverse(ast, {
      VariableDeclaration(path) {
        path.node.declarations.forEach(dec => {
          // Collect state declarations
          if (t.isCallExpression(dec.init) && 
              t.isIdentifier(dec.init.callee) && 
              dec.init.callee.name === 'useState') {
            if (t.isArrayPattern(dec.id)) {
              const stateName = dec.id.elements[0].name;
              details.stateDeclarations.push(stateName);
            }
          }
          
          // Collect hook usage
          if (t.isCallExpression(dec.init) && 
              t.isIdentifier(dec.init.callee) && 
              dec.init.callee.name.startsWith('use')) {
            details.hooksUsed.push(dec.init.callee.name);
          }
        });
      },
      
      CallExpression(path) {
        if (t.isIdentifier(path.node.callee) && 
            path.node.callee.name === 'useEffect') {
          details.effectsCount++;
        }
      },
      
      FunctionDeclaration(path) {
        if (path.node.id.name.startsWith('handle')) {
          details.handlersCount++;
        }
      },
      
      ArrowFunctionExpression(path) {
        const parentNode = path.parent;
        if (t.isVariableDeclarator(parentNode) && 
            t.isIdentifier(parentNode.id) && 
            parentNode.id.name.startsWith('handle')) {
          details.handlersCount++;
        }
      }
    });

    return details;

  } catch (error) {
    console.error(`Error analyzing structure of ${filePath}:`, error);
    return null;
  }
}

async function reorganizeComponent(filePath) {
  const content = await fs.readFile(filePath, 'utf-8');
  
  try {
    const ast = parser.parse(content, {
      sourceType: 'module',
      plugins: ['typescript', 'jsx']
    });

    let componentBody = null;
    let sections = {
      imports: [],
      interfaces: [],
      types: [],
      constants: [],
      refs: [],
      hooks: [],
      state: [],
      effects: [],
      handlers: [],
      render: []
    };

    traverse(ast, {
      Program(path) {
        // Handle top-level imports
        path.node.body.forEach(node => {
          if (t.isImportDeclaration(node)) {
            sections.imports.push(node);
          }
        });
      },
      
      FunctionDeclaration(path) {
        if (path.node.body.type === 'BlockStatement') {
          componentBody = path;
        }
      },
      
      ArrowFunctionExpression(path) {
        if (path.node.body.type === 'BlockStatement') {
          componentBody = path;
        }
      }
    });

    if (!componentBody) {
      return false;
    }

    // Categorize statements
    componentBody.node.body.body.forEach(node => {
      const section = identifySection(node);
      if (section) {
        sections[section].push(node);
      } else {
        sections.render.push(node);
      }
    });

    // Rebuild the body in the correct order
    const newBody = [];
    SECTION_ORDER.forEach(section => {
      if (sections[section].length > 0) {
        newBody.push(t.commentBlock(` ${section} `, true));
        newBody.push(...sections[section]);
        newBody.push(t.emptyStatement());
      }
    });

    componentBody.node.body.body = newBody;

    const output = generate(ast, {
      retainLines: true,
      comments: true
    }, content);

    await fs.writeFile(filePath, output.code);
    return true;

  } catch (error) {
    console.error(`Error processing ${filePath}:`, error);
    return false;
  }
}

async function main() {
  try {
    console.log('Analyzing components...\n');
    
    // Find all component files
    const files = glob.sync(path.join(ROOT, 'src', 'components', '**', '*.tsx'));
    
    // Filter out index files and type files
    const componentFiles = files.filter(file => 
      !file.endsWith('index.tsx') && 
      !file.endsWith('.types.tsx') &&
      !file.includes('.test.') &&
      !file.endsWith('Props.tsx')
    );

    // Analyze all components first
    const analysisResults = [];
    for (const file of componentFiles) {
      const analysis = await analyzeComponent(file);
      const details = await analyzeComponentStructure(file);
      if ((analysis && analysis.hasIssues) || details) {
        analysisResults.push({
          file,
          ...analysis,
          details
        });
      }
    }

    if (analysisResults.length === 0) {
      console.log('No components need reorganization.');
      rl.close();
      return;
    }

    // Ask what to do
    const answer = await question(
      'Would you like to:\n' +
      '1. Show detailed report only (no changes)\n' +
      '2. Fix all components\n' +
      '3. Fix components one by one\n' +
      '4. Exit\n' +
      'Enter your choice (1-4): '
    );

    switch (answer) {
      case '1':
        console.log('\nDetailed Component Analysis:\n');
        analysisResults.forEach(({ file, issues, details }) => {
          console.log(`\nFile: ${path.relative(ROOT, file)}`);
          console.log('----------------------------------------');
          if (issues && issues.length > 0) {
            console.log('\nOrder Issues:');
            issues.forEach(issue => console.log(`  - ${issue}`));
          }
          if (details) {
            console.log('\nComponent Structure:');
            if (details.stateDeclarations.length > 0) {
              console.log(`  State declarations (${details.stateDeclarations.length}):`);
              details.stateDeclarations.forEach(state => console.log(`    - ${state}`));
            }
            if (details.hooksUsed.length > 0) {
              console.log(`  Hooks used (${details.hooksUsed.length}):`);
              details.hooksUsed.forEach(hook => console.log(`    - ${hook}`));
            }
            console.log(`  Effects count: ${details.effectsCount}`);
            console.log(`  Handlers count: ${details.handlersCount}`);
          }
          console.log('----------------------------------------\n');
        });
        break;

      case '2':
        console.log('\nFixing all components...');
        for (const { file } of analysisResults) {
          const success = await reorganizeComponent(file);
          console.log(`${success ? '✓' : '✗'} ${path.relative(ROOT, file)}`);
        }
        break;

      case '3':
        console.log('\nFixing components one by one...');
        for (const { file } of analysisResults) {
          const shouldFix = await question(`Fix ${path.relative(ROOT, file)}? (y/n): `);
          if (shouldFix.toLowerCase() === 'y') {
            const success = await reorganizeComponent(file);
            console.log(`${success ? '✓' : '✗'} ${path.relative(ROOT, file)}`);
          }
        }
        break;

      case '4':
      default:
        console.log('Exiting without making changes.');
        break;
    }

    console.log('\nDone!');
    rl.close();

  } catch (error) {
    console.error('Error during component analysis:', error);
    rl.close();
    process.exit(1);
  }
}

main();

================
File: scripts/reorganise-features.js
================
const fs = require('fs-extra');
const path = require('path');
const parser = require('@babel/parser');
const traverse = require('@babel/traverse').default;
const generate = require('@babel/generator').default;
const t = require('@babel/types');
const glob = require('glob');

const ROOT = process.cwd();
const SRC = path.join(ROOT, 'src');

// File movement mapping
const moves = {
  // Game Feature
  game: {
    base: 'src/components/features/Exercise',
    moves: [
      { from: 'src/components/Round', to: 'components/Round' },
      { from: 'src/components/Results.tsx', to: 'components/Results/index.tsx' },
      { from: 'src/components/StartScreen.tsx', to: 'components/StartScreen/index.tsx' },
      { from: 'src/components/StartScreenProps.tsx', to: 'components/StartScreen/types.ts' },
      { from: 'src/components/CoreValueReasoning.tsx', to: 'components/CoreValueReasoning/index.tsx' },
      { from: 'src/commands', to: 'commands' },
      { from: 'src/hooks/useGameState.ts', to: 'hooks/useGameState.ts' },
      { from: 'src/hooks/useCommands.ts', to: 'hooks/useCommands.ts' },
      { from: 'src/hooks/useSession.ts', to: 'hooks/useSession.ts' },
      { from: 'src/utils/game', to: 'utils' }
    ]
  },

  // Cards Feature
  cards: {
    base: 'src/components/features/Cards',
    moves: [
      { from: 'src/components/Card', to: 'components' },
      { from: 'src/hooks/useCardDragAnimation.ts', to: 'hooks/useCardDragAnimation.ts' },
      { from: 'src/components/Mobile/MobileCardActions.tsx', to: 'components/MobileCardActions/index.tsx' }
    ]
  },

  // Categories Feature
  categories: {
    base: 'src/components/features/Categories',
    moves: [
      { from: 'src/components/CategoryColumn.tsx', to: 'components/CategoryColumn/index.tsx' },
      { from: 'src/components/CategoryColumnProps.tsx', to: 'components/CategoryColumn/types.ts' },
      { from: 'src/constants/categories.ts', to: 'constants/categories.ts' },
      { from: 'src/utils/categoryUtils.ts', to: 'utils/categoryUtils.ts' },
      { from: 'src/components/Mobile/CategorySelectionOverlay.tsx', to: 'components/Mobile/CategorySelectionOverlay.tsx' }
    ]
  },

  // History Feature
  history: {
    base: 'src/components/features/History',
    moves: [
      { from: 'src/components/History/SessionList.tsx', to: 'components/SessionList/index.tsx' }
    ]
  },

  // Replay Feature
  replay: {
    base: 'src/components/features/Replay',
    moves: [
      { from: 'src/components/Replay/ReplayClient.tsx', to: 'components/ReplayClient/index.tsx' },
      { from: 'src/components/Replay/components/ReplayColumn.tsx', to: 'components/ReplayColumn/index.tsx' },
      { from: 'src/components/Replay/components/MobileReplayCategories.tsx', to: 'components/MobileReplayCategories/index.tsx' },
      { from: 'src/components/Replay/hooks/useCardAnimation.ts', to: 'hooks/useCardAnimation.ts' },
      { from: 'src/components/Replay/hooks/useReplayState.ts', to: 'hooks/useReplayState.ts' }
    ]
  },

  // Common Components
  common: {
    base: 'src/components/common',
    moves: [
      { from: 'src/components/Navigation.tsx', to: 'Navigation/index.tsx' },
      { from: 'src/components/Instructions.tsx', to: 'Instructions/index.tsx' },
      { from: 'src/components/InstructionsProps.tsx', to: 'Instructions/types.ts' },
      { from: 'src/components/OfflineIndicator.tsx', to: 'OfflineIndicator/index.tsx' },
      { from: 'src/components/PWAPrompt.tsx', to: 'PWAPrompt/index.tsx' },
      { from: 'src/components/CentredImage.tsx', to: 'CentredImage/index.tsx' }
    ]
  },

  // Library
  lib: {
    base: 'src/lib',
    moves: [
      { from: 'src/contexts/MobileContext.tsx', to: 'contexts/MobileContext.tsx' },
      { from: 'src/store', to: 'store' },
      { from: 'src/db', to: 'db' },
      { from: 'src/types', to: 'types' },
      { from: 'src/worker', to: 'worker' },
      { from: 'src/utils/animation', to: 'utils/animation' },
      { from: 'src/utils/cache', to: 'utils/cache' },
      { from: 'src/utils/config', to: 'utils/config' },
      { from: 'src/utils/dom', to: 'utils/dom' },
      { from: 'src/utils/storage', to: 'utils/storage' },
      { from: 'src/utils/debug', to: 'utils/debug' },
      { from: 'src/hooks/useAnimation.ts', to: 'hooks/useAnimation.ts' },
      { from: 'src/hooks/usePWA.ts', to: 'hooks/usePWA.ts' }
    ]
  },

  // Assets
  assets: {
    base: 'src',
    moves: [
      { from: 'src/app/globals.css', to: 'styles/globals.css' },
      { from: 'src/app/fonts', to: 'assets/fonts' }
    ]
  }
};

// Import mappings for updating import statements
const importMappings = {
  '@/components/Card': '@/features/Cards',
  '@/components/Round': '@/features/Exercise/components/Round',
  '@/components/Mobile': '@/features/Mobile',
  '@/components/History': '@/features/History',
  '@/components/Replay': '@/features/Replay',
  '@/hooks/useGameState': '@/features/Exercise/hooks/useGameState',
  '@/hooks/useCommands': '@/features/Exercise/hooks/useCommands',
  '@/hooks/useSession': '@/features/Exercise/hooks/useSession',
  '@/hooks/useCardDragAnimation': '@/features/Cards/hooks/useCardDragAnimation',
  '@/contexts/MobileContext': '@/lib/contexts/MobileContext',
  '@/utils/game': '@/features/Exercise/utils',
  '@/utils/categoryUtils': '@/features/Categories/utils/categoryUtils',
  '@/constants/categories': '@/features/Categories/constants/categories',
  '@/types': '@/lib/types',
  '@/store': '@/lib/store',
  '@/db': '@/lib/db',
  '@/worker': '@/lib/worker'
};

async function createDirectories() {
  const allDirs = Object.values(moves).map(({ base }) => base);
  for (const dir of allDirs) {
    await fs.ensureDir(path.join(ROOT, dir));
    console.log(`Created directory: ${dir}`);
  }
}

async function moveFiles() {
  for (const feature of Object.values(moves)) {
    for (const move of feature.moves) {
      const fromPath = path.join(ROOT, move.from);
      const toPath = path.join(ROOT, feature.base, move.to);
      
      try {
        if (await fs.pathExists(fromPath)) {
          await fs.ensureDir(path.dirname(toPath));
          await fs.move(fromPath, toPath, { overwrite: true });
          console.log(`Moved: ${move.from} -> ${feature.base}/${move.to}`);
        } else {
          console.log(`Source not found: ${move.from}`);
        }
      } catch (error) {
        console.error(`Error moving ${move.from}:`, error);
      }
    }
  }
}

async function updateImports(filePath) {
  const content = await fs.readFile(filePath, 'utf-8');
  
  try {
    const ast = parser.parse(content, {
      sourceType: 'module',
      plugins: ['typescript', 'jsx']
    });

    let modified = false;

    traverse(ast, {
      ImportDeclaration(path) {
        const importPath = path.node.source.value;
        
        for (const [oldPath, newPath] of Object.entries(importMappings)) {
          if (importPath.startsWith(oldPath)) {
            path.node.source.value = importPath.replace(oldPath, newPath);
            modified = true;
            break;
          }
        }
      }
    });

    if (modified) {
      const output = generate(ast, {}, content);
      await fs.writeFile(filePath, output.code);
      console.log(`Updated imports in: ${filePath}`);
    }
  } catch (error) {
    console.error(`Error processing imports in ${filePath}:`, error);
  }
}

async function updateAllImports() {
  const files = glob.sync(path.join(SRC, '**/*.{ts,tsx}'));
  for (const file of files) {
    await updateImports(file);
  }
}

async function updateTsConfig() {
  const tsconfigPath = path.join(ROOT, 'tsconfig.json');
  const tsconfig = await fs.readJSON(tsconfigPath);

  tsconfig.compilerOptions.paths = {
    "@/*": ["./src/*"],
    "@/components/*": ["./src/components/*"],
    "@/features/*": ["./src/components/features/*"],
    "@/common/*": ["./src/components/common/*"],
    "@/lib/*": ["./src/lib/*"],
    "@/styles/*": ["./src/styles/*"],
    "@/assets/*": ["./src/assets/*"]
  };

  await fs.writeJSON(tsconfigPath, tsconfig, { spaces: 2 });
  console.log('Updated tsconfig.json paths');
}

async function main() {
  try {
    console.log('Starting codebase reorganization...');
    await createDirectories();
    await moveFiles();
    await updateAllImports();
    await updateTsConfig();
    console.log('Reorganization complete!');
  } catch (error) {
    console.error('Error during reorganization:', error);
    process.exit(1);
  }
}

main();

================
File: scripts/reorganize-types.js
================
const fs = require('fs-extra');
const path = require('path');
const parser = require('@babel/parser');
const traverse = require('@babel/traverse').default;
const generate = require('@babel/generator').default;

const ROOT = process.cwd();

// Define the interface movements
const typesMoves = {
  'Round': {
    targetFile: 'src/components/features/Round/types.ts',
    sourcesToRemove: [
      'src/components/features/Round/components/StatusMessageProps.tsx',
      'src/components/features/Round/CategoryGridProps.ts',
      'src/components/features/Round/RoundActionsProps.ts',
      'src/components/features/Round/RoundHeaderProps.ts',
      'src/components/features/Round/RoundUIProps.ts'
    ],
    interfaces: [
      'StatusMessageProps',
      'StatusState',
      'CategoryGridProps',
      'RoundActionsProps',
      'RoundHeaderProps',
      'RoundUIProps'
    ]
  },
  'Categories': {
    targetFile: 'src/components/features/Categories/types.ts',
    sourcesToRemove: [
      'src/components/features/Categories/components/Mobile/CategorySelectionOverlay.tsx'
    ],
    interfaces: [
      'CategorySelectionOverlayProps'
    ]
  }
};

async function extractInterfaces(filePath) {
  const content = await fs.readFile(filePath, 'utf-8');
  const ast = parser.parse(content, {
    sourceType: 'module',
    plugins: ['typescript', 'jsx']
  });

  const interfaces = [];
  let imports = new Set();

  traverse(ast, {
    ImportDeclaration(path) {
      imports.add(path.node.source.value);
    },
    TSInterfaceDeclaration(path) {
      if (path.node.id.name) {
        const interfaceCode = generate(path.node).code;
        interfaces.push(interfaceCode);
      }
    }
  });

  return { interfaces, imports: Array.from(imports) };
}

async function updateTypesFile(featureKey, move) {
  const targetPath = path.join(ROOT, move.targetFile);
  let content = '// Generated types file\n\n';

  // Add imports
  content += `import { Categories, CategoryName, Value } from "@/lib/types";\n\n`;

  // Extract interfaces from source files
  for (const sourceFile of move.sourcesToRemove) {
    const sourcePath = path.join(ROOT, sourceFile);
    if (await fs.pathExists(sourcePath)) {
      const { interfaces } = await extractInterfaces(sourcePath);
      content += interfaces.join('\n\n') + '\n\n';
    }
  }

  // Write the types file
  await fs.ensureFile(targetPath);
  await fs.writeFile(targetPath, content);
  console.log(`✓ Updated types file: ${move.targetFile}`);

  // Remove interfaces from original files
  for (const sourceFile of move.sourcesToRemove) {
    const sourcePath = path.join(ROOT, sourceFile);
    if (await fs.pathExists(sourcePath)) {
      const content = await fs.readFile(sourcePath, 'utf-8');
      const ast = parser.parse(content, {
        sourceType: 'module',
        plugins: ['typescript', 'jsx']
      });

      let modified = false;
      traverse(ast, {
        TSInterfaceDeclaration(path) {
          if (move.interfaces.includes(path.node.id.name)) {
            path.remove();
            modified = true;
          }
        }
      });

      if (modified) {
        // Add import for the types
        const importStatement = `import type { ${move.interfaces.join(', ')} } from '../types';\n`;
        const output = importStatement + generate(ast).code;
        await fs.writeFile(sourcePath, output);
        console.log(`✓ Updated source file: ${sourceFile}`);
      }
    }
  }
}

async function main() {
  try {
    console.log('Starting types reorganization...');
    
    for (const [featureKey, move] of Object.entries(typesMoves)) {
      await updateTypesFile(featureKey, move);
    }

    console.log('\nTypes reorganization complete!');
    console.log('\nNext steps:');
    console.log('1. Review the generated types files');
    console.log('2. Update any imports that might be affected');
    console.log('3. Run TypeScript compiler to check for any issues');

  } catch (error) {
    console.error('Error during types reorganization:', error);
    process.exit(1);
  }
}

main();

================
File: scripts/update-types.js
================
const fs = require('fs-extra');
const path = require('path');
const glob = require('glob');
const parser = require('@babel/parser');
const traverse = require('@babel/traverse').default;
const generate = require('@babel/generator').default;

const ROOT = process.cwd();

// Files to remove
const propsFilesToRemove = [
  'src/components/features/Round/CategoryGridProps.ts',
  'src/components/features/Round/RoundActionsProps.ts',
  'src/components/features/Round/RoundHeaderProps.ts',
  'src/components/features/Round/RoundUIProps.ts',
  'src/components/features/Round/components/StatusMessageProps.tsx',
  'src/components/features/Categories/components/CategoryColumn/types.ts',
  'src/components/features/Cards/components/types.ts'
];

// Update Round/types.ts with StatusState interface
async function updateRoundTypes() {
  const roundTypesPath = path.join(ROOT, 'src/components/features/Round/types.ts');
  const statusHookPath = path.join(ROOT, 'src/components/features/Round/hooks/useRoundStatus.ts');

  try {
    // Read the StatusState interface from useRoundStatus.ts
    const hookContent = await fs.readFile(statusHookPath, 'utf-8');
    const ast = parser.parse(hookContent, {
      sourceType: 'module',
      plugins: ['typescript']
    });

    let statusStateInterface = '';
    traverse(ast, {
      TSInterfaceDeclaration(path) {
        if (path.node.id.name === 'StatusState') {
          statusStateInterface = generate(path.node).code;
        }
      }
    });

    // Add it to types.ts if it's not already there
    const typesContent = await fs.readFile(roundTypesPath, 'utf-8');
    if (!typesContent.includes('interface StatusState')) {
      const updatedContent = `${typesContent}\n\n${statusStateInterface}\n`;
      await fs.writeFile(roundTypesPath, updatedContent);
    }

    // Remove interface from useRoundStatus.ts
    const updatedHookContent = hookContent.replace(/export\s+interface\s+StatusState[\s\S]*?}\n/, '');
    await fs.writeFile(statusHookPath, updatedHookContent);

    console.log('✓ Updated Round types');
  } catch (error) {
    console.error('Error updating Round types:', error);
  }
}

// Update imports in all files to use the new type locations
async function updateImports(filePath) {
  try {
    const content = await fs.readFile(filePath, 'utf-8');
    const ast = parser.parse(content, {
      sourceType: 'module',
      plugins: ['typescript', 'jsx']
    });

    let modified = false;

    traverse(ast, {
      ImportDeclaration(path) {
        const importPath = path.node.source.value;
        // Update imports to use feature-level types
        if (importPath.includes('/components/types')) {
          path.node.source.value = importPath.replace('/components/types', '/types');
          modified = true;
        }
        // Update relative Props imports to use types
        if (importPath.endsWith('Props') || importPath.includes('/types')) {
          const currentDir = path.dirname(filePath);
          const featureDir = findFeatureDir(currentDir);
          if (featureDir) {
            path.node.source.value = path.relative(currentDir, path.join(featureDir, 'types'));
            if (!path.node.source.value.startsWith('.')) {
              path.node.source.value = './' + path.node.source.value;
            }
            modified = true;
          }
        }
      }
    });

    if (modified) {
      const output = generate(ast, {}, content);
      await fs.writeFile(filePath, output.code);
      console.log(`✓ Updated imports in: ${filePath}`);
    }
  } catch (error) {
    console.error(`Error updating imports in ${filePath}:`, error);
  }
}

// Helper function to find the feature directory
function findFeatureDir(dir) {
  const parts = dir.split(path.sep);
  const featuresIndex = parts.indexOf('features');
  if (featuresIndex === -1) return null;
  return parts.slice(0, featuresIndex + 2).join(path.sep);
}

// Remove Props files
async function removePropsFiles() {
  for (const file of propsFilesToRemove) {
    const filePath = path.join(ROOT, file);
    try {
      if (await fs.pathExists(filePath)) {
        await fs.remove(filePath);
        console.log(`✓ Removed: ${file}`);
      }
    } catch (error) {
      console.error(`Error removing ${file}:`, error);
    }
  }
}

async function main() {
  try {
    console.log('Updating types organization...');
    
    // Remove Props files
    await removePropsFiles();

    // Update Round types
    await updateRoundTypes();

    // Update imports in all TypeScript files
    const files = glob.sync(path.join(ROOT, 'src', '**', '*.{ts,tsx}'));
    for (const file of files) {
      await updateImports(file);
    }

    console.log('\nTypes update complete!');

  } catch (error) {
    console.error('Error during types update:', error);
    process.exit(1);
  }
}

main();

================
File: serve.json
================
{
  "public": "out",
  "directoryListing": false,
  "cleanUrls": false,
  "trailingSlash": true,
  "headers": [
    {
      "source": "**/*.js",
      "headers": [
        {
          "key": "Content-Type",
          "value": "application/javascript"
        }
      ]
    },
    {
      "source": "**/*.css",
      "headers": [
        {
          "key": "Content-Type",
          "value": "text/css"
        }
      ]
    }
  ],
  "rewrites": [
    {
      "source": "/**",
      "destination": "/index.html"
    }
  ]
}

================
File: src/app/about/page.tsx
================
// src/app/about/page.tsx
'use client'

import React, { useEffect, useState } from 'react';
import { clearGameState } from "@/lib/utils/storage";

const appVersion = process.env.NEXT_PUBLIC_VERSION || '0.0.0';

export default function About() {
  useEffect(() => {
    clearGameState();
  }, []);

  const [showInstructions, setShowInstructions] = useState(true);  
  useEffect(() => {
    const savedPreference = localStorage.getItem('showInstructions');
    setShowInstructions(savedPreference !== 'false');
  }, []);

  const handleToggleInstructions = () => {
    const newValue = !showInstructions;
    setShowInstructions(newValue);
    localStorage.setItem('showInstructions', newValue ? 'true' : 'false');
  };

  return (
    <div className="flex-1 overflow-y-auto">
      <div className="max-w-3xl mx-auto p-6 space-y-8">
        <div className="max-w-3xl mx-auto p-6 space-y-8">
          <div className="text-center mb-12">
            <h1 className="text-3xl font-bold text-gray-900 mb-4">
              About Core Values
            </h1>
            <p className="text-xl text-gray-700">
              Discover and prioritise what matters most to you
            </p>
            <p className="text-sm text-gray-500 mt-2" aria-label="Application version">
              Version {appVersion}
            </p>
          </div>
          <section aria-labelledby="why-matters-heading">
            <h2 id="why-matters-heading" className="text-2xl font-bold text-gray-900">
              Why Core Values Matter
            </h2>
            <div className="prose prose-lg text-gray-700">
              <p>
                Understanding your core values is essential for making meaningful life decisions
                and living authentically. This app helps you explore and organize your values
                through an interactive and thoughtful process.
              </p>
              <p>
                Whether you are at a crossroads in life, planning your future, or simply want
                to better understand yourself, identifying your core values provides a compass
                for decision-making and personal growth.
              </p>
            </div>
          </section>

          <section aria-labelledby="how-it-works-heading">
            <h2 id="how-it-works-heading" className="text-2xl font-bold text-gray-900">
              How It Works
            </h2>
            <div
              className="grid gap-4 md:grid-cols-3"
              role="list"
            >
              {[
                {
                  title: "1. Explore",
                  description: "Browse through carefully curated value cards and begin sorting them based on their importance to you."
                },
                {
                  title: "2. prioritise",
                  description: "Organize values into categories, helping you identify which ones resonate most strongly with your personal beliefs."
                },
                {
                  title: "3. Reflect",
                  description: "Review your choices and gain insights into what truly matters to you, helping guide future decisions."
                }
              ].map((step, index) => (
                <div
                  key={step.title}
                  className="bg-white p-6 rounded-lg shadow-sm border border-gray-100"
                  role="listitem"
                >
                  <div className="text-blue-700 text-xl mb-2">{step.title}</div>
                  <p className="text-gray-700">{step.description}</p>
                </div>
              ))}
            </div>
          </section>

          <section aria-labelledby="benefits-heading">
            <h2 id="benefits-heading" className="text-2xl font-bold text-gray-900">
              Benefits
            </h2>
            <div
              className="grid gap-4 md:grid-cols-2"
              role="list"
            >
              {[
                {
                  icon: "🎯",
                  title: "Clear Decision Making",
                  description: "Use your identified values as a framework for making choices that align with what truly matters to you."
                },
                {
                  icon: "🧭",
                  title: "Personal Growth",
                  description: "Gain deeper self-awareness and understanding of your motivations and priorities."
                },
                {
                  icon: "🤝",
                  title: "Better Relationships",
                  description: "Communicate your values clearly to others and understand what drives your interactions."
                },
                {
                  icon: "⚡",
                  title: "Increased Motivation",
                  description: "Align your goals with your values for more meaningful and sustainable motivation."
                }
              ].map((benefit) => (
                <div
                  key={benefit.title}
                  className="bg-gray-100 p-4 rounded-lg"
                  role="listitem"
                >
                  <h3 className="font-semibold text-gray-900 mb-2">
                    <span aria-hidden="true">{benefit.icon} </span>
                    {benefit.title}
                  </h3>
                  <p className="text-gray-700">{benefit.description}</p>
                </div>
              ))}
            </div>
          </section>

          <section aria-labelledby="privacy-heading">
            <h2 id="privacy-heading" className="text-2xl font-bold text-gray-900">
              Your Data & Privacy
            </h2>
            <div
              className="space-y-4"
              role="list"
            >
              {[
                {
                  icon: "📱",
                  title: "Private & Local Storage",
                  description: "All your selections and progress are stored directly on your device. Think of it like having a personal notebook that only exists on your phone or computer.",
                  bgColor: "bg-blue-100",
                  textColor: "text-blue-900"
                },
                {
                  icon: "🔒",
                  title: "Complete Privacy",
                  description: "Your data never leaves your device - we do not use any external servers or cloud storage. Your personal journey stays completely private.",
                  bgColor: "bg-green-100",
                  textColor: "text-green-900"
                },
                {
                  icon: "💾",
                  title: "Automatic Saving",
                  description: "Every change you make is automatically saved on your device. You can close the app and come back later - your progress will be waiting for you.",
                  bgColor: "bg-purple-100",
                  textColor: "text-purple-900"
                },
                {
                  icon: "⚡",
                  title: "Works Offline",
                  description: "Because everything is stored on your device, you can use the app even without an internet connection. Perfect for deep reflection anywhere.",
                  bgColor: "bg-yellow-100",
                  textColor: "text-yellow-900"
                }
              ].map((item) => (
                <div
                  key={item.title}
                  className={`${item.bgColor} p-4 rounded-lg`}
                  role="listitem"
                >
                  <h3 className={`font-semibold ${item.textColor} mb-2`}>
                    <span aria-hidden="true">{item.icon} </span>
                    {item.title}
                  </h3>
                  <p className="text-gray-700">{item.description}</p>
                </div>
              ))}
            </div>
          </section>

          <section aria-labelledby="notes-heading">
            <h2 id="notes-heading" className="sr-only">Important Notes</h2>
            <div className="space-y-4">
              <div
                className="bg-red-100 p-4 rounded-lg"
                role="alert"
              >
                <h3 className="font-semibold text-red-900 mb-2">
                  <span aria-hidden="true">⚠️ </span>
                  Important Note
                </h3>
                <p className="text-gray-700">
                  If you clear your browser data or uninstall the app, your stored
                  information will be deleted. Consider taking screenshots or noting down
                  important results if you want to keep them long-term.
                </p>
              </div>

              <div className="bg-gray-100 p-4 rounded-lg">
                <h3 className="font-semibold text-gray-900 mb-2">
                  <span aria-hidden="true">💡 </span>
                  Pro Tip
                </h3>
                <p className="text-gray-700">
                  For the best experience, install this as an app on your device
                  (look for the Install App button in your browser). This makes it easier
                  to access and use, just like any other app on your device!
                </p>
              </div>
            </div>
          </section>
          <section aria-labelledby="instructions-heading">
            <h2 id="instructions-heading" className="text-2xl font-bold text-gray-900">
              Instructions Preference
            </h2>
            <div
              className="bg-gray-100 p-4 rounded-lg"
              role="group"
              aria-labelledby="instructions-heading"
            >
              <div
                className="flex items-center gap-3"
                role="group"
                aria-labelledby="instructions-label"
              >
                <div className="relative flex items-start">
                  <div className="flex items-center h-5">
                    <input
                      type="checkbox"
                      id="show-instructions"
                      checked={showInstructions}
                      onChange={handleToggleInstructions}
                      className="rounded border-gray-300 text-blue-700 focus:ring-blue-600"
                      aria-describedby="instructions-description"
                      aria-checked={showInstructions}
                    />
                  </div>
                  <div className="ml-3 text-sm">
                    <label
                      id="instructions-label"
                      htmlFor="show-instructions"
                      className="font-medium text-gray-900"
                    >
                      Show instructions when starting the exercise
                    </label>
                    <p
                      id="instructions-description"
                      className="text-gray-700 mt-2"
                    >
                      <span className="sr-only">
                        Current status:
                      </span>
                      {showInstructions
                        ? "Instructions will be shown when you start a new exercise."
                        : "Instructions are currently hidden. Enable this to see them again."}
                    </p>
                  </div>
                </div>
              </div>

              <div
                className="mt-4 text-sm text-gray-500"
                role="status"
                aria-live="polite"
              >
                <span className="sr-only">Preference saved: </span>
                {showInstructions
                  ? "Instructions will appear at the start of each new exercise"
                  : "Instructions will not appear automatically. You can change this setting at any time"}
              </div>
            </div>
          </section>

        </div>
      </div>
    </div>
  );
}

================
File: src/app/error.tsx
================
// src/app/error.tsx
'use client'

import { useEffect } from 'react'

export default function Error({
  error,
  reset,
}: {
  error: Error & { digest?: string }
  reset: () => void
}) {
  useEffect(() => {
    // Log error for debugging but ensure no sensitive info is exposed
    console.error('App Error:', {
      message: error.message,
      digest: error.digest,
      name: error.name
    })
  }, [error])

  return (
    <main 
      className="flex-1 flex items-center justify-center p-4"
      role="alert"
      aria-labelledby="error-heading"
    >
      <div className="text-center max-w-md">
        <h1 
          id="error-heading"
          className="text-2xl font-bold mb-4"
        >
          Something went wrong!
        </h1>
        
        <div className="mb-6">
          <p 
            className="text-gray-700 mb-2"
            aria-live="polite"
          >
            We encountered an unexpected error. 
            You can try again or return to the home page.
          </p>
          {process.env.NODE_ENV === 'development' && error.message && (
            <p 
              className="text-red-600 text-sm mt-2"
              aria-label="Error details"
            >
              {error.message}
            </p>
          )}
        </div>

        <div className="space-y-4">
          <button
            onClick={() => reset()}
            className="w-full px-4 py-2 bg-blue-700 text-white rounded hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"
            aria-label="Attempt to recover from error"
          >
            Try again
          </button>
          
          {error.digest && (
            <p 
              className="text-xs text-gray-500"
              aria-label="Error reference code"
            >
              Error Reference: {error.digest}
            </p>
          )}
        </div>
      </div>
    </main>
  )
}

================
File: src/app/exercise/page.tsx
================
'use client';

import { Suspense, useEffect } from 'react';
import { useRouter } from 'next/navigation';
import RoundUIDebug from "@/components/features/Round/RoundUIDebug";
import RoundUI from "@/components/features/Round/RoundUI";
import Instructions from "@/components/common/Instructions";
import { DndProvider } from 'react-dnd';
import { HTML5Backend } from 'react-dnd-html5-backend';
import PWAPrompt from "@/components/common/PWAPrompt";
import { useGameState } from "@/components/features/Exercise/hooks/useGameState";
import { forceReload } from "@/lib/utils/cache";
import { useGameInit } from "@/components/features/Exercise/hooks/useGameInit";

function ExerciseContent() {
  const router = useRouter();
  const { showInstructions, setShowInstructions } = useGameState();
  const { isLoading, error, shouldRedirect } = useGameInit();

  useEffect(() => {
    const lastVersion = localStorage.getItem('app-version');
    const currentVersion = process.env.NEXT_PUBLIC_VERSION ?? '0.0.0';
    if (lastVersion !== currentVersion) {
      localStorage.setItem('app-version', currentVersion);
      forceReload();
    }
  }, []);

  useEffect(() => {
    if (shouldRedirect) {
      router.replace('/');
    }
  }, [shouldRedirect, router]);

  if (isLoading) {
    return (
      <div className="flex items-center justify-center flex-1" role="status" aria-live="polite">
        <span className="sr-only">Loading exercise...</span>
        Loading...
      </div>
    );
  }

  if (error && !shouldRedirect) {
    return (
      <div className="flex items-center justify-center flex-1 text-red-600" role="alert">
        An error occurred while loading the exercise. Please try again.
      </div>
    );
  }

  // Use RoundUIDebug in development, RoundUI in production
  const GameComponent = process.env.NODE_ENV === 'development' ? RoundUIDebug : RoundUI;

  return (
    <DndProvider backend={HTML5Backend}>
      <div className="flex-1 flex flex-col" aria-label="Core Values Exercise">
        <h1 className="sr-only">Core Values - Exercise In Progress</h1>
        
        <GameComponent />
        
        {showInstructions && (
          <Instructions 
            onClose={() => setShowInstructions(false)}
            onStart={() => {}} 
            aria-label="Exercise Instructions"
          />
        )}
        
        <PWAPrompt />
      </div>
    </DndProvider>
  );
}

export default function ExercisePage() {
  return (
    <Suspense fallback={
      <div className="flex items-center justify-center flex-1">
        <span className="sr-only">Loading exercise...</span>
        Loading...
      </div>
    }>
      <ExerciseContent />
    </Suspense>
  );
}

================
File: src/app/history/page.tsx
================
'use client';

import { useEffect, useState } from 'react';
import { Session } from "@/lib/types";
import { getSessions } from "@/lib/db/indexedDB";
import { SessionList } from "@/components/features/History/components/SessionList";
import { SessionSelectionProvider } from '@/components/features/History/contexts/SessionSelectionContext';
import { clearGameState } from "@/lib/utils/storage";
export default function HistoryPage() {
  useEffect(() => {
    clearGameState();
  }, []);

  const [sessions, setSessions] = useState<Session[]>([]);
  const [isLoading, setIsLoading] = useState(true);

  useEffect(() => {
    const loadSessions = async () => {
      try {
        const allSessions = await getSessions();
        setSessions(allSessions.sort((a, b) => b.timestamp - a.timestamp));
      } catch (error) {
        console.error('Failed to load sessions:', error);
      } finally {
        setIsLoading(false);
      }
    };
    loadSessions();
  }, []);

  const handleSessionDeleted = (sessionId: string) => {
    setSessions(prevSessions => prevSessions.filter(session => session.id !== sessionId));
  };

  return (
    <div className="flex-1 overflow-y-auto">
      <div className="container mx-auto px-4 py-8">
        <h1 className="text-3xl font-bold mb-6">Session History</h1>
        
        <section aria-label="Value sorting sessions history" className="space-y-4">
          <SessionSelectionProvider>
            {isLoading ? (
              <div role="status" aria-live="polite" className="text-center py-4">
                <span className="sr-only">Loading session history...</span>
                Loading...
              </div>
            ) : sessions.length === 0 ? (
              <p role="status" aria-live="polite" className="text-gray-700 text-center py-4">
                No sessions found. Complete a value sorting exercise to see your history.
              </p>
            ) : (
              <SessionList 
                sessions={sessions} 
                onSessionDeleted={handleSessionDeleted}
                aria-label="List of completed value sorting sessions" 
              />
            )}
          </SessionSelectionProvider>
        </section>
      </div>
    </div>
  );
}

================
File: src/app/layout.tsx
================
// layout.tsx
'use client';

import '@/styles/globals.css';
import Navigation from "@/components/common/Navigation";
import { MobileProvider } from "@/lib/contexts/MobileContext";
export default function RootLayout({
  children
}: {
  children: React.ReactNode;
}) {
  return <html lang="en">
      <head>
        <meta charSet="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="manifest" href="/manifest.webmanifest" type="application/manifest+json" />
        <link rel="icon" href="/favicon.ico" />
        <link rel="apple-touch-icon" href="/icons/icon-192x192.png" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="default" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="mobile-web-app-capable" content="yes" />
        <meta name="msapplication-tap-highlight" content="no" />
        <meta name="msapplication-TileColor" content="#3b82f6" />
        <title>Core Values</title>
        <meta name="description" content="Discover and prioritise your personal values" />
        {/* {process.env.NODE_ENV === 'development' && <meta httpEquiv="Cache-Control" content="no-cache, no-store, must-revalidate" />} */}
      </head>
      <body className="bg-gray-100">
        <MobileProvider>
          <div className="min-h-screen flex flex-col">
            {/* Header */}
            <header className="bg-blue-700 text-white shadow-md flex-shrink-0" role="banner" aria-label="Site header">
              <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <Navigation />
              </div>
            </header>

            {/* Main content */}
            <main className="flex-1 flex flex-col md:overflow-hidden" // Only hide overflow on desktop
          role="main" aria-label="Main content">
              {children}
              <div id="portal-root" />
            </main>

            {/* Footer */}
            <footer className="bg-blue-700 text-white md:flex-shrink-0" // Only shrink on desktop
          role="contentinfo" aria-label="Site footer">
              <div className="max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8">
                <p className="text-center text-white text-sm">
                  © {new Date().getFullYear()} Core Values App
                </p>
              </div>
            </footer>
          </div>
        </MobileProvider>
      </body>
    </html>;
}

================
File: src/app/not-found.tsx
================
// src/app/not-found.tsx
'use client'

import Link from 'next/link';

export default function NotFound() {
  return (
    <div 
      className="flex-1 flex items-center justify-center p-4"
      role="main"
    >      <div 
        className="text-center"
        role="alert"
        aria-labelledby="not-found-title"
      >
        <h1 
          id="not-found-title"
          className="text-2xl font-bold mb-4"
        >
          Page Not Found
        </h1>
        <p 
          className="mb-4 text-gray-700"
          aria-live="polite"
        >
          Could not find requested resource
        </p>
        <Link 
          href="/"
          className="text-blue-700 hover:text-blue-800 underline inline-flex items-center focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2 rounded px-2 py-1"
          aria-label="Return to homepage"
        >
          <span aria-hidden="true">←</span>
          <span className="ml-1">Return Home</span>
        </Link>
      </div>
    </div>
  );
}

================
File: src/app/page.tsx
================
'use client';

import { useEffect } from 'react';
import { useRouter } from 'next/navigation';
import StartScreen from "@/components/features/Home/components/StartScreen";
import { DndProvider } from 'react-dnd';
import { HTML5Backend } from 'react-dnd-html5-backend';
import PWAPrompt from "@/components/common/PWAPrompt";
import { clearGameState } from "@/lib/utils/storage";
import { forceReload } from "@/lib/utils/cache";

export default function Home() {
  const router = useRouter();

  useEffect(() => {
    const lastVersion = localStorage.getItem('app-version');
    const currentVersion = process.env.NEXT_PUBLIC_VERSION ?? '0.0.0';
    if (lastVersion !== currentVersion) {
      localStorage.setItem('app-version', currentVersion);
      forceReload();
    }
  }, []);

  useEffect(() => {
    clearGameState();
  }, []);

  return (
    <DndProvider backend={HTML5Backend}>
      <div className="flex-1 flex flex-col" aria-label="Core Values Application">
        <h1 className="sr-only">Core Values - Personal Value Discovery Tool</h1>
        <StartScreen />
        <PWAPrompt />
      </div>
    </DndProvider>
  );
}

================
File: src/app/replay/page.tsx
================
// src/app/replay/page.tsx
'use client';

import { Suspense } from 'react';
import ReplayClient from "@/components/features/Replay/components/ReplayClient";
export default function ReplayPage() {
  return <div className="flex-1">
      <Suspense fallback={<div role="status" aria-live="polite" className="flex items-center justify-center h-full">
            <span className="sr-only">Loading session replay...</span>
            <div className="text-gray-700">Loading...</div>
          </div>}>
        <section className="h-full" aria-label="Session Replay">
          <h1 className="sr-only">Core Values Session Replay</h1>
          <ReplayClient />
        </section>
      </Suspense>
    </div>;
}

================
File: src/components/common/CentredImage/index.tsx
================
// src/components/CentredImage.tsx
export default function CenteredImage() {
  return (
    <div className="absolute inset-0">
      <img
        src="/images/core-values.png" // Update with your actual image path
        alt="Core Values"
        className="w-full h-full object-cover"
      />
    </div>
  );
}

================
File: src/components/common/Instructions/index.tsx
================
'use client'

import { useState, useCallback, useEffect } from 'react';
import { InstructionsProps } from './types';

export default function Instructions({ onClose }: InstructionsProps) {
  const [shouldShowAgain, setShouldShowAgain] = useState(true);

  useEffect(() => {
    const savedPreference = localStorage.getItem('showInstructions');
    if (savedPreference === 'false') {
      onClose();
    }
  }, [onClose]);

  const handleClose = useCallback(() => {
    if (!shouldShowAgain) {
      localStorage.setItem('showInstructions', 'false');
    }
    onClose();
  }, [shouldShowAgain, onClose]);

  return (
    <div className="fixed inset-0 bg-black bg-opacity-100 flex items-center justify-center p-2 sm:p-4 z-50">
      <div className="bg-white p-4 sm:p-6 rounded-lg max-w-xs sm:max-w-sm md:max-w-2xl w-full max-h-[90vh] overflow-y-auto">
        <h2 className="text-xl sm:text-2xl font-bold mb-3 sm:mb-4">How to Use Core Values</h2>
        <ol className="list-decimal ml-4 sm:ml-6 space-y-1 sm:space-y-2 text-sm sm:text-base">
          <li>You have already entered the number of core values you want to end up with (typically 5).</li>
          <li>For each round, you&apos;ll see value cards that you need to sort into categories.</li>
          <li>Drag each card into one of the five categories based on its importance to you: Very Important, Quite Important, Important, Of Some Importance or Not Important</li>
          <li>Click on a card&apos;s title to show/hide its description.</li>
          <li>Use the up/down arrows to reorder cards within a category.</li>
          <li>When you&apos;re done sorting all cards, click &quot;Next Round&quot;.</li>
          <li>In the next round, cards marked as &quot;Not Important&quot; will be removed.</li>
          <li>Continue sorting until you reach your target number of core values.</li>
          <li>Then tell me why you chose your values.</li>
        </ol>

        <div className="mt-4 sm:mt-6 space-y-4">
          <label className="flex items-center gap-2 text-gray-700">
            <input
              type="checkbox"
              checked={!shouldShowAgain}
              onChange={(e) => setShouldShowAgain(!e.target.checked)}
              className="rounded border-gray-300 text-blue-700 focus:ring-blue-600"
            />
            <span className="text-sm">Don&apos;t show these instructions again</span>
          </label>

          <button
            onClick={handleClose}
            className="w-full sm:w-auto px-4 py-2 bg-blue-700 text-white rounded hover:bg-blue-600 transition-colors"
          >
            Got it!
          </button>
        </div>
      </div>
    </div>
  );
}

================
File: src/components/common/Instructions/types.ts
================
'use client';
export interface InstructionsProps {
  onStart?: () => void;
  onClose: () => void;
}

================
File: src/components/common/Modal/index.tsx
================
import { useEffect, useRef } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { ModalProps } from '@/components/common/Modal/types';


export function Modal({ 
    isOpen, 
    onClose, 
    title, 
    children, 
    maxWidth = 'max-w-lg' 
  }: ModalProps) {
    const modalRef = useRef<HTMLDivElement>(null);
  
    useEffect(() => {
      const handleEscape = (event: KeyboardEvent) => {
        if (event.key === 'Escape') {
          onClose();
        }
      };
  
      if (isOpen) {
        document.addEventListener('keydown', handleEscape);
        document.body.style.overflow = 'hidden';
      }
  
      return () => {
        document.removeEventListener('keydown', handleEscape);
        document.body.style.overflow = 'unset';
      };
    }, [isOpen, onClose]);
  
    const handleOverlayClick = (e: React.MouseEvent) => {
      if (e.target === e.currentTarget) {
        onClose();
      }
    };
  
    return (
      <AnimatePresence>
        {isOpen && (
          <div 
            className="fixed inset-0 z-50"
            aria-labelledby="modal-title"
            role="dialog"
            aria-modal="true"
          >
            {/* Overlay */}
            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
              className="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"
              onClick={handleOverlayClick}
            />
  
            {/* Modal */}
            <div className="fixed inset-0 z-50 overflow-y-auto">
              <div className="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
                <motion.div
                  initial={{ opacity: 0, scale: 0.95 }}
                  animate={{ opacity: 1, scale: 1 }}
                  exit={{ opacity: 0, scale: 0.95 }}
                  ref={modalRef}
                  className={`relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 w-full ${maxWidth}`}
                  onClick={e => e.stopPropagation()}
                >
                  <div className="bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4">
                    <div className="sm:flex sm:items-start">
                      <div className="mt-3 text-center sm:mt-0 sm:text-left w-full">
                        <h3 className="text-lg font-medium leading-6 text-gray-900" id="modal-title">
                          {title}
                        </h3>
                        <div className="mt-2">
                          {children}
                        </div>
                      </div>
                    </div>
                  </div>
                </motion.div>
              </div>
            </div>
          </div>
        )}
      </AnimatePresence>
    );
  }

================
File: src/components/common/Modal/types.ts
================
export interface ModalProps {
    isOpen: boolean;
    onClose: () => void;
    title: string;
    children: React.ReactNode;
    maxWidth?: string;
  }

================
File: src/components/common/Navigation/index.tsx
================
// src/components/Navigation.tsx
import { useState } from 'react';
import Link from 'next/link';
import { usePathname } from 'next/navigation';

export default function Navigation() {
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const pathname = usePathname();
  const getActiveClass = (path: string) => {
    return pathname === path 
      ? 'bg-white text-blue-700 font-semibold rounded-md' 
      : 'text-white hover:bg-white/20 rounded-md transition-colors';
  };

  return (
    <nav 
      className="flex items-center justify-between px-4 py-2"
      role="navigation"
      aria-label="Main navigation"
    >
      <Link 
        href="/" 
        className="text-xl font-bold text-white"
        aria-label="Core Values Home"
      >
        Core Values
      </Link>

      {/* Desktop Navigation */}
      <div 
        className="hidden md:flex space-x-4"
        role="menubar"
        aria-label="Desktop navigation"
      >
        <Link 
          href="/" 
          className={`${getActiveClass('/')} text-lg px-4 py-2`}
          role="menuitem"
        >
          Home
        </Link>
        <Link 
          href="/about" 
          className={`${getActiveClass('/about')} text-lg px-4 py-2`}
          role="menuitem"
        >
          About
        </Link>
        <Link 
          href="/history" 
          className={`${getActiveClass('/history')} text-lg px-4 py-2`}
          role="menuitem"
        >
          History
        </Link>
      </div>

      {/* Mobile Navigation */}
      <div className="md:hidden">
        <button 
          onClick={() => setIsMenuOpen(!isMenuOpen)}
          className="text-white p-2"
          aria-label="Toggle menu"
          aria-expanded={isMenuOpen}
          aria-controls="mobile-menu"
        >
          <svg 
            className="w-6 h-6" 
            fill="none" 
            strokeLinecap="round" 
            strokeLinejoin="round" 
            strokeWidth="2" 
            viewBox="0 0 24 24" 
            stroke="currentColor"
            aria-hidden="true"
          >
            <path d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>

        {/* Mobile Menu Dropdown */}
        {isMenuOpen && (
          <div 
            id="mobile-menu"
            className="absolute top-14 right-4 bg-white shadow-lg rounded-lg py-2 z-50"
            role="menu"
            aria-label="Mobile navigation"
          >
            <Link 
              href="/" 
              className="block px-4 py-2 text-white hover:bg-gray-100"
              onClick={() => setIsMenuOpen(false)}
              role="menuitem"
            >
              Home
            </Link>
            <Link 
              href="/about" 
              className="block px-4 py-2 text-white hover:bg-gray-100"
              onClick={() => setIsMenuOpen(false)}
              role="menuitem"
            >
              About
            </Link>
            <Link 
              href="/history" 
              className="block px-4 py-2 text-white hover:bg-gray-100"
              onClick={() => setIsMenuOpen(false)}
              role="menuitem"
            >
              History
            </Link>
          </div>
        )}
      </div>
    </nav>
  );
}

================
File: src/components/common/OfflineIndicator/index.tsx
================
// src/components/OfflineIndicator.tsx
'use client';

import { usePWA } from "@/lib/hooks/usePWA";
export default function OfflineIndicator() {
  const {
    isOffline
  } = usePWA();
  if (!isOffline) return null;
  return <div role="alert" aria-live="polite" className="fixed bottom-2 sm:bottom-4 left-2 sm:left-4 transform transition-all duration-300 
                bg-yellow-500 text-white px-3 sm:px-4 py-2 sm:py-3 
                text-xs sm:text-sm rounded-lg shadow-lg z-50 
                max-w-[calc(100vw-1rem)] sm:max-w-md">
      <div className="flex items-center space-x-2" aria-label="Offline status indicator">
        <span className="h-2 w-2 bg-white rounded-full animate-pulse" aria-hidden="true" />
        <span className="sr-only">Warning:</span>
        <span>You are offline. Some features may be limited.</span>
      </div>
    </div>;
}

================
File: src/components/common/PWAPrompt/index.tsx
================
// src/components/PWAPrompt.tsx
'use client';

import { useEffect, useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { usePWA } from "@/lib/hooks/usePWA";
type PromptType = 'install' | 'update' | null;
export default function PWAPrompt() {
  const [showPrompt, setShowPrompt] = useState(false);
  const [promptType, setPromptType] = useState<PromptType>(null);
  const [deferredPrompt, setDeferredPrompt] = useState<any>(null);
  const {
    needsUpdate,
    updateServiceWorker
  } = usePWA();
  useEffect(() => {
    // Handle installation prompt
    const handleBeforeInstallPrompt = (e: Event) => {
      e.preventDefault();
      setDeferredPrompt(e);
      // Only show install prompt if there's no update needed
      if (!needsUpdate) {
        setPromptType('install');
        setShowPrompt(true);
      }
    };

    // Handle update availability
    if (needsUpdate) {
      setPromptType('update');
      setShowPrompt(true);
    }
    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);

    // Hide prompts if app is already installed
    if (window.matchMedia('(display-mode: standalone)').matches) {
      setShowPrompt(false);
    }
    return () => {
      window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
    };
  }, [needsUpdate]);
  const handleInstallClick = async () => {
    if (!deferredPrompt) return;
    deferredPrompt.prompt();
    const {
      outcome
    } = await deferredPrompt.userChoice;
    setDeferredPrompt(null);
    setShowPrompt(false);
    if (outcome === 'accepted') {
      console.log('User accepted the install prompt');
    } else {
      console.log('User dismissed the install prompt');
    }
  };
  const handleUpdateClick = async () => {
    await updateServiceWorker();
    setShowPrompt(false);
  };
  const handleDismiss = () => {
    setShowPrompt(false);
    if (promptType === 'install') {
      localStorage.setItem('pwa-prompt-dismissed', 'true');
    }
  };

  // Don't render anything in development
  if (process.env.NODE_ENV === 'development') {
    return null;
  }
  if (!showPrompt) return null;
  const promptTitle = promptType === 'install' ? 'Install Core Values App' : 'Update Available';
  const promptDescription = promptType === 'install' ? 'Install our app for a better experience with offline access and faster loading times.' : 'A new version is available. Update now for the latest features and improvements.';
  return <AnimatePresence>
      {showPrompt && <motion.div role="alertdialog" aria-labelledby="pwa-prompt-title" aria-describedby="pwa-prompt-description" initial={{
      opacity: 0,
      y: 0
    }} animate={{
      opacity: 1,
      y: 0
    }} exit={{
      opacity: 0,
      y: 0
    }} className="fixed bottom-4 left-1/2 transform -translate-x-1/2 w-11/12 sm:w-96 bg-white rounded-lg shadow-lg p-4 border border-gray-200 z-50">
          <div className="flex items-start justify-between">
            <div className="flex-1">
              <h2 id="pwa-prompt-title" className="text-base font-semibold text-gray-900">
                {promptTitle}
              </h2>
              <p id="pwa-prompt-description" className="mt-1 text-sm text-gray-500">
                {promptDescription}
              </p>
              <div className="mt-4 flex space-x-3" role="group" aria-label="PWA prompt actions">
                <button onClick={promptType === 'install' ? handleInstallClick : handleUpdateClick} className="flex-1 bg-blue-600 text-white px-4 py-2 text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-600" aria-label={promptType === 'install' ? 'Install application' : 'Update application'}>
                  {promptType === 'install' ? 'Install' : 'Update Now'}
                </button>
                {promptType === 'install' && <button onClick={handleDismiss} className="flex-1 bg-white text-gray-800 px-4 py-2 text-sm font-medium border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-600" aria-label="Dismiss installation prompt">
                    Not Now
                  </button>}
              </div>
            </div>
          </div>
        </motion.div>}
    </AnimatePresence>;
}

================
File: src/components/features/Cards/components/AnimatedCard.tsx
================
'use client';

import { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import type { CardProps } from '@/components/features/Cards/types';
import { getEnvBoolean } from "@/lib/utils/config";
import { CardControls } from './CardControls';
import { CardMoveOptions } from './CardMoveOptions';
import { CardContent } from './CardContent';
import { getPostItStyles } from './styles';

// Faster animation settings for replay
const cardVariants = {
  initial: {
    scale: 0.8,
    opacity: 0
  },
  animate: {
    scale: 1,
    opacity: 1
  },
  exit: {
    scale: 0.8,
    opacity: 0
  },
  hover: {
    scale: 1.05
  }
};
const cardTransition = {
  type: "spring",
  stiffness: 700,
  // Increased from 500
  damping: 30,
  // Reduced from 35
  mass: 0.8 // Reduced from 1
};

// This version uses Framer Motion for Replay view
export function AnimatedCard({
  value,
  onMoveUp,
  onMoveDown,
  onMoveBetweenCategories,
  currentCategory,
  columnIndex
}: CardProps) {
  const debug = getEnvBoolean('debug', false);
  const [isExpanded, setIsExpanded] = useState(false);
  const [showMoveOptions, setShowMoveOptions] = useState(false);
  if (!value) return null;
  const isInCategory = columnIndex !== undefined;
  const {
    postItBaseStyles,
    tapeEffect
  } = getPostItStyles(false, false);
  if (isInCategory) {
    return <motion.div id={`card-${value.title}`} variants={cardVariants} initial="initial" animate="animate" exit="exit" whileHover="hover" transition={cardTransition} className={`${postItBaseStyles} ${tapeEffect} w-full min-h-[40px] relative`}>
        <CardContent title={value.title} description={value.description} isExpanded={isExpanded} controls={<CardControls onMoveUp={onMoveUp} onMoveDown={onMoveDown} onShowMoveOptions={() => setShowMoveOptions(!showMoveOptions)} currentCategory={currentCategory} isExpanded={isExpanded} onToggleExpand={() => setIsExpanded(!isExpanded)} value={value} // Add this
      />} />
        <AnimatePresence>
          {showMoveOptions && onMoveBetweenCategories && currentCategory && <div className="relative z-50">
              <CardMoveOptions value={value} currentCategory={currentCategory} onMoveBetweenCategories={onMoveBetweenCategories} onClose={() => setShowMoveOptions(false)} />
            </div>}
        </AnimatePresence>
      </motion.div>;
  }
  return <motion.div variants={cardVariants} initial="initial" animate="animate" exit="exit" whileHover="hover" transition={cardTransition} className={`${postItBaseStyles} ${tapeEffect} w-full sm:w-48 h-auto sm:h-48 max-w-sm mx-auto p-3 sm:p-4`}>
      <div className="relative z-10">
        <h3 className="font-medium text-gray-800 text-sm sm:text-base mb-2 sm:mb-3">{value.title}</h3>
        <p className="text-xs sm:text-sm text-gray-800 leading-relaxed">{value.description}</p>
      </div>
    </motion.div>;
}

================
File: src/components/features/Cards/components/Card.tsx
================
'use client';

import { memo, useRef, useState } from 'react';
import type { CardProps, DroppedValue } from '@/components/features/Cards/types';
import { getEnvBoolean } from "@/lib/utils/config";
import { CardControls } from './CardControls';
import { CardMoveOptions } from './CardMoveOptions';
import { CardContent } from './CardContent';
import { getPostItStyles } from './styles';
import { CategoryName, Value } from "@/lib/types";
import { useMobile } from "@/lib/contexts/MobileContext";


const Card = memo(function Card({
  value,
  onDrop,
  onMoveUp,
  onMoveDown,
  onMoveBetweenCategories,
  currentCategory,
  columnIndex,
  onClick,
  selectedMobileCard
}: CardProps) {
  const debug = getEnvBoolean('debug', false);
  const [isDragging, setIsDragging] = useState(false);
  const [isOver, setIsOver] = useState(false);
  const [isExpanded, setIsExpanded] = useState(false);
  const [showMoveOptions, setShowMoveOptions] = useState(false);
  const draggedIndexRef = useRef<number | null>(null);
  const {
    isMobile
  } = useMobile();
  if (!value) return null;
  const isInCategory = columnIndex !== undefined;
  const handleDragStart = (e: React.DragEvent<HTMLDivElement>): void => {
    if (isMobile) {
      e.preventDefault();
      return;
    }
    setIsDragging(true);
    draggedIndexRef.current = columnIndex !== undefined ? columnIndex : null;
    const dragData = {
      id: value.id,
      title: value.title,
      description: value.description,
      sourceCategory: currentCategory,
      sourceIndex: columnIndex,
      isInternalDrag: isInCategory
    };
    e.dataTransfer.setData('text/plain', JSON.stringify(dragData));
    e.dataTransfer.effectAllowed = 'move';
    if (debug) console.log('🎪 Card dragStart:', dragData);
  };
  const handleDragOver = (e: React.DragEvent<HTMLDivElement>): void => {
    if (isMobile) return;
    e.preventDefault();
    e.stopPropagation();
    e.dataTransfer.dropEffect = 'move';
    setIsOver(true);
  };
  const handleDrop = (e: React.DragEvent<HTMLDivElement>) => {
    if (isMobile) return;
    e.preventDefault();
    e.stopPropagation();
    setIsOver(false);
    try {
      const droppedData = JSON.parse(e.dataTransfer.getData('text/plain'));
      const sourceIndex = droppedData.sourceIndex;
      const targetIndex = columnIndex;
      const sourceCategory = droppedData.sourceCategory;
      if (debug) {
        console.log('📥 Drop data:', {
          droppedData,
          sourceIndex,
          targetIndex,
          sourceCategory,
          currentCategory
        });
      }

      // Handle internal category reordering
      if (droppedData.isInternalDrag && sourceCategory === currentCategory && sourceIndex !== undefined && targetIndex !== undefined) {
        if (sourceIndex < targetIndex) {
          onMoveDown?.();
        } else if (sourceIndex > targetIndex) {
          onMoveUp?.();
        }
      }
      // Handle between category movement
      else if (sourceCategory && currentCategory && sourceCategory !== currentCategory) {
        onMoveBetweenCategories?.({
          id: droppedData.id,
          title: droppedData.title,
          description: droppedData.description
        }, sourceCategory, currentCategory);
      }
      // Handle new card drop
      else if (onDrop) {
        onDrop(droppedData);
      }
    } catch (error) {
      console.error('Error handling drop:', error);
    }
  };
  const handleDragEnd = (): void => {
    if (isMobile) return;
    setIsDragging(false);
    setIsOver(false);
    draggedIndexRef.current = null;
    if (debug) console.log('🏁 Card dragEnd:', {
      value,
      columnIndex
    });
  };
  const handleDragEnter = (e: React.DragEvent<HTMLDivElement>): void => {
    if (isMobile) return;
    e.preventDefault();
    e.stopPropagation();
    setIsOver(true);
  };
  const handleDragLeave = (e: React.DragEvent<HTMLDivElement>): void => {
    if (isMobile) return;
    e.preventDefault();
    e.stopPropagation();
    setIsOver(false);
  };
  const handleCardClick = () => {
    if (isMobile && onClick) {
      onClick(value);
    }
  };
  const {
    postItBaseStyles,
    tapeEffect
  } = getPostItStyles(isDragging, isOver);
  const cardContainerClasses = `
    ${postItBaseStyles} 
    ${tapeEffect} 
    ${isInCategory ? 'w-full max-w-full min-h-[40px]' : 'w-48 h-48'}
    relative select-none cursor-move
    ${isMobile ? 'touch-manipulation' : ''}
    ${isOver ? 'border-2 border-blue-300' : ''}
    ${isMobile && onClick && !isInCategory ? 'hover:bg-yellow-100 active:bg-yellow-200' : ''}
    ${selectedMobileCard ? 'bg-yellow-200' : ''} // Add this for selected state
`;
  if (isInCategory) {
    return (
      <div
        id={`card-${value.id}`}
        data-index={columnIndex}
        data-dropzone="true"
        draggable="true"
        onClick={handleCardClick}
        onDragStart={handleDragStart}
        onDragEnd={handleDragEnd}
        onDragEnter={handleDragEnter}
        onDragLeave={handleDragLeave}
        onDragOver={handleDragOver}
        onDrop={handleDrop}
        className={`${cardContainerClasses} group`}
        role="article"
        aria-label={`Value card: ${value.title}`}
        tabIndex={0}
        onKeyPress={e => {
          if (e.key === 'Enter' || e.key === ' ') {
            handleCardClick();
          }
        }}
      >
        <div className="relative flex">
          <div className="flex-1 pr-10">
            <CardContent
              title={value.title}
              description={value.description}
              isExpanded={isExpanded}
              controls={!isMobile ? (
                <div className="absolute -right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-200">
                  <CardControls
                    onMoveUp={onMoveUp}
                    onMoveDown={onMoveDown}
                    onShowMoveOptions={() => setShowMoveOptions(!showMoveOptions)}
                    currentCategory={currentCategory}
                    isExpanded={isExpanded}
                    onToggleExpand={() => setIsExpanded(!isExpanded)}
                    value={value}
                  />
                </div>
              ) : null}
            />
          </div>
        </div>
        {!isMobile && showMoveOptions && onMoveBetweenCategories && currentCategory && (
          <div className="absolute right-2 top-8 z-50" role="dialog" aria-label="Move options">
            <CardMoveOptions
              value={value}
              currentCategory={currentCategory}
              onMoveBetweenCategories={onMoveBetweenCategories}
              onClose={() => setShowMoveOptions(false)}
            />
          </div>
        )}
      </div>
    );
  }
  return <div draggable="true" onClick={handleCardClick} onDragStart={handleDragStart} onDragEnd={handleDragEnd} onDragEnter={handleDragEnter} onDragLeave={handleDragLeave} onDragOver={handleDragOver} onDrop={handleDrop} className={cardContainerClasses} role="article" aria-label={`Value card: ${value.title}`} tabIndex={0} onKeyPress={e => {
    if (e.key === 'Enter' || e.key === ' ') {
      handleCardClick();
    }
  }}>
    <div className="relative z-10 pointer-events-none" role="region" aria-label={`Content for ${value.title}`}>
      <h3 className="font-medium text-gray-800 mb-3">{value.title}</h3>
      <p className="text-sm text-gray-800 leading-relaxed">{value.description}</p>
    </div>
  </div>;
});
export default Card;

================
File: src/components/features/Cards/components/CardContent.tsx
================
// src/components/Card/CardContent.tsx
import { motion, AnimatePresence } from 'framer-motion';
import { CardContentProps } from '@/components/features/Cards/types';

export function CardContent({
  title,
  description,
  isExpanded,
  controls
}: Omit<CardContentProps, 'onToggle'> & { controls?: React.ReactNode }) {
  const headingId = `heading-${title.toLowerCase().replace(/\s+/g, '-')}`;
  const descriptionId = `description-${title.toLowerCase().replace(/\s+/g, '-')}`;

  return (
    <div
      className="flex flex-col w-full p-2"
      role="region"
      aria-labelledby={headingId}
    >
      <div
        className="flex items-start justify-between gap-2 w-full"
        role="heading"
        aria-level={3}
      >
        <h3
          id={headingId}
          className="font-medium text-gray-800 text-sm sm:text-base flex-1 break-words pr-2"
        >
          {title}
        </h3>

        {controls && (
          <div
            className="flex-shrink-0 ml-auto pointer-events-auto" // Add pointer-events-auto here
            role="toolbar"
            aria-label={`Controls for ${title}`}
          >
            {controls}
          </div>
        )}
      </div>

      <AnimatePresence>
        {isExpanded && (
          <motion.div
            initial={{ opacity: 0, height: 0 }}
            animate={{ opacity: 1, height: 'auto' }}
            exit={{ opacity: 0, height: 0 }}
            transition={{ duration: 0.2 }}
            className="mt-2 border-t border-gray-100 pt-2"
            role="region"
            aria-labelledby={descriptionId}
          >
            <p
              id={descriptionId}
              className="px-4 pb-3 text-base text-gray-800 leading-relaxed"
              aria-expanded={isExpanded}
            >
              <span className="sr-only">Description: </span>
              {description}
            </p>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}

================
File: src/components/features/Cards/components/CardControls.tsx
================
// src/components/Card/CardControls.tsx
import { TouchEvent as ReactTouchEvent, MouseEvent as ReactMouseEvent } from 'react';
import { Value } from "@/lib/types";
import { ExtendedCardControlsProps } from '@/components/features/Cards/types';

export function CardControls({
  onMoveUp,
  onMoveDown,
  onShowMoveOptions,
  currentCategory,
  isExpanded,
  onToggleExpand,
  value
}: ExtendedCardControlsProps) {
  const handleButtonClick = (e: ReactMouseEvent<HTMLButtonElement> | ReactTouchEvent<HTMLButtonElement>, action: () => void) => {
    e.stopPropagation();
    e.preventDefault();
    action();
  };
  const buttonBaseClass = `
    p-1.5 text-gray-700 hover:text-gray-900 rounded text-sm 
    hover:bg-gray-100 active:bg-gray-200 transition-colors touch-none select-none
    focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1
  `;
  return <div className="flex gap-0 items-center justify-end min-w-[120px] ml-auto pointer-events-auto" // Add pointer-events-auto here
  role="toolbar" aria-label={`Controls for ${value.title}`} onTouchStart={(e: ReactTouchEvent) => e.stopPropagation()} onClick={(e: ReactMouseEvent) => e.stopPropagation()}>
      <div role="group" aria-label="Card actions">
        <button type="button" onClick={e => handleButtonClick(e, () => onToggleExpand?.())} onTouchStart={e => handleButtonClick(e, () => onToggleExpand?.())} className={buttonBaseClass} aria-label={`${isExpanded ? 'Collapse' : 'Expand'} card details`} aria-expanded={isExpanded} aria-controls={`description-${value.id}`}>
          <span className="inline-block w-4 text-center" aria-hidden="true">
            {isExpanded ? '▼' : '▶︎'}
          </span>
        </button>

        {onMoveUp && <button type="button" onClick={e => handleButtonClick(e, onMoveUp)} onTouchStart={e => handleButtonClick(e, onMoveUp)} className={buttonBaseClass} aria-label={`Move ${value.title} up in ${currentCategory}`}>
            <span className="inline-block w-4 text-center" aria-hidden="true">
              ↑
            </span>
          </button>}

        {onMoveDown && <button type="button" onClick={e => handleButtonClick(e, onMoveDown)} onTouchStart={e => handleButtonClick(e, onMoveDown)} className={buttonBaseClass} aria-label={`Move ${value.title} down in ${currentCategory}`}>
            <span className="inline-block w-4 text-center" aria-hidden="true">
              ↓
            </span>
          </button>}

        {currentCategory && <button type="button" id={`options-${value.id}`} onClick={e => handleButtonClick(e, onShowMoveOptions)} onTouchStart={e => handleButtonClick(e, onShowMoveOptions)} className={buttonBaseClass} aria-label={`Show move options for ${value.title}`} aria-haspopup="true">
            <span className="inline-block w-4 text-center" aria-hidden="true">
              ⋮
            </span>
          </button>}
      </div>
    </div>;
}

================
File: src/components/features/Cards/components/CardMoveOptions.tsx
================
// src/components/Card/CardMoveOptions.tsx
import { motion } from 'framer-motion';
import { createPortal } from 'react-dom';
import { useEffect, useState, useCallback } from 'react';
import { CardMoveOptionsProps } from '@/components/features/Cards/types';
import { CategoryName } from "@/lib/types";
import { allCategories } from "@/components/features/Categories/constants/categories"; // Use centralized categories

export function CardMoveOptions({
  value,
  currentCategory,
  onMoveBetweenCategories,
  onClose
}: CardMoveOptionsProps) {
  const [mounted, setMounted] = useState(false);
  const [position, setPosition] = useState({
    top: 0,
    left: 0
  });
  const updatePosition = useCallback(() => {
    const button = document.getElementById(`options-${value.id}`);
    if (button) {
      const rect = button.getBoundingClientRect();
      const isMobile = window.innerWidth < 768;
      if (isMobile) {
        setPosition({
          top: rect.bottom + window.scrollY,
          left: Math.max(10, Math.min(window.innerWidth - 210, rect.right + window.scrollX - 200))
        });
      } else {
        setPosition({
          top: rect.bottom + window.scrollY,
          left: rect.right + window.scrollX - 200
        });
      }
    }
  }, [value.id]);
  useEffect(() => {
    setMounted(true);
    updatePosition();
    window.addEventListener('resize', updatePosition);
    return () => window.removeEventListener('resize', updatePosition);
  }, [updatePosition]);
  useEffect(() => {
    const handleClickOutside = (event: Event) => {
      const target = event.target as HTMLElement;
      if (!target.closest(`#options-${value.id}`) && !target.closest('.move-options-menu')) {
        onClose();
      }
    };
    const handleEscape = (event: KeyboardEvent) => {
      if (event.key === 'Escape') {
        onClose();
      }
    };
    document.addEventListener('mousedown', handleClickOutside);
    document.addEventListener('touchstart', handleClickOutside);
    document.addEventListener('keydown', handleEscape);
    return () => {
      document.removeEventListener('mousedown', handleClickOutside);
      document.removeEventListener('touchstart', handleClickOutside);
      document.removeEventListener('keydown', handleEscape);
    };
  }, [value.id, onClose]);
  const menuContent = <motion.div className="move-options-menu w-48 bg-white rounded-md shadow-lg border 
                border-gray-200 py-1 touch-manipulation" initial={{
    opacity: 0,
    y: -10
  }} animate={{
    opacity: 1,
    y: 0
  }} exit={{
    opacity: 0,
    y: -10
  }} style={{
    position: 'fixed',
    top: `${position.top}px`,
    left: `${position.left}px`,
    zIndex: 9999
  }} role="dialog" aria-label={`Move options for ${value.title}`} aria-modal="true">
      <div role="menu" aria-label="Available categories">
        {allCategories.filter(cat => cat !== currentCategory).map(category => <button key={category} type="button" onClick={() => {
        onMoveBetweenCategories(value, currentCategory, category);
        onClose();
      }} className="block w-full text-left px-4 py-3 text-sm text-gray-700 
                       hover:bg-gray-100 active:bg-gray-100 transition-colors
                       touch-manipulation select-none focus:outline-none focus:bg-gray-50
                       focus:ring-2 focus:ring-inset focus:ring-blue-500" role="menuitem" aria-label={`Move to ${category} category`}>
              Move to {category}
            </button>)}
      </div>
      <button onClick={onClose} className="sr-only" aria-label="Close move options">
        Close
      </button>
    </motion.div>;
  if (!mounted) return null;
  return createPortal(menuContent, document.getElementById('portal-root') || document.body);
}

================
File: src/components/features/Cards/components/index.ts
================
export { default as Card } from './Card';
export { AnimatedCard } from './AnimatedCard';

================
File: src/components/features/Cards/components/MobileCardActions/index.tsx
================
// src/components/Mobile/MobileCardActions.tsx
import React from 'react';
import { Value, CategoryName } from "@/lib/types";
import {MobileCardActionsProps } from "@/components/features/Cards/types";

export const MobileCardActions: React.FC<MobileCardActionsProps> = ({
  card,
  onMoveUp,
  onMoveDown,
  onMoveBetweenCategories,
  canMoveUp,
  canMoveDown,
  category
}) => {
  if (!category) return null;
  const baseButtonClasses = `
    p-2 rounded 
    focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2
    transition-colors duration-200
  `;
  return <div className="flex gap-2 mt-2" role="toolbar" aria-label={`Actions for ${card.title} in ${category}`}>
      <div role="group" aria-label="Reorder controls" className="flex gap-2">
        <button onClick={onMoveUp} disabled={!canMoveUp} className={`${baseButtonClasses} ${canMoveUp ? 'bg-blue-100 hover:bg-blue-150 active:bg-blue-200 text-blue-700' : 'bg-gray-100 text-gray-400 cursor-not-allowed'}`} aria-label={`Move ${card.title} up in ${category}`} tabIndex={canMoveUp ? 0 : -1}>
          <span aria-hidden="true">↑</span>
          <span className="sr-only">Move Up</span>
        </button>
        <button onClick={onMoveDown} disabled={!canMoveDown} className={`${baseButtonClasses} ${canMoveDown ? 'bg-blue-100 hover:bg-blue-150 active:bg-blue-200 text-blue-700' : 'bg-gray-100 text-gray-400 cursor-not-allowed'}`} aria-label={`Move ${card.title} down in ${category}`} tabIndex={canMoveDown ? 0 : -1}>
          <span aria-hidden="true">↓</span>
          <span className="sr-only">Move Down</span>
        </button>
      </div>

      <button onClick={onMoveBetweenCategories} className={`${baseButtonClasses} 
          bg-blue-100 hover:bg-blue-150 active:bg-blue-200 
          flex-grow text-blue-700`} aria-label={`Move ${card.title} to different category`} aria-haspopup="true">
        <span aria-hidden="true">Move to...</span>
        <span className="sr-only">
          Select new category for {card.title}
        </span>
      </button>
    </div>;
};

================
File: src/components/features/Cards/components/styles.ts
================
export const getPostItStyles = (isDragging: boolean, isOver: boolean) => {
  const postItBaseStyles = `
    relative
    p-4
    rounded-sm
    transform
    transition-all
    duration-200
    cursor-move
    bg-gradient-to-br
    from-yellow-100
    to-yellow-200
    shadow-[2px_3px_10px_rgba(0,0,0,0.3)]
    hover:shadow-[3px_5px_12px_rgba(0,0,0,0.35)]
    ${Math.random() > 0.5 ? 'rotate-1' : '-rotate-1'}
    ${isDragging ? 'scale-105 opacity-75 z-50' : ''}
    ${isOver ? 'ring-2 ring-blue-400' : ''}
  `;

  const tapeEffect = `
    before:content-['']
    before:absolute
    before:-top-2
    before:left-1/2
    before:-translate-x-1/2
    before:w-8
    before:h-4
    before:bg-[rgba(255,255,255,0.5)]
    before:rounded-sm
    before:transform
    before:rotate-2
    after:content-['']
    after:absolute
    after:top-0
    after:left-0
    after:right-0
    after:h-8
    after:bg-gradient-to-b
    after:from-yellow-50/30
    after:to-transparent
  `;

  return { postItBaseStyles, tapeEffect };
};

================
File: src/components/features/Cards/hooks/useCardDragAnimation.ts
================
import { useState } from 'react';
import { Position } from "@/lib/types";
import { useAnimation } from '@/lib/hooks/useAnimation';
export const useCardDragAnimation = (initialPosition: Position, onDragEnd?: (endPosition: Position) => void) => {
  const [isDragging, setIsDragging] = useState(false);
  const {
    x,
    y
  } = useAnimation(initialPosition, {
    stiffness: 500,
    damping: 35,
    mass: 1
  });
  const handleDragStart = () => {
    setIsDragging(true);
  };
  const handleDragEnd = () => {
    setIsDragging(false);
    if (onDragEnd) {
      onDragEnd({
        x: x.get(),
        y: y.get()
      });
    }
  };
  return {
    isDragging,
    x,
    y,
    handleDragStart,
    handleDragEnd
  };
};

================
File: src/components/features/Cards/types.ts
================
import { Value, CategoryName } from "@/lib/types";

export interface DroppedValue extends Value {
  sourceCategory?: CategoryName;
  isInternalDrag?: boolean;
  sourceIndex?: number;
}

export interface ExtendedCardControlsProps extends CardControlsProps {
  isExpanded?: boolean;
  onToggleExpand?: () => void;
  value: Value;
}

export interface CardProps {
  value: Value;
  columnIndex?: number;
  currentCategory?: CategoryName;
  onDrop?: (value: Value & { sourceCategory?: CategoryName }) => void;
  onMoveUp?: () => void;
  onMoveDown?: () => void;
  onMoveBetweenCategories?: (value: Value, fromCategory: CategoryName, toCategory: CategoryName) => void;
  onActiveDropZoneChange?: (category: CategoryName | null) => void;
  onClick?: (value: Value) => void;
  selectedMobileCard?: boolean;
}

export interface CardContentProps {
  title: string;
  description: string;
  isExpanded: boolean;
  controls?: React.ReactNode;
}

export interface CardControlsProps {
  onMoveUp?: () => void;
  onMoveDown?: () => void;
  onShowMoveOptions: () => void;
  currentCategory?: CategoryName;
}

export interface CardMoveOptionsProps {
  value: Value;
  currentCategory: CategoryName;
  onMoveBetweenCategories: (value: Value, fromCategory: CategoryName, toCategory: CategoryName) => void;
  onClose: () => void;
}

export interface MobileCardActionsProps {
  card: Value;
  category?: CategoryName;
  onMoveUp?: () => void;
  onMoveDown?: () => void;
  onMoveBetweenCategories: () => void;
  canMoveUp: boolean;
  canMoveDown: boolean;
}

================
File: src/components/features/Categories/components/CategoryColumn/index.tsx
================
// src/components/CategoryColumn.tsx
import { Value, CategoryName } from "@/lib/types";
import { Card } from "@/components/features/Cards/components"; // Change this import
import {CategoryColumnProps} from "@/components/features/Categories/types";

export default function CategoryColumn({
  title,
  cards,
  onDrop,
  onMoveWithinCategory,
  onMoveBetweenCategories,
  columnIndex
}: CategoryColumnProps) {
  const handleDragOver = (e: React.DragEvent<HTMLDivElement>) => {
    e.preventDefault();
    e.stopPropagation();
    e.currentTarget.classList.add('bg-gray-50');
  };
  const handleDragLeave = (e: React.DragEvent<HTMLDivElement>) => {
    e.preventDefault();
    e.stopPropagation();
    e.currentTarget.classList.remove('bg-gray-50');
  };
  const handleDrop = (e: React.DragEvent<HTMLDivElement>) => {
    e.preventDefault();
    e.stopPropagation();
    e.currentTarget.classList.remove('bg-gray-50');
    try {
      const data = JSON.parse(e.dataTransfer.getData('text/plain'));

      // If dropping into the same category
      if (data.sourceCategory === title) {
        const fromIndex = data.sourceIndex;
        const toIndex = cards.length; // Drop at the end
        onMoveWithinCategory(fromIndex, toIndex);
      }
      // If dropping from another category
      else if (data.sourceCategory) {
        onMoveBetweenCategories({
          id: data.id,
          title: data.title,
          description: data.description
        }, data.sourceCategory, title);
      }
      // If dropping a new card
      else {
        onDrop({
          id: data.id,
          title: data.title,
          description: data.description
        }, title);
      }
    } catch (error) {
      console.error('Error handling drop:', error);
    }
  };
  return <div className="bg-white rounded-lg shadow-sm p-4 transition-colors duration-200 w-full" data-category={title} aria-label={`${title} category`}>
      <div className="flex items-center justify-between mb-4">
        <h2 className="text-lg font-semibold text-gray-900 flex items-center justify-between w-full">
          <span>{title}</span>
          <span className="bg-gray-100 rounded-full px-2.5 py-0.5 text-sm font-medium text-gray-700 ml-2">
            {cards.length}
          </span>
        </h2>
      </div>

      <div className="border-2 border-dashed border-gray-400 rounded-lg p-2 min-h-[400px] transition-colors duration-200" onDragOver={handleDragOver} onDragLeave={handleDragLeave} onDrop={handleDrop} role="region" aria-label={`Drop zone for ${title} category`}>
        <div className="space-y-2">
          {cards.map((card, index) => <div key={card.id} className="transition-all duration-200">
              <Card value={card} columnIndex={index} currentCategory={title} onDrop={value => onDrop(value, title)} onMoveUp={index > 0 ? () => onMoveWithinCategory(index, index - 1) : undefined} onMoveDown={index < cards.length - 1 ? () => onMoveWithinCategory(index, index + 1) : undefined} onMoveBetweenCategories={onMoveBetweenCategories} />
            </div>)}
        </div>

        <div className={`text-gray-700 text-sm text-center py-4 mt-2 ${cards.length === 0 ? '' : 'border-t-2 border-dashed border-gray-400'}`}>
          Drop values here
        </div>
      </div>
    </div>;
}

================
File: src/components/features/Categories/components/Mobile/CategorySelectionOverlay.tsx
================
import type { CategorySelectionOverlayProps } from '@/components/features/Categories/types';
// src/components/Mobile/CategorySelectionOverlay.tsx
import React from 'react';
import { allCategories } from "@/components/features/Categories/constants/categories";
import { CategoryName } from "@/lib/types";
export const CategorySelectionOverlay: React.FC<CategorySelectionOverlayProps> = ({
  onCategorySelect,
  isVisible,
  instruction = "Select a category for this card"
}) => {
  if (!isVisible) return null;
  return <div className="fixed inset-0 bg-white z-50 flex flex-col" role="dialog" aria-modal="true" aria-labelledby="category-selection-title">
      <div className="p-4 text-center" role="heading" aria-level={2}>
        <h2 id="category-selection-title" className="text-lg font-semibold">
          {instruction}
        </h2>
      </div>

      <div className="grid grid-cols-2 gap-4 p-4" role="group" aria-label="Available categories">
        {allCategories.map((category, index) => <button key={category} onClick={() => onCategorySelect(category)} className="bg-blue-100 p-4 rounded-lg text-center font-medium 
                     hover:bg-blue-200 active:bg-blue-300 
                     focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2" aria-label={`Select ${category} category`} tabIndex={0}
      // Improved keyboard navigation
      onKeyDown={e => {
        if (e.key === 'Enter' || e.key === ' ') {
          onCategorySelect(category);
        }
        // Add arrow key navigation
        if (e.key === 'ArrowRight' && index < allCategories.length - 1) {
          const nextButton = document.querySelector(`[data-category-index="${index + 1}"]`) as HTMLElement;
          nextButton?.focus();
        }
        if (e.key === 'ArrowLeft' && index > 0) {
          const prevButton = document.querySelector(`[data-category-index="${index - 1}"]`) as HTMLElement;
          prevButton?.focus();
        }
      }} data-category-index={index}>
            <span className="sr-only">Select category: </span>
            {category}
          </button>)}
      </div>

      {/* Add a hidden close button for screen readers */}
      <button onClick={() => onCategorySelect(allCategories[0])} // Default to first category
    className="sr-only" aria-label="Close category selection">
        Close
      </button>
    </div>;
};

================
File: src/components/features/Categories/constants/categories.ts
================
import { Categories, CategoryName } from "@/lib/types";
export const allCategories: CategoryName[] = ['Very Important', 'Quite Important', 'Important', 'Of Some Importance', 'Not Important'] as const;
export const emptyCategories: Categories = allCategories.reduce((acc, category) => {
  acc[category] = [];
  return acc;
}, {} as Categories);

// Create a constant for initial categories
export const initialCategories: Categories = {
  'Very Important': [],
  'Quite Important': [],
  'Important': [],
  'Of Some Importance': [],
  'Not Important': []
};

================
File: src/components/features/Categories/types.ts
================
// Generated types file

import { CategoryName,Value } from "@/lib/types";

export interface CategoryColumnProps {
  title: CategoryName;
  cards: Value[];
  onDrop: (value: Value, category: CategoryName) => void;
  onMoveWithinCategory: (fromIndex: number, toIndex: number) => void;
  onMoveBetweenCategories: (value: Value, fromCategory: CategoryName, toCategory: CategoryName) => void;
  columnIndex?: number;
}
export interface CategorySelectionOverlayProps {
  onCategorySelect: (category: CategoryName) => void;
  isVisible: boolean;
  instruction?: string;
}

================
File: src/components/features/Categories/utils/categoryUtils.ts
================
import { Categories, CategoryName, Value } from "@/lib/types";
import { getGameConfig } from "@/lib/utils/config/gameConfig";
export const getImportantCards = (categories: Categories): Value[] => {
  const importantCards: Value[] = [];

  // Always check Very Important as it exists in all rounds
  if ('Very Important' in categories) {
    importantCards.push(...categories['Very Important']);
  }

  // Check optional categories based on round type
  if ('Quite Important' in categories && categories['Quite Important']) {
    importantCards.push(...categories['Quite Important']);
  }
  if ('Important' in categories && categories['Important']) {
    importantCards.push(...categories['Important']);
  }
  if ('Of Some Importance' in categories && categories['Of Some Importance']) {
    importantCards.push(...categories['Of Some Importance']);
  }
  return importantCards;
};
export const getCategoriesForRound = (cardCount: number, targetValue: number): Categories => {
  const ratio = cardCount / targetValue;
  const {
    ratioThresholds
  } = getGameConfig();
  const categories = {} as Categories;
  if (ratio <= ratioThresholds.final) {
    categories['Very Important'] = [];
    categories['Not Important'] = [];
  } else if (ratio <= ratioThresholds.reduced) {
    categories['Very Important'] = [];
    categories['Quite Important'] = [];
    categories['Not Important'] = [];
  } else if (ratio <= ratioThresholds.standard) {
    categories['Very Important'] = [];
    categories['Quite Important'] = [];
    categories['Important'] = [];
    categories['Not Important'] = [];
  } else {
    categories['Very Important'] = [];
    categories['Quite Important'] = [];
    categories['Important'] = [];
    categories['Of Some Importance'] = [];
    categories['Not Important'] = [];
  }
  return categories;
};
export const getCategoryNames = (ratio: number): CategoryName[] => {
  if (ratio <= 1.5) {
    return ['Very Important', 'Not Important'];
  } else if (ratio <= 2) {
    return ['Very Important', 'Quite Important', 'Not Important'];
  } else if (ratio <= 3) {
    return ['Very Important', 'Quite Important', 'Important', 'Not Important'];
  }
  return ['Very Important', 'Quite Important', 'Important', 'Of Some Importance', 'Not Important'];
};

================
File: src/components/features/Exercise/commands/BaseCommand.ts
================
import { Command } from "@/lib/types/Command";
import { Position } from "@/lib/types/Position";
export abstract class BaseCommand implements Command {
  public readonly timestamp: number;
  constructor(public readonly type: string, public readonly payload: unknown) {
    this.timestamp = Date.now();
  }
  public sourcePosition?: Position;
  public targetPosition?: Position;
  setPositions(source?: Position, target?: Position): Command {
    this.sourcePosition = source;
    this.targetPosition = target;
    return this;
  }
}

================
File: src/components/features/Exercise/commands/Command.ts
================
import { Position } from "@/lib/types";
export class Command {
  type: string;
  payload: any;
  timestamp: number;
  sourcePosition?: Position;
  targetPosition?: Position;
  constructor(type: string, payload: any) {
    this.type = type;
    this.payload = payload;
    this.timestamp = Date.now();
  }
  setPositions(source?: Position, target?: Position) {
    this.sourcePosition = source;
    this.targetPosition = target;
    return this;
  }
}

================
File: src/components/features/Exercise/commands/DropCommand.ts
================
import { BaseCommand } from './BaseCommand';
import { CategoryName, Value } from "@/lib/types";
import { getCardPosition, getCategoryPosition } from "@/lib/utils";
import { DropCommandPayload } from "@/lib/types";
export class DropCommand extends BaseCommand {
  constructor(value: Value, category: CategoryName) {
    const payload: DropCommandPayload = {
      cardId: value.id,
      cardTitle: value.title,
      category
    };
    super('DROP', payload);

    // Capture positions when command is created
    const sourcePos = getCardPosition(value.id);
    const targetPos = getCategoryPosition(category);
    this.setPositions(sourcePos, targetPos);
  }
  getPayload(): DropCommandPayload {
    return this.payload as DropCommandPayload;
  }
}

================
File: src/components/features/Exercise/commands/MoveCommand.ts
================
import { BaseCommand } from './BaseCommand';
import { CategoryName, Value } from "@/lib/types";
import { getCardPosition, getCategoryPosition } from "@/lib/utils/dom";
import { MoveCommandPayload } from "@/lib/types";
export class MoveCommand extends BaseCommand {
  constructor(value: Value, fromCategory: CategoryName, toCategory: CategoryName, fromIndex?: number, toIndex?: number) {
    const payload: MoveCommandPayload = {
      cardId: value.id,
      cardTitle: value.title,
      fromCategory,
      toCategory,
      fromIndex,
      toIndex
    };
    super('MOVE', payload);

    // Capture positions when command is created
    const sourcePos = getCardPosition(value.id);
    const targetPos = getCategoryPosition(toCategory);
    this.setPositions(sourcePos, targetPos);
  }
  getPayload(): MoveCommandPayload {
    return this.payload as MoveCommandPayload;
  }
}

================
File: src/components/features/Exercise/components/CoreValueReasoning/index.tsx
================
// src/components/CoreValueReasoning.tsx
import { useEffect, useState } from 'react';
import { Value, ValueWithReason } from "@/lib/types";
import { motion } from 'framer-motion';
import { getPostItStyles } from "@/components/features/Cards/components/styles";
import {CoreValueReasoningProps} from '@/components/features/Exercise/types';

export function CoreValueReasoning({
  values,
  onComplete
}: CoreValueReasoningProps) {
  const [reasons, setReasons] = useState<Record<string, string>>({});
  const {
    postItBaseStyles,
    tapeEffect
  } = getPostItStyles(false, false);
  useEffect(() => {
    // Check if all values have non-empty reasons
    const hasAllReasons = values.every(value => reasons[value.id]?.trim());
  }, [reasons, values]);
  const handleReasonChange = (valueId: string, reason: string) => {
    setReasons(prev => ({
      ...prev,
      [valueId]: reason
    }));
  };
  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    const valuesWithReasons: ValueWithReason[] = values.map(value => ({
      ...value,
      reason: reasons[value.id]?.trim() || '' // Empty string if no reason given
    }));
    onComplete(valuesWithReasons);
  };
  return <div className="container mx-auto px-4 py-8" role="region" aria-labelledby="reasoning-title">
            <h1 id="reasoning-title" className="text-2xl font-bold mb-6">
                Why are these values meaningful to you?
            </h1>
            <p className="text-gray-700 mb-6">
                Optionally, explain why each value is meaningful to you. This can help you reflect on your choices.
            </p>
            
            <form onSubmit={handleSubmit} className="space-y-6">
                <div className="space-y-6 mb-8" role="list" aria-label="Value reflection entries">
                    {values.map((value, index) => <motion.div key={value.id} className={`${postItBaseStyles} ${tapeEffect} p-6`} initial={{
          opacity: 0,
          y: 20
        }} animate={{
          opacity: 1,
          y: 0
        }} role="listitem">
                            <div role="group" aria-labelledby={`value-title-${value.id}`}>
                                <h2 id={`value-title-${value.id}`} className="font-bold text-lg mb-2">
                                    {value.title}
                                </h2>
                                <p className="text-gray-700 mb-4">
                                    {value.description}
                                </p>
                                <div>
                                    <label htmlFor={`reason-${value.id}`} className="block text-sm font-medium text-gray-800 mb-2">
                                        Why is this value meaningful to you? (Optional)
                                    </label>
                                    <textarea id={`reason-${value.id}`} className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500" rows={3} value={reasons[value.id] || ''} onChange={e => handleReasonChange(value.id, e.target.value)} placeholder="Share your thoughts... (optional)" aria-label={`Reasoning for ${value.title}`} />
                                </div>
                            </div>
                        </motion.div>)}
                </div>
                
                <div className="flex justify-end">
                    <button type="submit" className="px-6 py-2 rounded-md transition-colors bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2" aria-label="Save reasons and view results">
                        Continue to Results
                    </button>
                </div>
            </form>
        </div>;
}

================
File: src/components/features/Exercise/components/Results/index.tsx
================
// src/components/Results.tsx
'use client';

import { getPostItStyles } from "@/components/features/Cards/components/styles";
import { useRef, useEffect, useState } from 'react';
import { ValueWithReason, Categories, CategoryName } from "@/lib/types";
import Link from 'next/link';
import { useGameState } from "@/components/features/Exercise/hooks/useGameState";
import { clearGameState } from "@/lib/utils/storage";
import { getCompletedSession } from "@/lib/db/indexedDB";
import { useSession } from "@/components/features/Exercise/hooks/useSession";
export default function Results() {
  const printRef = useRef<HTMLDivElement>(null);
  const [mounted, setMounted] = useState(false);
  const {
    categories
  } = useGameState();
  const {
    sessionId
  } = useSession();
  const [enrichedCategories, setEnrichedCategories] = useState<Categories>(categories);
  useEffect(() => {
    setMounted(true);
    const enrichCategoriesWithReasons = async () => {
      if (sessionId) {
        try {
          const completedSession = await getCompletedSession(sessionId);
          if (completedSession?.finalValues) {
            const reasonsMap = Object.fromEntries(completedSession.finalValues.map(value => [value.id, value.reason]));
            const enriched = Object.entries(categories).reduce((acc, [category, values = []]) => {
              acc[category as CategoryName] = (values as ValueWithReason[]).map(value => ({
                ...value,
                reason: reasonsMap[value.id]
              }));
              return acc;
            }, {} as Record<CategoryName, ValueWithReason[]>);
            setEnrichedCategories(enriched);
          }
        } catch (error) {
          console.error('Failed to load reasons:', error);
        }
      }
    };
    enrichCategoriesWithReasons();
  }, [sessionId, categories]);
  const handlePrint = () => {
    const printContent = printRef.current;
    if (!printContent) return;
    const winPrint = window.open('', '', 'left=0,top=0,width=800,height=900,toolbar=0,scrollbars=0,status=0');
    if (!winPrint) return;
    const style = document.createElement('style');
    style.textContent = `
      @media print {
        body { font-size: 12pt; }
        h1 { font-size: 24pt; }
        h2 { font-size: 18pt; }
        h3 { font-size: 14pt; }
      }
    `;
    winPrint.document.head.appendChild(style);
    winPrint.document.write(printContent.innerHTML);
    winPrint.document.close();
    winPrint.focus();
    winPrint.print();
    winPrint.close();
  };
  const handleNewExercise = () => {
    clearGameState();
  };
  const {
    postItBaseStyles,
    tapeEffect
  } = getPostItStyles(false, false);
  if (!mounted) return null;
  return <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 lg:py-12" role="region" aria-labelledby="results-title">
      <div ref={printRef} className="bg-white rounded-lg shadow-sm p-4 sm:p-6 lg:p-8">
        <h1 id="results-title" className="text-2xl sm:text-3xl lg:text-4xl font-bold mb-4 sm:mb-6 lg:mb-8 text-gray-900">
          Your Core Values Results
        </h1>

        <div className="space-y-6 sm:space-y-8 lg:space-y-10" role="list" aria-label="Categories and values">
          {(Object.entries(enrichedCategories) as [CategoryName, ValueWithReason[]][]).filter(([_, values]) => values && values.length > 0).map(([category, values]) => <section key={category} className="bg-gray-100 rounded-lg p-4 sm:p-6" aria-labelledby={`category-${category.toLowerCase().replace(/\s+/g, '-')}`}>
                <h2 id={`category-${category.toLowerCase().replace(/\s+/g, '-')}`} className="text-xl sm:text-2xl font-semibold mb-3 sm:mb-4 text-gray-800">
                  {category}
                </h2>
                <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 lg:gap-6" role="list" aria-label={`Values in ${category}`}>
                  {values.map((value: ValueWithReason) => <article key={value.id} className={`${postItBaseStyles} ${tapeEffect} p-4`} role="listitem">
                      <h3 className="font-medium text-base sm:text-lg text-gray-900 mb-2">
                        {value.title}
                      </h3>
                      <p className="text-sm sm:text-base text-gray-700 mb-3">
                        {value.description}
                      </p>
                      {value.reason && <div className="mt-3 pt-3 border-t border-gray-200" aria-label={`Personal meaning for ${value.title}`}>
                          <p className="text-sm font-medium text-gray-800 mb-1">
                            Why it is meaningful:
                          </p>
                          <p className="text-sm sm:text-base text-gray-700 italic">
                            {value.reason}
                          </p>
                        </div>}
                    </article>)}
                </div>
              </section>)}
        </div>
      </div>

      <div className="mt-6 sm:mt-8 lg:mt-10 flex flex-col sm:flex-row items-center justify-center gap-3 sm:gap-4" role="group" aria-label="Result actions">
        <button onClick={handlePrint} className="w-full sm:w-auto px-6 py-2 bg-blue-700 text-white rounded-lg hover:bg-blue-800 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-700 focus:ring-offset-2" aria-label="Print your results">
          Print Results
        </button>

        <Link href="/" onClick={handleNewExercise} className="w-full sm:w-auto px-6 py-2 bg-green-700 text-white rounded-lg hover:bg-green-800 transition-colors text-center focus:outline-none focus:ring-2 focus:ring-green-700 focus:ring-offset-2" aria-label="Start a new values exercise">
          Start New Exercise
        </Link>

        <Link href="/history" className="text-blue-700 hover:text-blue-800 underline focus:outline-none focus:ring-2 focus:ring-blue-700 focus:ring-offset-2 rounded px-2 py-1" aria-label="View all your previous results">
          View All Previous Results
        </Link>
      </div>
    </div>;
}

================
File: src/components/features/Exercise/hooks/useCommands.ts
================
'use client';

import { useCallback } from 'react';
import { useStore } from "@/lib/store/store";
import { Value, CategoryName } from "@/lib/types";
import { getRound, saveRound } from "@/lib/db/indexedDB";
import { DropCommand } from "@/components/features/Exercise/commands/DropCommand";
import { MoveCommand } from "@/components/features/Exercise/commands/MoveCommand";
import { shallow } from 'zustand/shallow';
export function useCommands() {
  const state = useStore(state => ({
    addCommand: state.addCommand,
    currentRound: state.currentRound,
    commands: state.commands,
    clearCommands: state.clearCommands,
    roundNumber: state.roundNumber,
    currentRoundCommands: state.currentRoundCommands
  }), shallow);
  const handleDrop = useCallback(async (value: Value, category: CategoryName) => {
    const command = new DropCommand(value, category);
    await state.addCommand(command);
  }, [state]);
  const handleMoveBetweenCategories = useCallback(async (value: Value, fromCategory: CategoryName, toCategory: CategoryName) => {
    const command = new MoveCommand(value, fromCategory, toCategory);
    await state.addCommand(command);
  }, [state]);
  const handleMoveWithinCategory = useCallback(async (category: CategoryName, fromIndex: number, toIndex: number, value: Value) => {
    const command = new MoveCommand(value, category, category, fromIndex, toIndex);
    await state.addCommand(command);
  }, [state]);
  const loadCommands = useCallback(async () => {
    if (state.currentRound) {
      const savedRound = await getRound(state.currentRound.sessionId, state.roundNumber);
      if (savedRound) {
        useStore.setState({
          currentRound: {
            sessionId: state.currentRound.sessionId,
            roundNumber: state.roundNumber,
            commands: savedRound.commands,
            availableCategories: state.currentRound.availableCategories,
            timestamp: savedRound.timestamp
          }
        });
      }
    }
  }, [state]);
  return {
    handleDrop,
    handleMoveBetweenCategories,
    handleMoveWithinCategory,
    loadCommands,
    currentRoundCommands: state.currentRoundCommands,
    addCommand: state.addCommand,
    clearCommands: state.clearCommands
  };
}

================
File: src/components/features/Exercise/hooks/useGameInit.ts
================
import { useState, useEffect } from 'react';
import { useRouter, useSearchParams } from 'next/navigation';
import { initDB } from "@/lib/db/indexedDB";
import { useSession } from "./useSession";
import { usePWA } from "@/lib/hooks/usePWA";
import { cacheUtils } from "@/lib/utils/storage";
import { loadSessionState } from "../utils/sessionLoader";
import { useGameState } from './useGameState';

export function useGameInit() {
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<Error | null>(null);
  const searchParams = useSearchParams();
  const { sessionId } = useSession();
  const { isOffline } = usePWA();
  const { setGameStarted } = useGameState();

  useEffect(() => {
    const initialize = async () => {
      try {
        await initDB();

        // Check for existing session or URL param session
        const urlSessionId = searchParams?.get('sessionId');
        const activeSessionId = sessionId || urlSessionId;

        if (activeSessionId) {
          await loadSessionState(activeSessionId);
          setGameStarted(true);
          return;
        }

        // No session found, check offline cache
        if (isOffline) {
          const cachedSession = await cacheUtils.getCachedData<{
            sessionId: string;
          }>('currentSession');

          if (!cachedSession) {
            throw new Error('No session found');
          }
        } else {
          throw new Error('No session found');
        }
      } catch (error) {
        setError(error instanceof Error ? error : new Error('Failed to initialize game'));
      } finally {
        setIsLoading(false);
      }
    };

    initialize();
  }, [isOffline, sessionId, searchParams, setGameStarted]);

  return {
    isLoading,
    error,
    shouldRedirect: error?.message === 'No session found'
  };
}

================
File: src/components/features/Exercise/hooks/useGameState.ts
================
'use client';

import { useStore } from "@/lib/store/store";
import { shallow } from 'zustand/shallow';
export function useGameState() {
  const state = useStore(state => ({
    remainingCards: state.remainingCards,
    categories: state.categories,
    isGameStarted: state.isGameStarted,
    showInstructions: state.showInstructions,
    commands: state.commands,
    currentRound: state.currentRound,
    addCommand: state.addCommand,
    setRemainingCards: state.setRemainingCards,
    setCategories: state.setCategories,
    setGameStarted: state.setGameStarted,
    setShowInstructions: state.setShowInstructions,
    resetGame: state.resetGame,
    clearCommands: state.clearCommands
  }), shallow);
  return state;
}

================
File: src/components/features/Exercise/hooks/useSession.ts
================
'use client';

import { useStore } from "@/lib/store/store";
import { shallow } from 'zustand/shallow';
export function useSession() {
  const state = useStore(state => ({
    sessionId: state.sessionId,
    roundNumber: state.roundNumber,
    targetCoreValues: state.targetCoreValues,
    setSession: state.setSession,
    setSessionId: state.setSessionId,
    setRoundNumber: state.setRoundNumber,
    setTargetCoreValues: state.setTargetCoreValues,
    clearSession: state.clearSession
  }), shallow);
  return state;
}

================
File: src/components/features/Exercise/types.ts
================
import { Value, CategoryName } from "@/lib/types";

export interface ResultsProps {
  sessionId?: string;
  values?: Value[];
}

export interface CoreValueReasoningProps {
  values: Value[];
  onComplete: (valuesWithReasons: ValueWithReason[]) => void;
}

export interface ValueWithReason extends Value {
  reason?: string;
}

================
File: src/components/features/Exercise/utils/index.ts
================
import { generateSessionName, getSessions } from './sessionUtils';

export {
    generateSessionName,
    getSessions
};

================
File: src/components/features/Exercise/utils/sessionLoader.ts
================
import { getSession, getRoundsBySession } from "@/lib/db/indexedDB";
import { initializeGameState } from "@/lib/utils/storage";
import { Round, Value, Categories, DropCommandPayload, MoveCommandPayload } from "@/lib/types";
import valuesData from '@/data/values.json';

export async function loadSessionState(sessionId: string) {
  const session = await getSession(sessionId);
  if (!session) {
    throw new Error('Session not found');
  }

  const rounds = await getRoundsBySession(sessionId);
  const currentRound = session.currentRound;

  console.log('Loading session state:', {
    sessionId,
    currentRound,
    roundsCount: rounds.length
  });

  // Get the current round's data
  const currentRoundData = rounds.find(r => r.roundNumber === currentRound);
  if (!currentRoundData) {
    throw new Error(`Round ${currentRound} not found`);
  }

  // Create a map of all possible values
  const allValues = new Map<string, Value>(session.initialValues.map(value => [value.id, value]));

  // First, process all previous rounds to determine which cards are removed
  const removedCardIds = new Set<string>();
  for (const round of rounds.filter(r => r.roundNumber < currentRound)) {
    console.log(`Processing round ${round.roundNumber} to track removed cards`);

    // Track cards in categories for this round
    const roundCategories: Categories = { ...round.availableCategories };

    // Process all commands for this round
    for (const command of round.commands) {
      if (command.type === 'DROP') {
        const dropPayload = command.payload as DropCommandPayload;
        const value = allValues.get(dropPayload.cardId);
        if (value && dropPayload.category in roundCategories) {
          roundCategories[dropPayload.category] = [
            ...(roundCategories[dropPayload.category] ?? []),
            value
          ];
        }
      } else if (command.type === 'MOVE') {
        const movePayload = command.payload as MoveCommandPayload;
        const value = allValues.get(movePayload.cardId);
        if (value && movePayload.fromCategory in roundCategories && movePayload.toCategory in roundCategories) {
          // Remove from source
          roundCategories[movePayload.fromCategory] = (roundCategories[movePayload.fromCategory] ?? [])
            .filter(v => v.id !== movePayload.cardId);

          // Add to target
          roundCategories[movePayload.toCategory] = [
            ...(roundCategories[movePayload.toCategory] ?? []),
            value
          ];
        }
      }
    }

    // At end of round, add all cards in Not Important to removedCardIds
    const notImportantCards = roundCategories['Not Important'] ?? [];
    notImportantCards.forEach(card => removedCardIds.add(card.id));
  }

  // Calculate remaining cards at start of current round
  const remainingCards = session.initialValues.filter(value => !removedCardIds.has(value.id));
  console.log(`Remaining cards at start of round ${currentRound}:`, remainingCards.length);
  // Initialize categories with current round's structure
  let categories: Categories = { ...currentRoundData.availableCategories };

  // Now process commands from current round to place cards in categories
  console.log(`Processing current round ${currentRound} commands`);
  for (const command of currentRoundData.commands) {
    if (command.type === 'DROP') {
      const dropPayload = command.payload as DropCommandPayload;
      const value = allValues.get(dropPayload.cardId);
      if (value && dropPayload.category in categories) {
        categories[dropPayload.category] = [...(categories[dropPayload.category] ?? []), value];
      }
    } else if (command.type === 'MOVE') {
      const movePayload = command.payload as MoveCommandPayload;
      const value = allValues.get(movePayload.cardId);
      if (value && movePayload.fromCategory in categories && movePayload.toCategory in categories) {
        // Remove from source
        const sourceCategory = categories[movePayload.fromCategory] ?? [];
        categories[movePayload.fromCategory] = sourceCategory.filter(v => v.id !== movePayload.cardId);

        // Add to target
        const targetCategory = categories[movePayload.toCategory] ?? [];
        categories[movePayload.toCategory] = [...targetCategory, value];
      }
    }
  }

  // Calculate final remaining cards for current round state
  const currentUsedCardIds = new Set(Object.values(categories)
    .flatMap(cards => cards?.map(card => card.id) ?? []));
  const finalRemainingCards = remainingCards
    .filter(value => !currentUsedCardIds.has(value.id));

  console.log('Initializing game state with:', {
    sessionId,
    currentRound,
    targetCoreValues: session.targetCoreValues,
    initialRemainingCards: remainingCards.length,
    finalRemainingCards: finalRemainingCards.length,
    categoriesState: Object.entries(categories).map(([cat, vals]) => ({
      category: cat,
      count: (vals || []).length
    }))
  });

  // Initialize game state with reconstructed data
  initializeGameState(
    sessionId,
    currentRound,
    session.targetCoreValues,
    finalRemainingCards,
    categories
  );

  return {
    session,
    currentRound
  };
}

================
File: src/components/features/Exercise/utils/sessionUtils.ts
================
import { Session } from "@/lib/types";
import { IDBPDatabase } from 'idb';
export const adjectives: string[] = ['happy', 'bright', 'swift', 'clever', 'gentle', 'brave', 'calm', 'dark', 'eager', 'fair', 'wise', 'kind', 'loud', 'merry', 'nice', 'proud', 'quick', 'rare', 'soft', 'tall', 'warm', 'young', 'wild', 'bold', 'cool', 'deep', 'pure', 'rich', 'safe', 'sharp', 'strong', 'sweet', 'tough', 'vast', 'vivid', 'light', 'quiet', 'smart', 'fresh', 'grand', 'clean', 'clear', 'great', 'free', 'broad', 'keen', 'real', 'true', 'full', 'fine'];
export const nouns: string[] = ['river', 'mountain', 'forest', 'star', 'ocean', 'cloud', 'desert', 'garden', 'island', 'lake', 'moon', 'rain', 'snow', 'storm', 'sun', 'tree', 'valley', 'wind', 'world', 'bridge', 'castle', 'city', 'door', 'field', 'fire', 'flower', 'harbor', 'home', 'light', 'path', 'road', 'rock', 'shore', 'sky', 'space', 'spring', 'stone', 'stream', 'summer', 'tide', 'tower', 'trail', 'wave', 'wood', 'dawn', 'dusk', 'echo', 'frost', 'mist', 'shadow'];
export const verbs: string[] = ['running', 'dancing', 'singing', 'jumping', 'flying', 'dreaming', 'glowing', 'hoping', 'laughing', 'playing', 'reading', 'sailing', 'thinking', 'walking', 'writing', 'seeking', 'growing', 'flowing', 'shining', 'smiling', 'breathing', 'climbing', 'creating', 'drifting', 'exploring', 'floating', 'listening', 'moving', 'painting', 'rising', 'speaking', 'swimming', 'teaching', 'watching', 'wondering', 'building', 'caring', 'drinking', 'eating', 'feeling', 'helping', 'knowing', 'learning', 'making', 'resting', 'seeing', 'sleeping', 'standing', 'trying', 'working'];
const getRandomElement = <T,>(array: T[]): T => {
  return array[Math.floor(Math.random() * array.length)];
};
export async function generateSessionName(db: IDBPDatabase): Promise<string> {
  let isUnique = false;
  let sessionName = '';
  let attempts = 0;
  const maxAttempts = 50; // Prevent infinite loop

  while (!isUnique && attempts < maxAttempts) {
    const adj = getRandomElement(adjectives);
    const noun = getRandomElement(nouns);
    const verb = getRandomElement(verbs);
    sessionName = `${adj}-${noun}-${verb}`;

    // Check if session exists in IndexedDB
    const existingSession = await db.get('sessions', sessionName);
    if (!existingSession) {
      isUnique = true;
    }
    attempts++;
  }
  if (!isUnique) {
    // If we couldn't generate a unique name after maxAttempts,
    // append a timestamp to ensure uniqueness
    sessionName = `${sessionName}-${Date.now()}`;
  }
  return sessionName;
}
export const getSessions = async (db: IDBPDatabase): Promise<Session[]> => {
  try {
    const sessions = await db.getAll('sessions');
    return sessions;
  } catch (error) {
    console.error('Error retrieving sessions:', error);
    return [];
  }
};

================
File: src/components/features/History/components/DeleteConfirmationModal/index.tsx
================
import { Modal } from '@/components/common/Modal';
import { Session } from '@/lib/types';
import { motion, AnimatePresence } from 'framer-motion';
import { DeleteConfirmationModalProps } from '@/components/features/History/types';

export function DeleteConfirmationModal({
  isOpen,
  onClose,
  onConfirm,
  selectedSessions,
  isDeleting,
  deletingCount
}: DeleteConfirmationModalProps) {
  const sessionCount = isDeleting && typeof deletingCount === 'number' 
    ? deletingCount 
    : selectedSessions.length;

  return (
    <Modal
      isOpen={isOpen}
      onClose={onClose}
      title={`Delete ${sessionCount === 1 ? 'Session' : `${sessionCount} Sessions`}`}
    >
      <div className="space-y-4">
        {!isDeleting ? (
          <p className="text-sm text-gray-500">
            {sessionCount === 1
              ? 'Are you sure you want to delete this session? This action cannot be undone.'
              : `Are you sure you want to delete these ${sessionCount} sessions? This action cannot be undone.`}
          </p>
        ) : (
          <motion.p
            key="deleting-text"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="text-sm text-gray-500 text-center"
          >
            {deletingCount > 0 
              ? `Deleting ${deletingCount} session${deletingCount !== 1 ? 's' : ''}...`
              : 'Finishing up...'}
          </motion.p>
        )}
        
        {!isDeleting && sessionCount > 0 && (
          <div className="mt-4 bg-gray-100 rounded-md p-4 max-h-48 overflow-y-auto">
            <ul className="space-y-2">
              {selectedSessions.map(session => (
                <li key={session.id} className="text-sm text-gray-700">
                  <span className="font-medium">
                    {new Date(session.timestamp).toLocaleDateString()}
                  </span>
                  {session.completed ? ' (Completed)' : ' (In Progress)'} - 
                  Round {session.currentRound}
                </li>
              ))}
            </ul>
          </div>
        )}

        <div className="mt-5 sm:mt-4 sm:flex sm:flex-row-reverse">
          <button
            type="button"
            className="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-100"
            onClick={onConfirm}
            disabled={isDeleting}
          >
            <motion.span
              key="button-text"
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
            >
              {isDeleting ? 'Deleting...' : `Delete ${sessionCount > 1 ? `(${sessionCount})` : ''}`}
            </motion.span>
          </button>
          <button
            type="button"
            className="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:w-auto sm:text-sm disabled:opacity-100"
            onClick={onClose}
            disabled={isDeleting}
          >
            Cancel
          </button>
        </div>
      </div>
    </Modal>
  );
}

================
File: src/components/features/History/components/SessionList/DesktopSessionList.tsx
================
import { useState } from 'react';
import Link from 'next/link';
import { motion, AnimatePresence } from 'framer-motion';
import { getPostItStyles } from "@/components/features/Cards/components/styles";
import { getCompletedSession, deleteSession } from "@/lib/db/indexedDB";
import { SessionListProps } from '../../types';
import { Value, ValueWithReason } from "@/lib/types";
import { useSessionSelection } from '../../contexts/SessionSelectionContext';
import { DeleteConfirmationModal } from '../DeleteConfirmationModal';

export function DesktopSessionList({ sessions, onSessionDeleted }: SessionListProps) {
    const [showValuesFor, setShowValuesFor] = useState<string | null>(null);
    const [currentValues, setCurrentValues] = useState<Value[]>([]);
    const [isLoading, setIsLoading] = useState(false);
    const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);
    const [isDeleting, setIsDeleting] = useState(false);
    const [deletingCount, setDeletingCount] = useState(0);
    const { postItBaseStyles, tapeEffect } = getPostItStyles(false, false);
    const {
        selectedSessions,
        toggleSession,
        selectAll,
        clearSelection,
        isSelected
    } = useSessionSelection();

    const formatDate = (timestamp: number) => {
        return new Date(timestamp).toLocaleString();
    };

    const handleShowValues = async (sessionId: string) => {
        setIsLoading(true);
        try {
            const completedSession = await getCompletedSession(sessionId);
            if (completedSession?.finalValues) {
                setCurrentValues(completedSession.finalValues);
                setShowValuesFor(sessionId);
            }
        } catch (error) {
            console.error('Error loading values:', error);
        } finally {
            setIsLoading(false);
        }
    };


    const handleDeleteSelected = async () => {
        setIsDeleting(true);
        const selectedCount = selectedSessions.size;
        setDeletingCount(selectedCount);

        try {
            const selectedIds = Array.from(selectedSessions);
            for (let i = 0; i < selectedIds.length; i++) {
                const sessionId = selectedIds[i];
                await deleteSession(sessionId);
                onSessionDeleted?.(sessionId);
                setDeletingCount(selectedCount - (i + 1));
                // Add a small delay to make the count animation visible
                await new Promise(resolve => setTimeout(resolve, 100));
            }

            // After all deletions, wait a moment before cleaning up
            await new Promise(resolve => setTimeout(resolve, 300));
            clearSelection();
        } catch (error) {
            console.error('Error deleting sessions:', error);
        } finally {
            setIsDeleting(false);
            setIsDeleteModalOpen(false);
            setDeletingCount(0);
        }
    };

    const handleSelectAll = () => {
        const sessionIds = sessions.map(session => session.id);
        if (selectedSessions.size === sessions.length) {
            clearSelection();
        } else {
            selectAll(sessionIds);
        }
    };

    const selectedSessionObjects = sessions.filter(session =>
        isSelected(session.id)
    );

    const renderCompletedValues = (values: ValueWithReason[]) => {
        if (isLoading) {
            return (
                <div className="flex items-center justify-center p-4" role="status">
                    <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500" />
                </div>
            );
        }

        return (
            <section className="space-y-4" aria-labelledby="desktop-values-title">
                <div className="flex justify-between items-center">
                    <h3 id="desktop-values-title" className="text-lg font-bold">Selected Core Values</h3>
                    <span className="text-sm text-gray-500">
                        {values.length} value{values.length !== 1 ? 's' : ''}
                    </span>
                </div>
                <div className="grid grid-cols-3 gap-4" role="list">
                    {values.map(value => (
                        <motion.article
                            key={value.id}
                            className={`${postItBaseStyles} ${tapeEffect} p-4`}
                            initial={{ opacity: 0, y: 20 }}
                            animate={{ opacity: 1, y: 0 }}
                            exit={{ opacity: 0, y: -20 }}
                        >
                            <h4 className="font-medium">{value.title}</h4>
                            <p className="text-sm text-gray-700 mb-2">{value.description}</p>
                            {value.reason && (
                                <div className="mt-2 pt-2 border-t border-gray-200">
                                    <p className="text-sm font-medium text-gray-700">Why it is meaningful:</p>
                                    <p className="text-sm text-gray-700 italic">{value.reason}</p>
                                </div>
                            )}
                        </motion.article>
                    ))}
                </div>
            </section>
        );
    };

    return (
        <div className="space-y-4">
            <div className="flex justify-between items-center mb-4">
                <div className="flex items-center space-x-4">
                    <input
                        type="checkbox"
                        checked={selectedSessions.size === sessions.length && sessions.length > 0}
                        onChange={handleSelectAll}
                        className="rounded border-gray-300 text-blue-700 focus:ring-blue-600"
                    />
                    <span className="text-sm text-gray-700">
                        {selectedSessions.size} selected
                    </span>
                </div>
                {selectedSessions.size > 0 && (
                    <button
                        onClick={() => setIsDeleteModalOpen(true)}
                        className="px-3 py-1.5 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors duration-200"
                    >
                        Delete Selected
                    </button>
                )}
            </div>

            <table className="min-w-full bg-white shadow-md rounded-lg">
                <thead>
                    <tr className="bg-gray-100 border-b">
                        <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                            <span className="sr-only">Select</span>
                        </th>
                        <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                            Session ID
                        </th>
                        <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                            Last Updated
                        </th>
                        <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                            Target Values
                        </th>
                        <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                            Current Round
                        </th>
                        <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                            Status
                        </th>
                        <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                            Actions
                        </th>
                    </tr>
                </thead>
                <tbody className="divide-y divide-gray-200">
                    {sessions.map(session => (
                        <tr key={session.id} className="hover:bg-gray-100">
                            <td className="px-6 py-4 whitespace-nowrap">
                                <input
                                    type="checkbox"
                                    checked={isSelected(session.id)}
                                    onChange={() => toggleSession(session.id)}
                                    className="rounded border-gray-300 text-blue-700 focus:ring-blue-600"
                                />
                            </td>
                            <td className="px-6 py-4 whitespace-nowrap text-xs text-gray-500 font-mono">
                                {session.id}
                            </td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                <time dateTime={new Date(session.timestamp).toISOString()}>
                                    {formatDate(session.timestamp)}
                                </time>
                            </td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                {session.targetCoreValues}
                            </td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                {session.currentRound}
                            </td>
                            <td className="px-6 py-4 whitespace-nowrap">
                                <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                  ${session.completed ? 'bg-green-100 text-green-700' : 'bg-blue-100 text-blue-700'}`}>
                                    {session.completed ? 'Completed' : 'In Progress'}
                                </span>
                            </td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                                {session.completed ? (
                                    <>
                                        <button
                                            onClick={() => handleShowValues(session.id)}
                                            className="px-3 py-1.5 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-200"
                                        >
                                            Show Values
                                        </button>
                                        {process.env.NODE_ENV === 'development' && (
                                            <Link
                                                href={`/replay?sessionId=${session.id}`}
                                                className="px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors duration-200"
                                            >
                                                Replay
                                            </Link>
                                        )}
                                    </>
                                ) : (
                                    <Link
                                        href={`/exercise?sessionId=${session.id}`}
                                        className="px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors duration-200"
                                    >
                                        Resume Game
                                    </Link>
                                )}
                                <button
                                    onClick={() => {
                                        selectAll([session.id]);
                                        setIsDeleteModalOpen(true);
                                    }}
                                    className="px-3 py-1.5 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors duration-200"
                                    aria-label={`Delete session from ${formatDate(session.timestamp)}`}
                                >
                                    Delete
                                </button>
                            </td>
                        </tr>
                    ))}
                </tbody>
            </table>

            <AnimatePresence>
                {showValuesFor && (
                    <div className="bg-white shadow-md rounded-lg p-6">
                        {renderCompletedValues(currentValues)}
                    </div>
                )}
            </AnimatePresence>

            <DeleteConfirmationModal
                isOpen={isDeleteModalOpen}
                onClose={() => {
                    setIsDeleteModalOpen(false);
                    setDeletingCount(selectedSessions.size);
                }}
                onConfirm={handleDeleteSelected}
                selectedSessions={selectedSessionObjects}
                isDeleting={isDeleting}
                deletingCount={selectedSessions.size}
            />
        </div>
    );

}

================
File: src/components/features/History/components/SessionList/index.tsx
================
import { useMobile } from "@/lib/contexts/MobileContext";
import { SessionListProps } from '../../types';
import { MobileSessionList } from './MobileSessionList';
import { DesktopSessionList } from './DesktopSessionList';
import { useHistoryInit } from '../../hooks/useHistoryInit';

export function SessionList({ sessions, onSessionDeleted = () => {} }: SessionListProps) {
  const { isMobile } = useMobile();
  const { isInitialized, error } = useHistoryInit();

  if (error) {
    return (
      <div className="text-red-600 p-4 text-center">
        Error loading session history. Please try again later.
      </div>
    );
  }

  if (!isInitialized) {
    return (
      <div className="flex items-center justify-center p-4">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500" />
      </div>
    );
  }
  
  return isMobile ? 
    <MobileSessionList sessions={sessions} onSessionDeleted={onSessionDeleted} /> : 
    <DesktopSessionList sessions={sessions} onSessionDeleted={onSessionDeleted} />;
}

================
File: src/components/features/History/components/SessionList/MobileSessionList.tsx
================
import { useState } from 'react';
import Link from 'next/link';
import { motion, AnimatePresence } from 'framer-motion';
import { getCompletedSession, deleteSession } from "@/lib/db/indexedDB";
import { SessionListProps } from '../../types';
import { Value, ValueWithReason } from "@/lib/types";
import { useSessionSelection } from '../../contexts/SessionSelectionContext';
import { DeleteConfirmationModal } from '../DeleteConfirmationModal';
import { Modal } from '@/components/common/Modal';

export function MobileSessionList({ sessions, onSessionDeleted }: SessionListProps) {
    const [showValuesFor, setShowValuesFor] = useState<string | null>(null);
    const [currentValues, setCurrentValues] = useState<Value[]>([]);
    const [isLoading, setIsLoading] = useState(false);
    const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);
    const [isDeleting, setIsDeleting] = useState(false);
    const [isSelectionMode, setIsSelectionMode] = useState(false);
    const [deletingCount, setDeletingCount] = useState<number>(0);


    const {
        selectedSessions,
        toggleSession,
        selectAll,
        clearSelection,
        isSelected
    } = useSessionSelection();

    const formatDate = (timestamp: number) => {
        return new Date(timestamp).toLocaleString();
    };

    const handleShowValues = async (sessionId: string) => {
        setIsLoading(true);
        try {
            const completedSession = await getCompletedSession(sessionId);
            if (completedSession?.finalValues) {
                setCurrentValues(completedSession.finalValues);
                setShowValuesFor(sessionId);
            }
        } catch (error) {
            console.error('Error loading values:', error);
        } finally {
            setIsLoading(false);
        }
    };

    const handleDeleteSelected = async () => {
        setIsDeleting(true);
        const selectedCount = selectedSessions.size;
        setDeletingCount(selectedCount);

        try {
            const selectedIds = Array.from(selectedSessions);
            for (let i = 0; i < selectedIds.length; i++) {
                const sessionId = selectedIds[i];
                await deleteSession(sessionId);
                onSessionDeleted?.(sessionId);
                setDeletingCount(selectedCount - (i + 1));
                // Add a small delay to make the count animation visible
                await new Promise(resolve => setTimeout(resolve, 100));
            }

            // After all deletions, wait a moment before cleaning up
            await new Promise(resolve => setTimeout(resolve, 300));
            clearSelection();
            setIsSelectionMode(false);
        } catch (error) {
            console.error('Error deleting sessions:', error);
        } finally {
            setIsDeleting(false);
            setIsDeleteModalOpen(false);
            setDeletingCount(0);
        }
    };


    const handleSelectAll = () => {
        const sessionIds = sessions.map(session => session.id);
        if (selectedSessions.size === sessions.length) {
            clearSelection();
        } else {
            selectAll(sessionIds);
        }
    };

    const selectedSessionObjects = sessions.filter(session =>
        isSelected(session.id)
    );

    const toggleSelectionMode = () => {
        if (isSelectionMode) {
            clearSelection();
        }
        setIsSelectionMode(!isSelectionMode);
    };

    const renderCompletedValues = (values: ValueWithReason[]) => {
        if (isLoading) {
            return (
                <div className="flex items-center justify-center p-4" role="status">
                    <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500" />
                </div>
            );
        }
    
        return (
            <Modal
                isOpen={!!showValuesFor}
                onClose={() => setShowValuesFor(null)}
                title="Core Values"
            >
                <div className="space-y-4">
                    <div className="flex justify-end">
                        <span className="text-sm text-gray-500">
                            {values.length} value{values.length !== 1 ? 's' : ''}
                        </span>
                    </div>
                    <div className="space-y-4">
                        {values.map(value => (
                            <div key={value.id} className="p-4 bg-yellow-100 rounded shadow">
                                <h4 className="font-medium">{value.title}</h4>
                                <p className="text-sm text-gray-700 mb-2">{value.description}</p>
                                {value.reason && (
                                    <div className="mt-2 pt-2 border-t border-gray-200">
                                        <p className="text-sm font-medium text-gray-700">Why it is meaningful:</p>
                                        <p className="text-sm text-gray-700 italic">{value.reason}</p>
                                    </div>
                                )}
                            </div>
                        ))}
                    </div>
                    <button
                        onClick={() => setShowValuesFor(null)}
                        className="w-full px-4 py-2 bg-blue-600 text-white rounded"
                    >
                        Close
                    </button>
                </div>
            </Modal>
        );
    };

    return (
        <>
            <div className="sticky top-0 z-10 bg-white shadow-sm mb-4">
                <div className="flex justify-between items-center p-4">
                    <button
                        onClick={toggleSelectionMode}
                        className={`px-3 py-1.5 rounded-md text-sm font-medium ${isSelectionMode ? 'bg-gray-200 text-gray-800' : 'bg-gray-100 text-gray-700'
                            }`}
                    >
                        {isSelectionMode ? 'Cancel' : 'Select'}
                    </button>
                    {isSelectionMode && (
                        <div className="flex items-center space-x-2">
                            <button
                                onClick={handleSelectAll}
                                className="px-3 py-1.5 bg-blue-100 text-blue-800 rounded-md text-sm font-medium"
                            >
                                {selectedSessions.size === sessions.length ? 'Deselect All' : 'Select All'}
                            </button>
                            {selectedSessions.size > 0 && (
                                <button
                                    onClick={() => setIsDeleteModalOpen(true)}
                                    className="px-3 py-1.5 bg-red-600 text-white rounded-md text-sm font-medium"
                                >
                                    Delete ({selectedSessions.size})
                                </button>
                            )}
                        </div>
                    )}
                </div>
            </div>

            <div className="space-y-4">
                {sessions.map(session => (
                    <article
                        key={session.id}
                        className={`bg-white rounded-lg shadow p-4 relative ${isSelectionMode ? 'pl-12' : ''
                            }`}
                    >
                        {isSelectionMode && (
                            <div className="absolute left-4 top-1/2 -translate-y-1/2">
                                <input
                                    type="checkbox"
                                    checked={isSelected(session.id)}
                                    onChange={() => toggleSession(session.id)}
                                    className="h-5 w-5 rounded border-gray-300 text-blue-700 focus:ring-blue-600"
                                />
                            </div>
                        )}
                        <div className="flex justify-between items-start mb-2">
                            <div>
                                <time dateTime={new Date(session.timestamp).toISOString()} className="text-sm text-gray-500">
                                    {formatDate(session.timestamp)}
                                </time>
                                <div className="text-sm mt-1">
                                    Target Values: {session.targetCoreValues}
                                </div>
                                <div className="text-sm">
                                    Round: {session.currentRound}
                                </div>
                            </div>
                            <div className={`text-sm ${session.completed ? 'text-green-700' : 'text-blue-700'}`}>
                                {session.completed ? 'Completed' : 'In Progress'}
                            </div>
                        </div>
                        {!isSelectionMode && (
                            <div className="mt-3 flex justify-end space-x-2">
                                {session.completed ? (
                                    <button
                                        onClick={() => handleShowValues(session.id)}
                                        className="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm"
                                    >
                                        Show Values
                                    </button>
                                ) : (
                                    <Link
                                        href={`/exercise?sessionId=${session.id}`}
                                        className="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm"
                                    >
                                        Resume Game
                                    </Link>
                                )}
                            </div>
                        )}
                    </article>
                ))}
            </div>

            <AnimatePresence>
                {showValuesFor && renderCompletedValues(currentValues)}
            </AnimatePresence>

            <DeleteConfirmationModal
                isOpen={isDeleteModalOpen}
                onClose={() => {
                  setIsDeleteModalOpen(false);
                  setDeletingCount(0);
                }}
                onConfirm={handleDeleteSelected}
                selectedSessions={selectedSessionObjects}
                isDeleting={isDeleting}
                deletingCount={deletingCount}
            />
        </>
    );
}

================
File: src/components/features/History/contexts/SessionSelectionContext.tsx
================
import { createContext, useContext, useState, useCallback } from 'react';

interface SessionSelectionContextType {
  selectedSessions: Set<string>;
  toggleSession: (sessionId: string) => void;
  selectAll: (sessionIds: string[]) => void;
  clearSelection: () => void;
  isSelected: (sessionId: string) => boolean;
}

const SessionSelectionContext = createContext<SessionSelectionContextType | undefined>(undefined);

export function SessionSelectionProvider({ children }: { children: React.ReactNode }) {
  const [selectedSessions, setSelectedSessions] = useState<Set<string>>(new Set());

  const toggleSession = useCallback((sessionId: string) => {
    setSelectedSessions(prev => {
      const next = new Set(prev);
      if (next.has(sessionId)) {
        next.delete(sessionId);
      } else {
        next.add(sessionId);
      }
      return next;
    });
  }, []);

  const selectAll = useCallback((sessionIds: string[]) => {
    setSelectedSessions(new Set(sessionIds));
  }, []);

  const clearSelection = useCallback(() => {
    setSelectedSessions(new Set());
  }, []);

  const isSelected = useCallback((sessionId: string) => {
    return selectedSessions.has(sessionId);
  }, [selectedSessions]);

  return (
    <SessionSelectionContext.Provider 
      value={{ 
        selectedSessions, 
        toggleSession, 
        selectAll, 
        clearSelection, 
        isSelected 
      }}
    >
      {children}
    </SessionSelectionContext.Provider>
  );
}

export function useSessionSelection() {
  const context = useContext(SessionSelectionContext);
  if (context === undefined) {
    throw new Error('useSessionSelection must be used within a SessionSelectionProvider');
  }
  return context;
}

================
File: src/components/features/History/hooks/useHistoryInit.ts
================
import { useState, useEffect } from 'react';
import { initDB } from "@/lib/db/indexedDB";

export function useHistoryInit() {
  const [isInitialized, setIsInitialized] = useState(false);
  const [error, setError] = useState<Error | null>(null);

  useEffect(() => {
    const initialize = async () => {
      try {
        await initDB();
        setIsInitialized(true);
      } catch (err) {
        setError(err instanceof Error ? err : new Error('Failed to initialize database'));
      }
    };

    initialize();
  }, []);

  return { isInitialized, error };
}

================
File: src/components/features/History/types.ts
================
import { Session, Value } from "@/lib/types";


export interface SessionListProps {
  sessions: Session[];
  onShowValues?: (sessionId: string) => Promise<Value[]>;
  onSessionDeleted?: (sessionId: string) => void;
}

export interface DeleteConfirmationModalProps {
  isOpen: boolean;
  onClose: () => void;
  onConfirm: () => void;
  selectedSessions: Session[];
  isDeleting: boolean;
  deletingCount: number;
}

================
File: src/components/features/Home/components/StartScreen/index.tsx
================
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';
import { StartScreenProps } from '@/components/features/Home/types';
import { getEnvNumber, getEnvBoolean } from "@/lib/utils/config";
import Link from 'next/link';
import { addSession, saveRound  } from "@/lib/db/indexedDB";
import { initializeGameState } from "@/lib/utils/storage";
import { initialCategories } from "@/components/features/Categories/constants/categories";
import valuesData from '@/data/values.json';
import { getRandomValues } from '@/components/features/Home/utils/valuesUtils';

export default function StartScreen() {
  const router = useRouter();
  const isDebug = getEnvBoolean('debug', false);
  const maxCards = getEnvNumber('maxCards', 35);
  const defaultCoreValues = getEnvNumber('numCoreValues', 5);
  const [coreValuesCount, setCoreValuesCount] = useState<number>(defaultCoreValues);
  const [isInitializing, setIsInitializing] = useState(false);

  const handleStart = async () => {
    setIsInitializing(true);
    try {
      const shuffledValues = getRandomValues(valuesData.values);
      const limitedValues = shuffledValues.slice(0, maxCards);

      const session = {
        timestamp: Date.now(),
        targetCoreValues: coreValuesCount,
        currentRound: 1,
        completed: false,
        initialValues: limitedValues // Store the initial values
      };
      
      const sessionId = await addSession(session,initialCategories);

      initializeGameState(sessionId, 1, coreValuesCount, limitedValues, initialCategories);
      
      router.push(`/exercise?sessionId=${sessionId}`);
    } catch (error) {
      console.error('Error initializing game:', error);
      // You might want to show an error message to the user here
    } finally {
      setIsInitializing(false);
    }
  };
  
  return <div role="main" aria-labelledby="welcome-heading">
    <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8">
      <h1 id="welcome-heading" className="text-3xl sm:text-4xl md:text-5xl font-extrabold text-center mb-4 sm:mb-6">
        <span className="text-gray-900">Discover Your </span>
        <span className="text-blue-700">Core Values</span>
      </h1>

      <div className="max-w-2xl mx-auto text-center space-y-3 sm:space-y-4 mb-6 sm:mb-8" aria-label="Introduction">
        <p
          className="text-base sm:text-lg text-gray-800 font-[system-ui]"
          style={{ contentVisibility: 'auto' }}
        >
          Welcome to the Core Values discovery exercise! Through this interactive experience,
          you will discover and prioritise your personal core values, helping you identify what matters most to you.
        </p>
      </div>

      {isDebug && <div className="mb-4 text-xs sm:text-sm text-gray-700 text-center" role="note" aria-label="Debug information">
        <div>Debug Mode: On</div>
        <div>Max Cards: {maxCards}</div>
        <div>Default Core Values: {defaultCoreValues}</div>
      </div>}

      <form onSubmit={e => {
        e.preventDefault();
        handleStart();
      }} className="flex flex-col sm:flex-row items-center justify-center gap-4 sm:gap-6" aria-label="Exercise configuration">
        <label htmlFor="core-values-count" className="text-base sm:text-lg font-medium text-center sm:text-left whitespace-normal sm:whitespace-nowrap">
          How many core values do you want to end up with?
        </label>
        <div className="flex gap-3 sm:gap-4 items-center">
          <input 
            id="core-values-count" 
            type="number" 
            min="1" 
            max="10" 
            value={coreValuesCount} 
            onChange={e => setCoreValuesCount(Number(e.target.value))} 
            className="border rounded p-2 w-16 sm:w-20 text-center shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
            aria-label="Number of core values" 
            required 
            disabled={isInitializing}
          />
          <button 
            type="submit" 
            className={`px-4 sm:px-8 py-2 sm:py-3 bg-blue-600 text-white font-medium rounded-md hover:bg-blue-700 transition-colors duration-200 shadow-sm text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${isInitializing ? 'opacity-50 cursor-not-allowed' : ''}`}
            aria-label="Begin the core values exercise"
            disabled={isInitializing}
          >
            {isInitializing ? 'Initializing...' : 'Start Exercise'}
          </button>
        </div>
      </form>

      <div className="mt-6 sm:mt-8 text-center" aria-label="Previous results navigation">
        <p className="text-gray-700 mb-2 text-sm sm:text-base">
          Have you completed this exercise before?
        </p>
        <Link href="/history" className="text-blue-700 hover:text-blue-800 underline font-medium text-sm sm:text-base inline-flex items-center focus:outline-none focus:ring-2 focus:ring-blue-7  00 focus:ring-offset-2 rounded px-2 py-1" aria-label="View your previous exercise results">
          <span>View Your Previous Results</span>
          <span aria-hidden="true" className="ml-1">→</span>
        </Link>
      </div>
    </div>
  </div>;
}

================
File: src/components/features/Home/types.ts
================
'use client';
export interface StartScreenProps {
  onStart: () => void;
}

================
File: src/components/features/Home/utils/index.ts
================
import { getRandomValues } from './valuesUtils';

export {
    getRandomValues
};

================
File: src/components/features/Home/utils/valuesUtils.ts
================
import { Value } from "@/lib/types";
export const getRandomValues = (values: Value[]): Value[] => {
  const shuffled = [...values].sort(() => Math.random() - 0.5);
  return shuffled;
};

================
File: src/components/features/Replay/components/MobileReplayCategories/index.tsx
================
// src/components/Replay/components/MobileReplayCategories.tsx
import { Categories, CategoryName, Value } from "@/lib/types";
import { allCategories } from "@/components/features/Categories/constants/categories"; // Use centralized categories

export function MobileReplayCategory({
  title,
  cards
}: {
  title: CategoryName;
  cards: Value[];
}) {
  const categoryId = `mobile-replay-category-${title.toLowerCase().replace(/\s+/g, '-')}`;
  return <div data-category={title} className="p-2 rounded-lg border bg-white border-gray-200" role="region" aria-labelledby={categoryId}>
            <div className="flex items-center justify-between">
                <h3 id={categoryId} className="font-medium text-xs sm:text-sm truncate">
                    {title}
                </h3>
                <span className="bg-gray-200 px-1.5 py-0.5 rounded-full text-xs" aria-label={`${cards.length} ${cards.length === 1 ? 'card' : 'cards'}`}>
                    {cards.length}
                </span>
            </div>
            {cards.length > 0 && <div className="mt-1 space-y-1" role="list" aria-label={`Values in ${title}`}>
                    {cards.map(card => <div key={card.id} className="text-xs text-gray-700 truncate" role="listitem" aria-label={card.title}>
                            {card.title}
                        </div>)}
                </div>}
        </div>;
}
export function MobileReplayCategories({
  categories
}: {
  categories: Categories;
}) {
  return <div className="w-full space-y-1" role="region" aria-label="Value categories replay view">
            <div className="w-full" role="group" aria-label="Primary category">
                <MobileReplayCategory title="Very Important" cards={categories['Very Important'] || []} />
            </div>
            
            <div className="grid grid-cols-2 gap-1" role="group" aria-label="Secondary categories">
                <MobileReplayCategory title="Quite Important" cards={categories['Quite Important'] || []} />
                <MobileReplayCategory title="Important" cards={categories['Important'] || []} />
            </div>
            
            <div className="grid grid-cols-2 gap-1" role="group" aria-label="Additional categories">
                <MobileReplayCategory title="Of Some Importance" cards={categories['Of Some Importance'] || []} />
                <MobileReplayCategory title="Not Important" cards={categories['Not Important'] || []} />
            </div>
        </div>;
}

================
File: src/components/features/Replay/components/ReplayClient/index.tsx
================
'use client';

import { useEffect, useState, useCallback, useMemo } from 'react';
import { useSearchParams } from 'next/navigation';
import { getRoundsBySession } from "@/lib/db/indexedDB";
import { Round, Value, CategoryName, DropCommandPayload, MoveCommandPayload, Command, Categories } from "@/lib/types";
import { getEnvBoolean } from "@/lib/utils/config";
import { AnimatedCard } from "@/components/features/Cards/components/AnimatedCard";
import { useReplayState } from '../../hooks/useReplayState';
import { useCardAnimation } from '../../hooks/useCardAnimation';
import { ReplayColumn } from '../ReplayColumn';
import { motion, useSpring } from 'framer-motion';
import { MobileReplayCategories } from '../MobileReplayCategories';
import { CommandInfo } from '@/components/features/Replay/types';

export default function ReplayClient() {
  const searchParams = useSearchParams();
  const sessionId = searchParams.get('sessionId');
  const debug = getEnvBoolean('debug', false);
  const [rounds, setRounds] = useState<Round[]>([]);
  const [currentRound, setCurrentRound] = useState<number>(1);
  const [currentCommandIndex, setCurrentCommandIndex] = useState<number>(0);
  const [isPlaying, setIsPlaying] = useState<boolean>(false);
  const [playbackSpeed, setPlaybackSpeed] = useState<number>(1);
  const [commandInfo, setCommandInfo] = useState<CommandInfo | null>(null);
  const [currentCard, setCurrentCard] = useState<Value | null>(null);
  const [isMobile, setIsMobile] = useState<boolean | null>(null);
  const [isRoundTransition, setIsRoundTransition] = useState(false);
  const [allCards, setAllCards] = useState<Value[]>([]);
  const {
    categories,
    animatingCard,
    executeCommand,
    resetCategories,
    setAnimatingCard,
    setAllCards: setReplayStateCards
  } = useReplayState();

  const {
    position,
    isAnimating,
    startAnimation
  } = useCardAnimation(animatingCard?.sourcePos || {
    x: 0,
    y: 0
  }, animatingCard?.targetPos || {
    x: 0,
    y: 0
  }, 1000 / playbackSpeed);

  // Mobile detection after mount
  useEffect(() => {
    setIsMobile(window.innerWidth < 768);
    const handleResize = () => setIsMobile(window.innerWidth < 768);
    window.addEventListener('resize', handleResize);
    return () => window.removeEventListener('resize', handleResize);
  }, []);

  const emptyCategories = useMemo(() => ({
    'Very Important': [],
    'Important': [],
    'Quite Important': [],
    'Of Some Importance': [],
    'Not Important': []
  }), []);
  const getCurrentRoundCategories = useCallback(() => {
    const currentRoundData = rounds.find(r => r.roundNumber === currentRound);
    return currentRoundData?.availableCategories || emptyCategories;
  }, [currentRound, rounds, emptyCategories]);
  useEffect(() => {
    if (!sessionId) return;
    const loadRounds = async () => {
      try {
        const roundData = await getRoundsBySession(sessionId);
        const sortedRounds = roundData.sort((a, b) => a.roundNumber - b.roundNumber);
        setRounds(sortedRounds);
        if (sortedRounds.length > 0) {
          // Get all unique cards from all rounds
          const cards = new Set<Value>();
          sortedRounds.forEach(round => {
            Object.values(round.availableCategories).forEach(categoryCards => {
              categoryCards?.forEach(card => {
                cards.add(card);
              });
            });
          });
          const cardsArray = Array.from(cards);
          setAllCards(cardsArray);
          setReplayStateCards(cardsArray);

          // Set the first card
          const firstCommand = sortedRounds[0].commands[0];
          if (firstCommand) {
            const cardId = (firstCommand.payload as DropCommandPayload | MoveCommandPayload).cardId;
            const firstCard = cardsArray.find(card => card.id === cardId);
            if (firstCard) {
              setCurrentCard(firstCard);
            }
          }
        }
        resetCategories();
      } catch (error) {
        console.error('Failed to load rounds:', error);
      }
    };
    loadRounds();
  }, [sessionId, resetCategories, setReplayStateCards]);
  const getCommandDescription = useCallback((command: Command): string => {
    const payload = command.payload as DropCommandPayload | MoveCommandPayload;
    const card = allCards.find(c => c.id === payload.cardId);
    const cardTitle = card ? card.title : payload.cardId;
    if (command.type === 'DROP') {
      const dropPayload = payload as DropCommandPayload;
      return `Drop '${cardTitle}' to '${dropPayload.category}'`;
    } else if (command.type === 'MOVE') {
      const movePayload = payload as MoveCommandPayload;
      if (movePayload.fromCategory === movePayload.toCategory) {
        return `Move '${cardTitle}' within '${movePayload.fromCategory}'`;
      }
      return `Move '${cardTitle}' from '${movePayload.fromCategory}' to '${movePayload.toCategory}'`;
    }
    return `Command ${currentCommandIndex + 1}`;
  }, [allCards, currentCommandIndex]);

  const playNextCommand = useCallback(async () => {
    if (isRoundTransition) return;
    const currentRoundData = rounds.find(r => r.roundNumber === currentRound);
    if (!currentRoundData) return;
    if (currentCommandIndex >= currentRoundData.commands.length) {
      if (currentRound < rounds.length) {
        // Transition to the next round
        setIsRoundTransition(true);
        setIsPlaying(false);
        await new Promise(resolve => setTimeout(resolve, 1500)); // Pause before transitioning
        setCurrentRound(currentRound + 1);
        setCurrentCommandIndex(0);
        resetCategories();
        setIsRoundTransition(false);
        setIsPlaying(true);
        const nextRound = rounds.find(r => r.roundNumber === currentRound + 1);
        if (nextRound && nextRound.commands.length > 0) {
          const firstCommand = nextRound.commands[0];
          const cardId = (firstCommand.payload as DropCommandPayload | MoveCommandPayload).cardId;
          const nextCard = allCards.find(card => card.id === cardId);
          if (nextCard) {
            setCurrentCard(nextCard);
          }
          setCommandInfo({
            roundNumber: currentRound + 1,
            description: getCommandDescription(firstCommand)
          });
        }
        return;
      } else {
        setIsPlaying(false);
        return; // End of all rounds
      }
    }
    const command = currentRoundData.commands[currentCommandIndex];
    const payload = command.payload as DropCommandPayload | MoveCommandPayload;
    const cardId = payload.cardId;
    const cardToAnimate = allCards.find(card => card.id === cardId);
    if (!cardToAnimate) return;

    // Set the next command info if available
    const nextCommand = currentRoundData.commands[currentCommandIndex + 1];
    if (nextCommand) {
      setCommandInfo({
        roundNumber: currentRound,
        description: getCommandDescription(nextCommand)
      });
      const nextCardId = (nextCommand.payload as DropCommandPayload | MoveCommandPayload).cardId;
      const nextCard = allCards.find(card => card.id === nextCardId);
      if (nextCard) {
        setCurrentCard(nextCard);
      }
    } else if (currentCommandIndex + 1 === currentRoundData.commands.length && currentRound < rounds.length) {
      // Prepare for the transition indicating next round
      setCommandInfo({
        roundNumber: currentRound + 1,
        description: "Next round starting soon..."
      });
    }
    let sourceElement: Element | null;
    if (command.type === 'DROP') {
      sourceElement = document.querySelector('[data-card-wrapper]');
    } else {
      const movePayload = payload as MoveCommandPayload;
      sourceElement = document.querySelector(`[data-category="${movePayload.fromCategory}"] [data-card-id="${cardId}"]`);
    }

    const targetCategory = command.type === 'DROP'
      ? (payload as DropCommandPayload).category
      : (payload as MoveCommandPayload).toCategory;

    const targetElement = document.querySelector(`[data-category="${targetCategory}"]`);

    if (sourceElement && targetElement) {
      const sourceRect = sourceElement.getBoundingClientRect();
      const targetRect = targetElement.getBoundingClientRect();

      // Calculate center points for source and target
      const sourceCenter = {
        x: sourceRect.left + (sourceRect.width / 2),
        y: sourceRect.top + (sourceRect.height / 2)
      };

      const targetCenter = {
        x: targetRect.left + (targetRect.width / 2),
        y: targetRect.top + 20  // 20px from top of category
      };

      // Start animation
      setAnimatingCard({
        value: cardToAnimate,
        sourcePos: sourceCenter,
        targetPos: targetCenter
      });

      // Wait for animation to complete before executing command
      await new Promise<void>(resolve => {
        const animationDuration = 500;  // Fixed duration for consistent speed
        setTimeout(() => {
          executeCommand(command);
          setAnimatingCard(null);
          resolve();
        }, animationDuration);
      });
    } else {
      executeCommand(command);
    }

    setCurrentCommandIndex(prev => prev + 1);
  }, [currentRound, currentCommandIndex, rounds, allCards, executeCommand, resetCategories, isRoundTransition, getCommandDescription, setAnimatingCard]);
  useEffect(() => {
    let timer: NodeJS.Timeout;
    if (isPlaying && rounds.length > 0 && !isAnimating && !isRoundTransition) {
      timer = setInterval(playNextCommand, 1000 / playbackSpeed);
    }
    return () => clearInterval(timer);
  }, [isPlaying, rounds, playbackSpeed, isAnimating, playNextCommand, isRoundTransition]);
  const handleReset = () => {
    setCurrentRound(1);
    setCurrentCommandIndex(0);
    setIsPlaying(false);
    resetCategories();
    setAnimatingCard(null);
    setCommandInfo(null);
    setCurrentCard(null);
    setIsRoundTransition(false);
  };

  // Don't render until we know if it's mobile or not
  if (isMobile === null) {
    return null;
  }
  return <div className="container mx-auto px-2 py-2 sm:px-4 sm:py-8" aria-label="Session replay viewer">
    <div className={`space-y-2 sm:space-y-4 ${isMobile ? 'h-screen flex flex-col' : ''}`}>
      <section className="bg-white rounded-lg shadow-lg p-2 sm:p-4" aria-label="Replay controls">
        <div className="flex flex-wrap items-center gap-2 sm:gap-4">
          <div className="flex gap-2">
            <button onClick={() => setIsPlaying(!isPlaying)} className="px-3 py-1.5 sm:px-4 sm:py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm sm:text-base" aria-label={isPlaying ? 'Pause replay' : 'Start replay'}>
              {isPlaying ? 'Pause' : 'Play'}
            </button>
            <button onClick={handleReset} className="px-3 py-1.5 sm:px-4 sm:py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors text-sm sm:text-base" aria-label="Reset replay to beginning">
              Reset
            </button>
          </div>

          <div className="flex items-center">
            <label htmlFor="playback-speed" className="sr-only">
              Playback speed
            </label>
            <select id="playback-speed" value={playbackSpeed} onChange={e => setPlaybackSpeed(Number(e.target.value))} className="px-3 py-1.5 sm:px-4 sm:py-2 border rounded bg-white text-sm sm:text-base" aria-label="Select playback speed">
              <option value={0.5}>0.5x Speed</option>
              <option value={1}>1x Speed</option>
              <option value={2}>2x Speed</option>
              <option value={4}>4x Speed</option>
            </select>
          </div>

          <div className="flex items-center text-sm sm:text-base" aria-live="polite" role="status">
            {!isPlaying && !commandInfo ? <span className="text-gray-700">
              Click Play to start the replay
            </span> : commandInfo && <span>
              <span className="font-semibold">Round {commandInfo.roundNumber}:</span>
              {' '}{commandInfo.description}
            </span>}
          </div>
        </div>
      </section>

      <section className="relative h-32 sm:h-48" aria-label="Current card display">
        <div className="absolute left-1/2 transform -translate-x-1/2 current-card-display" data-card-wrapper aria-live="polite">
          {currentCard && !animatingCard && isPlaying && <AnimatedCard value={currentCard} columnIndex={undefined} onDrop={() => Promise.resolve()} currentCategory={undefined} />}
        </div>
      </section>

      <section aria-label="Card categories">
        {isMobile ? <div className="flex-1 min-h-0">
          <MobileReplayCategories categories={getCurrentRoundCategories()} aria-label="Mobile categories view" />
        </div> : <div className="grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4" role="grid" aria-label="Category grid">
          {Object.entries(getCurrentRoundCategories()).map(([title]) => <ReplayColumn key={title} title={title as CategoryName} cards={categories[title as CategoryName] || []} />)}
        </div>}
      </section>

      {animatingCard && (
        <motion.div
          initial={false}
          style={{
            position: 'fixed',
            left: animatingCard.sourcePos.x,
            top: animatingCard.sourcePos.y,
            zIndex: 1000,
            pointerEvents: 'none',
            transform: 'translate(-50%, -50%)',  // Center the card on its position
          }}
          animate={{
            left: animatingCard.targetPos.x,
            top: animatingCard.targetPos.y,
          }}
          transition={{
            type: "tween",  // Use tween instead of spring for straight-line movement
            duration: 0.5,
            ease: "easeInOut"
          }}
          aria-hidden="true"
        >
          <AnimatedCard
            value={animatingCard.value}
            columnIndex={undefined}
            onDrop={() => Promise.resolve()}
            currentCategory={undefined}
          />
        </motion.div>
      )}
    </div>
  </div>;
}

================
File: src/components/features/Replay/components/ReplayColumn/index.tsx
================
// src/components/Replay/components/ReplayColumn.tsx
import { Value, CategoryName } from "@/lib/types";
import {ReplayColumnProps} from '@/components/features/Replay/types';

export function ReplayColumn({
  title,
  cards
}: ReplayColumnProps) {
  const columnId = `replay-column-${title.toLowerCase().replace(/\s+/g, '-')}`;
  return <div data-category={title} className="bg-white rounded-lg shadow p-4" role="region" aria-labelledby={columnId}>
        <h3 id={columnId} className="text-lg font-semibold mb-4">
          {title}
          <span className="ml-2 text-sm text-gray-500" aria-label={`${cards.length} ${cards.length === 1 ? 'card' : 'cards'}`}>
            ({cards.length})
          </span>
        </h3>

        <div className="space-y-2" role="list" aria-label={`Values in ${title} category`}>
          {cards.map(card => <article key={card.id} data-card-id={card.id} className="bg-yellow-100 rounded-lg p-3 shadow" role="listitem">
              <div className="space-y-1" role="group" aria-labelledby={`card-title-${card.id}`}>
                <h4 id={`card-title-${card.id}`} className="font-medium">
                  {card.title}
                </h4>
                <p className="text-sm text-gray-700" aria-label={`Description: ${card.description}`}>
                  {card.description}
                </p>
              </div>
            </article>)}
        </div>

        {cards.length === 0 && <div className="text-gray-500 text-sm text-center py-4" role="status" aria-label={`No cards in ${title} category`}>
            No cards in this category
          </div>}
      </div>;
}

================
File: src/components/features/Replay/hooks/useCardAnimation.ts
================
import { useState, useEffect } from 'react';
import { Position } from "@/lib/types";

export const useCardAnimation = (
  sourcePosition: { x: number; y: number },
  targetPosition: { x: number; y: number },
  duration: number = 500
) => {
  const [position, setPosition] = useState(sourcePosition);
  const [isAnimating, setIsAnimating] = useState(false);

  useEffect(() => {
    if (isAnimating) {
      const startTime = Date.now();
      const animate = () => {
        const currentTime = Date.now();
        const elapsed = currentTime - startTime;
        const progress = Math.min(elapsed / duration, 1);

        // Easing function for smooth animation
        const eased = easeOutQuart(progress);
        
        // Calculate direct path
        const x = sourcePosition.x + (targetPosition.x - sourcePosition.x) * eased;
        const y = sourcePosition.y + (targetPosition.y - sourcePosition.y) * eased;

        setPosition({ x, y });

        if (progress < 1) {
          requestAnimationFrame(animate);
        } else {
          setIsAnimating(false);
        }
      };
      requestAnimationFrame(animate);
    }
  }, [isAnimating, sourcePosition, targetPosition, duration]);

  const startAnimation = () => {
    setIsAnimating(true);
  };

  return {
    position,
    isAnimating,
    startAnimation
  };
};

// Using easeOutQuart for a more natural dragging feel
const easeOutQuart = (t: number): number => {
  return 1 - Math.pow(1 - t, 4);
};

================
File: src/components/features/Replay/hooks/useReplayState.ts
================
import { useState, useCallback } from 'react';
import { Value, Categories, CategoryName, Command, DropCommandPayload, MoveCommandPayload } from "@/lib/types";
import { initialCategories } from "@/components/features/Categories/constants/categories";
import { AnimatingCard } from '@/components/features/Replay/types';

export function useReplayState() {
  const [categories, setCategories] = useState<Categories>(initialCategories);
  const [animatingCard, setAnimatingCard] = useState<AnimatingCard | null>(null);
  const [allCards, setAllCards] = useState<Value[]>([]);

  const calculatePositions = (sourceElement: Element, targetElement: Element) => {
    const sourceRect = sourceElement.getBoundingClientRect();
    const targetRect = targetElement.getBoundingClientRect();

    // Calculate source position
    const sourcePos = {
      x: sourceRect.left,
      y: sourceRect.top
    };

    // Calculate target position at the top of the target category
    const targetPos = {
      x: targetRect.left + (targetRect.width / 2) - (sourceRect.width / 2),
      y: targetRect.top + 20 // 20px offset from top
    };

    return { sourcePos, targetPos };
  };

  const resetCategories = useCallback(() => {
    setCategories(initialCategories);
  }, []);

  const findCardById = useCallback((cardId: string): Value | undefined => {
    // Look in allCards first
    const card = allCards.find(c => c.id === cardId);
    if (card) return card;

    // If not found, look in categories
    for (const categoryCards of Object.values(categories)) {
      const found = categoryCards?.find(c => c.id === cardId);
      if (found) return found;
    }
    return undefined;
  }, [categories, allCards]);

  const executeCommand = useCallback((command: Command, availableCards?: Value[]) => {
    if (availableCards && allCards.length === 0) {
      setAllCards(availableCards);
    }

    const { cardId, category: targetCategory } = 
      command.type === 'DROP' 
        ? (command.payload as DropCommandPayload)
        : { cardId: (command.payload as MoveCommandPayload).cardId, category: (command.payload as MoveCommandPayload).toCategory };

    const card = findCardById(cardId);
    if (!card) {
      console.warn(`Card with id ${cardId} not found`);
      return;
    }

    // Get source and target elements for animation
    let sourceElement: Element | null;
    if (command.type === 'DROP') {
      sourceElement = document.querySelector('[data-card-wrapper]');
    } else {
      const { fromCategory } = command.payload as MoveCommandPayload;
      sourceElement = document.querySelector(`[data-category="${fromCategory}"] [data-card-id="${cardId}"]`);
    }

    const targetElement = document.querySelector(`[data-category="${targetCategory}"]`);

    if (sourceElement && targetElement) {
      const { sourcePos, targetPos } = calculatePositions(sourceElement, targetElement);
      setAnimatingCard({
        value: card,
        sourcePos,
        targetPos
      });
    }

    if (command.type === 'DROP') {
      setCategories(prev => ({
        ...prev,
        [targetCategory]: [...(prev[targetCategory] || []), card]
      }));
    } else {
      const { fromCategory, toCategory } = command.payload as MoveCommandPayload;
      setCategories(prev => ({
        ...prev,
        [fromCategory]: prev[fromCategory]?.filter(c => c.id !== cardId) || [],
        [toCategory]: [...(prev[toCategory] || []), card]
      }));
    }
  }, [findCardById, allCards]);

  return {
    categories,
    animatingCard,
    executeCommand,
    resetCategories,
    setAnimatingCard,
    setAllCards
  };
}

================
File: src/components/features/Replay/types.ts
================
import { Value, Categories, CategoryName } from "@/lib/types";

export interface ReplayColumnProps {
  title: CategoryName;
  cards: Value[];
}

export interface MobileReplayCategoriesProps {
  categories: Categories;
}

export interface AnimatingCard {
  value: Value;
  sourcePos: { x: number; y: number };
  targetPos: { x: number; y: number };
}

export interface CommandInfo {
  roundNumber: number;
  description: string;
}

================
File: src/components/features/Round/CategoryGrid.tsx
================
// src/components/Round/CategoryGrid.tsx
import CategoryColumn from "@/components/features/Categories/components/CategoryColumn";
import { CategoryGridProps } from '@/components/features/Round/types';
import { CategoryName, Value } from "@/lib/types";

export function CategoryGrid({
  categories,
  onDrop,
  onMoveWithinCategory,
  onMoveBetweenCategories
}: CategoryGridProps) {
  const categoryNames = Object.keys(categories) as CategoryName[];
  return <section className="w-full flex justify-center px-4">
      <div className="grid w-full max-w-[1600px]" style={{
      gridTemplateColumns: `repeat(${categoryNames.length}, minmax(300px, 1fr))`,
      gap: '1.5rem' // Reduced gap to allow more space
    }} aria-label="Value Categories Grid" >
        {(Object.entries(categories) as [CategoryName, Value[]][]).map(([title, cards], index) => <CategoryColumn key={title} title={title} cards={cards} onDrop={onDrop} onMoveWithinCategory={(fromIndex, toIndex) => onMoveWithinCategory(title, fromIndex, toIndex)} onMoveBetweenCategories={onMoveBetweenCategories} columnIndex={index} />)}
      </div>
    </section>;
}

================
File: src/components/features/Round/components/Mobile/MobileCardControls.tsx
================
import { 
  ChevronUpIcon, 
  ChevronDownIcon,
  ArrowUpIcon,
  ArrowDownIcon
} from '@heroicons/react/24/solid';

import { MobileCardControlsProps } from '@/components/features/Round/types';

export function MobileCardControls({ 
  canMoveUp, 
  canMoveDown, 
  onMoveUp, 
  onMoveDown,
  canMoveToPrevCategory,
  canMoveToNextCategory,
  onMoveToPrevCategory,
  onMoveToNextCategory
}: MobileCardControlsProps) {
  return (
    <div className="flex justify-end gap-2 mt-2 px-2">
      <div className="flex flex-col gap-1">
        {canMoveToPrevCategory && (
          <button
            onClick={onMoveToPrevCategory}
            className="p-2 rounded-full bg-blue-100 hover:bg-blue-200 text-blue-800"
            aria-label="Move to previous category"
          >
            <ArrowUpIcon className="w-5 h-5" />
          </button>
        )}
      </div>
      <div className="flex flex-col gap-1">
        {canMoveUp && (
          <button
            onClick={onMoveUp}
            className="p-2 rounded-full bg-gray-100 hover:bg-gray-200"
            aria-label="Move up within category"
          >
            <ChevronUpIcon className="w-5 h-5" />
          </button>
        )}
        {canMoveDown && (
          <button
            onClick={onMoveDown}
            className="p-2 rounded-full bg-gray-100 hover:bg-gray-200"
            aria-label="Move down within category"
          >
            <ChevronDownIcon className="w-5 h-5" />
          </button>
        )}
      </div>
      <div className="flex flex-col gap-1">
        {canMoveToNextCategory && (
          <button
            onClick={onMoveToNextCategory}
            className="p-2 rounded-full bg-blue-100 hover:bg-blue-200 text-blue-800"
            aria-label="Move to next category"
          >
            <ArrowDownIcon className="w-5 h-5" />
          </button>
        )}
      </div>
    </div>
  );
}

================
File: src/components/features/Round/components/Mobile/MobileCategoryRow.tsx
================
'use client';

import { motion, AnimatePresence } from 'framer-motion';
import { CategoryName, Value } from "@/lib/types";
import { ChevronDownIcon, ChevronUpIcon, ArrowUpIcon, ArrowDownIcon } from '@heroicons/react/24/solid';
import { useState } from 'react';
import { MobileCategoryRowProps } from '@/components/features/Round/types';

export function MobileCategoryRow({
  category,
  cards,
  availableCategories,
  isActive,
  isExpanded,
  onCategoryTap,
  onCategorySelect,
  showingCardSelection,
  onMoveWithinCategory,
  onMoveBetweenCategories,
  lastDroppedCategory
}: MobileCategoryRowProps) {
  const currentCategoryIndex = availableCategories.indexOf(category);
  const categoryId = `category-${category.toLowerCase().replace(/\s+/g, '-')}`;
  const [expandedCards, setExpandedCards] = useState<Set<string>>(new Set());
  const toggleCardExpansion = (cardId: string, event: React.MouseEvent) => {
    event.stopPropagation();
    const newExpanded = new Set(expandedCards);
    if (newExpanded.has(cardId)) {
      newExpanded.delete(cardId);
    } else {
      newExpanded.add(cardId);
    }
    setExpandedCards(newExpanded);
  };
  return <motion.div layout className={`
    rounded-lg 
    transition-all duration-300
    border-2 
    ${isActive || lastDroppedCategory === category ? 'bg-green-50' : 'bg-white'}
    ${showingCardSelection ? 'border-black shadow-md z-50 cursor-pointer' : 'border-transparent hover:border-gray-200 z-0'}
  `} role="region" aria-labelledby={categoryId}>
      <button onClick={() => showingCardSelection ? onCategorySelect(category) : onCategoryTap(category)} className="w-full p-4" aria-expanded={isExpanded} aria-controls={`${categoryId}-content`} aria-label={`${category} category with ${cards.length} cards${showingCardSelection ? '. Tap to select' : ''}`}>
        <div className="flex items-center justify-between">
          <h3 id={categoryId} className="font-medium">
            {category}
          </h3>
          <span className="bg-gray-200 px-2 py-1 rounded-full text-sm" aria-label={`${cards.length} cards`}>
            {cards.length}
          </span>
        </div>
      </button>

      <AnimatePresence>
        {isExpanded && !showingCardSelection && cards.length > 0 && <motion.div id={`${categoryId}-content`} initial={{
        height: 0,
        opacity: 0
      }} animate={{
        height: 'auto',
        opacity: 1
      }} exit={{
        height: 0,
        opacity: 0
      }} className="overflow-hidden" role="list" aria-label={`Cards in ${category}`}>
            <div className="space-y-2 px-2 pb-2">
              {cards.map((card, index) => <div key={card.id} className="bg-yellow-100 rounded-lg shadow-sm" role="listitem">
                  <div className="flex items-center justify-between p-2 gap-2 border-b border-yellow-200">
                    {/* Card Title and Expand Button */}
                    <button onClick={e => toggleCardExpansion(card.id, e)} className="flex items-center gap-2 flex-1 text-left" aria-expanded={expandedCards.has(card.id)} aria-label={`${card.title}. Click to ${expandedCards.has(card.id) ? 'collapse' : 'expand'}`}>
                      <ChevronDownIcon className={`w-4 h-4 text-yellow-700 transition-transform flex-shrink-0
                          ${expandedCards.has(card.id) ? 'rotate-180' : ''}
                        `} aria-hidden="true" />
                      <span className="text-sm font-medium text-yellow-900 truncate">
                        {card.title}
                      </span>
                    </button>

                    {/* Controls */}
                    <div className="flex items-center gap-3 flex-shrink-0">
                      {/* Category Movement Controls */}
                      <div className="flex items-center gap-1 border-r border-yellow-200 pr-3">
                        {currentCategoryIndex > 0 && <button onClick={() => onMoveBetweenCategories?.(card, category, availableCategories[currentCategoryIndex - 1])} className="p-1.5 rounded-full bg-blue-100 hover:bg-blue-200 text-blue-800" aria-label={`Move to ${availableCategories[currentCategoryIndex - 1]}`}>
                            <ArrowUpIcon className="w-4 h-4" />
                          </button>}
                        {currentCategoryIndex < availableCategories.length - 1 && <button onClick={() => onMoveBetweenCategories?.(card, category, availableCategories[currentCategoryIndex + 1])} className="p-1.5 rounded-full bg-blue-100 hover:bg-blue-200 text-blue-800" aria-label={`Move to ${availableCategories[currentCategoryIndex + 1]}`}>
                            <ArrowDownIcon className="w-4 h-4" />
                          </button>}
                      </div>

                      {/* Position Movement Controls */}
                      <div className="flex items-center gap-1">
                        {index > 0 && <button onClick={() => onMoveWithinCategory?.(index, index - 1)} className="p-1.5 rounded-full bg-gray-100 hover:bg-gray-200" aria-label="Move up within category">
                            <ChevronUpIcon className="w-4 h-4" />
                          </button>}
                        {index < cards.length - 1 && <button onClick={() => onMoveWithinCategory?.(index, index + 1)} className="p-1.5 rounded-full bg-gray-100 hover:bg-gray-200" aria-label="Move down within category">
                            <ChevronDownIcon className="w-4 h-4" />
                          </button>}
                      </div>
                    </div>
                  </div>

                  {/* Expandable Description */}
                  <AnimatePresence>
                    {expandedCards.has(card.id) && <motion.div initial={{
                height: 0,
                opacity: 0
              }} animate={{
                height: 'auto',
                opacity: 1
              }} exit={{
                height: 0,
                opacity: 0
              }} className="overflow-hidden">
                        <div className="px-4 pb-3 text-sm text-yellow-800">
                          {card.description}
                        </div>
                      </motion.div>}
                  </AnimatePresence>
                </div>)}
            </div>
          </motion.div>}
      </AnimatePresence>
    </motion.div>;
}

================
File: src/components/features/Round/components/Mobile/MobileSelectionOverlay.tsx
================
import { motion, AnimatePresence } from 'framer-motion';
import { MobileSelectionOverlayProps} from '@/components/features/Round/types';


export function MobileSelectionOverlay({ isVisible }: MobileSelectionOverlayProps) {
  return (
    <AnimatePresence>
      {isVisible && (
        <>
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            transition={{ duration: 0.2 }}
            className="fixed inset-0 bg-black bg-opacity-50 z-100"
          />
          <motion.div
            initial={{ opacity: 0, y: -20 }}
            animate={{ opacity: 1, y: 0 }}
            exit={{ opacity: 0, y: -20 }}
            transition={{ duration: 0.2, delay: 0.1 }}
            className="fixed top-4 left-1/2 transform -translate-x-1/2 text-white text-lg font-medium z-50 text-center pointer-events-none px-4 w-full"
          >
            Tap a category to place card
          </motion.div>
        </>
      )}
    </AnimatePresence>
  );
}

================
File: src/components/features/Round/components/MobileCardView.tsx
================
// src/components/Round/components/MobileCardView.tsx
import React from 'react';
import { Value, CategoryName, Categories } from "@/lib/types";
import { Card } from "@/components/features/Cards/components";
import { MobileCardViewProps} from '@/components/features/Round/types';

export const MobileCardView: React.FC<MobileCardViewProps> = ({
  cards,
  categorizedCards,
  onCardPlace
}) => {
  return <div className="fixed inset-0 bg-white z-50 overflow-auto p-4" role="dialog" aria-label="Value cards selection">
      <div className="space-y-4" role="list" aria-label="Available value cards">
        {cards.map(card => <div key={card.id} className="p-2" role="listitem">
            <Card value={card} aria-label={`Value card: ${card.title}`} />
          </div>)}
      </div>
      
      {cards.length === 0 && <div className="text-center text-gray-700 py-4" role="status" aria-live="polite">
          No cards available
        </div>}
    </div>;
};

================
File: src/components/features/Round/components/MobileCategoryList.tsx
================
import { useState } from 'react';
import { Categories, CategoryName, Value } from "@/lib/types";
import { MobileCategoryRow } from './Mobile/MobileCategoryRow';
import { MobileCategoryListProps} from '@/components/features/Round/types';

export function MobileCategoryList({
  categories,
  activeDropZone,
  onDrop,
  onMoveWithinCategory,
  onMoveBetweenCategories,
  selectedCard,
  onCardSelect
}: MobileCategoryListProps) {
  const [expandedCategory, setExpandedCategory] = useState<CategoryName | null>(null);
  const categoryNames = Object.keys(categories) as CategoryName[];
  const [lastDroppedCategory, setLastDroppedCategory] = useState<CategoryName | null>(null);
  const handleCategorySelect = (category: CategoryName) => {
    if (selectedCard) {
      setLastDroppedCategory(category);
      onDrop(selectedCard, category);
      onCardSelect(null);
      // Reset the highlight after animation
      setTimeout(() => {
        setLastDroppedCategory(null);
      }, 1000); // 1 second total for the animation
    }
  };
  const handleCategoryTap = (category: CategoryName) => {
    setExpandedCategory(expandedCategory === category ? null : category);
  };
  return <div className="h-full flex flex-col">
      <div className="flex-1 overflow-y-auto px-1" // Changed from -mx-2 to px-3
    role="region" aria-label="Categories list">
        <div className="space-y-2"> {/* Removed px-2 since padding is now on parent */}
          {categoryNames.map(category => <div key={category}>
              <MobileCategoryRow category={category} cards={categories[category] ?? []} availableCategories={categoryNames} isActive={activeDropZone === category} isExpanded={expandedCategory === category} onCategoryTap={handleCategoryTap} onCategorySelect={handleCategorySelect} showingCardSelection={!!selectedCard} onMoveWithinCategory={(fromIndex, toIndex) => onMoveWithinCategory(category, fromIndex, toIndex)} onMoveBetweenCategories={onMoveBetweenCategories} lastDroppedCategory={lastDroppedCategory} />
            </div>)}
        </div>
      </div>
    </div>;
}

================
File: src/components/features/Round/components/StatusMessage.tsx
================
// src/components/Round/components/StatusMessage.tsx
'use client';

import { ReactNode } from 'react';
import { StatusMessageProps } from '@/components/features/Round/types';
import { useMobile } from "@/lib/contexts/MobileContext";
export const StatusMessage = ({
  status,
  isNearingCompletion,
  hasTooManyImportantCards,
  hasNotEnoughImportantCards,
  hasEnoughCards,
  targetCoreValues,
  canProceedToNextRound,
  remainingCards,
  showDetails = true,
  totalActiveCards,
  hasTargetCoreValuesInVeryImportant,
  setShowDetails
}: StatusMessageProps): ReactNode => {
  const {
    isMobile
  } = useMobile();
  const handleButtonClick = () => {
    if (setShowDetails) {
      setShowDetails(!showDetails); // Toggle the details visibility
    }
  };
  const messageContent = <div role="status">
    <p className={`${isMobile ? 'text-sm' : 'text-base'} font-medium leading-tight`} aria-live="polite">
      {status.text}
    </p>
    {isNearingCompletion && (hasTooManyImportantCards || hasNotEnoughImportantCards) && <p className={`mt-1 ${isMobile ? 'text-xs' : 'text-sm'} leading-tight`} aria-live="polite">
      You need exactly {targetCoreValues} values in Very Important
    </p>}
    {totalActiveCards === targetCoreValues && !hasTargetCoreValuesInVeryImportant && (
      <p className={`mt-1 ${isMobile ? 'text-xs' : 'text-sm'} leading-tight`} aria-live="polite">
        You need exactly {targetCoreValues} values in Very Important
      </p>
    )}
    {!hasEnoughCards && <p className={`mt-1 ${isMobile ? 'text-xs' : 'text-sm'} leading-tight`} aria-live="polite">
      You must keep at least {targetCoreValues} values outside of Not Important
    </p>}
  </div>;
  if (isMobile) {
    return <div className="relative" role="status" aria-live="polite">
      <button onClick={handleButtonClick} className={`
            rounded-full p-2 flex items-center justify-center
            ${!canProceedToNextRound && remainingCards.length === 0 ? 'bg-red-100 text-red-800' : status.type === 'warning' ? 'bg-yellow-100 text-yellow-800' : status.type === 'success' ? 'bg-green-100 text-green-800' : 'bg-blue-100 text-blue-800'}
            focus:outline-none focus:ring-2 focus:ring-offset-2
            ${status.type === 'warning' ? 'focus:ring-yellow-500' : status.type === 'success' ? 'focus:ring-green-500' : 'focus:ring-blue-500'}
          `} aria-expanded={showDetails} aria-label={`Game status: ${status.text}. ${showDetails ? 'Hide details' : 'Show details'}`}>
        <span aria-hidden="true">
          {status.type === 'warning' ? '⚠️' : status.type === 'success' ? '✅' : 'ℹ️'}
        </span>
        <span className="sr-only">{status.text}</span>
      </button>

      {showDetails && <div className="absolute right-0 top-full mt-2 z-50 w-64 p-4 rounded-lg shadow-lg bg-white border" role="tooltip" aria-label="Status details">
        {messageContent}
      </div>}
    </div>;
  }

  // Desktop version - always show
  return <div className={`
        relative
        p-3 sm:p-4
        min-h-[5rem]
        h-full
        w-full
        flex flex-col justify-center 
        rounded-lg 
        overflow-hidden
        ${!canProceedToNextRound && remainingCards.length === 0 ? 'bg-red-100 text-red-800' : status.type === 'warning' ? 'bg-yellow-100 text-yellow-800' : status.type === 'success' ? 'bg-green-100 text-green-800' : 'bg-blue-100 text-blue-800'}
      `} role="status" aria-live="polite">
    <div className="space-y-1">
      {messageContent}
    </div>
  </div>;
};

================
File: src/components/features/Round/hooks/useMobileInteractions.ts
================
import { useState, useCallback } from 'react';
import { CategoryName, Value } from "@/lib/types";
import { logStateUpdate } from "@/lib/utils";

export function useMobileInteractions() {
  const [expandedCategory, setExpandedCategory] = useState<CategoryName | null>(null);
  const [activeDropZone, setActiveDropZone] = useState<CategoryName | null>(null);
  const handleExpand = useCallback((category: CategoryName) => {
    logStateUpdate('handleMobileExpand', {
      category
    }, 'MobileInteractions');
    setExpandedCategory(category);
  }, []);
  const handleClose = useCallback(() => {
    logStateUpdate('handleMobileClose', {}, 'MobileInteractions');
    setExpandedCategory(null);
  }, []);
  const handleDropWithZone = useCallback((card: Value, category: CategoryName) => {
    logStateUpdate('handleMobileDropWithZone', {
      card,
      category
    }, 'MobileInteractions');
    setActiveDropZone(category);

    // Clear the active zone after a short delay
    setTimeout(() => {
      setActiveDropZone(null);
    }, 500);
    return {
      category
    };
  }, []);
  return {
    expandedCategory,
    activeDropZone,
    handleExpand,
    handleClose,
    handleDropWithZone
  };
}

================
File: src/components/features/Round/hooks/useMobileView.ts
================
import { useState } from 'react';
import { CategoryName, Value } from "@/lib/types";
export function useMobileView() {
  const [expandedCategory, setExpandedCategory] = useState<CategoryName | null>(null);
  const [showCategorySelection, setShowCategorySelection] = useState(false);
  const [selectedCard, setSelectedCard] = useState<Value | null>(null);
  const handleExpandCategory = (category: CategoryName) => {
    setExpandedCategory(category === expandedCategory ? null : category);
  };
  const handleCloseExpanded = () => {
    setExpandedCategory(null);
  };
  const handleShowCategorySelection = (card: Value) => {
    setSelectedCard(card);
    setShowCategorySelection(true);
  };
  const handleCloseCategorySelection = () => {
    setShowCategorySelection(false);
    setSelectedCard(null);
  };
  return {
    expandedCategory,
    showCategorySelection,
    selectedCard,
    handleExpandCategory,
    handleCloseExpanded,
    handleShowCategorySelection,
    handleCloseCategorySelection
  };
}

================
File: src/components/features/Round/hooks/useRoundHandlers.ts
================
import { useCallback, useEffect } from 'react';
import { CategoryName, Categories, Value, Command } from "@/lib/types";
import { MoveCommand } from "@/components/features/Exercise/commands/MoveCommand";
import { DropCommand } from "@/components/features/Exercise/commands/DropCommand";
import { saveRound } from "@/lib/db/indexedDB";
import { logEffect, logStateUpdate } from "@/lib/utils";
export const useRoundHandlers = (categories: Categories, setCategories: (categories: Categories) => void, remainingCards: Value[], setRemainingCards: (cards: Value[]) => void, validCategories: CategoryName[], activeCategories: CategoryName[], sessionId: string | null, roundNumber: number, currentRoundCommands: Command[], addCommand: (command: Command) => Promise<void>, clearCommands: () => void, targetCoreValues: number, setRoundNumber: (round: number) => void, setShowResults: (show: boolean) => void, setShowStatusDetails: (isFirst: boolean) => void) => {
  useEffect(() => {
    logEffect('categories effect in useRoundHandlers', [categories]);
  }, [categories]);
  useEffect(() => {
    console.log('Commands updated:', currentRoundCommands);
  }, [currentRoundCommands]);

  // in useRoundHandlers.ts
  const saveRoundData = useCallback(async (command: Command) => {
    if (!sessionId) return;
    try {
      // Only pass the visible categories
      const visibleCats = Object.fromEntries(Object.entries(categories).filter(([category]) => validCategories.includes(category as CategoryName))) as Categories;
      await saveRound(sessionId, roundNumber, [...currentRoundCommands, command], visibleCats);
    } catch (error) {
      console.error('Failed to save round data:', error);
    }
  }, [sessionId, roundNumber, currentRoundCommands, categories, validCategories]);
  const handleDrop = useCallback(async (value: Value, category: CategoryName): Promise<void> => {
    if (!validCategories.includes(category)) return;
    const card = remainingCards.find((c: Value) => c.title === value.title);
    if (!card) return;
    const command = new DropCommand(value, category);
    const updatedCategories = {
      ...categories
    };
    updatedCategories[category] = [...(categories[category] || []), card];
    setCategories(updatedCategories);
    setRemainingCards(remainingCards.filter((c: Value) => c.title !== value.title));
    await addCommand(command);
    await saveRoundData(command);
  }, [remainingCards, categories, validCategories, setCategories, setRemainingCards, addCommand, saveRoundData]);
  const handleMoveCard = useCallback(async (category: CategoryName, fromIndex: number, toIndex: number): Promise<void> => {
    // Debug logging
    console.log('handleMoveCard called:', {
      category,
      fromIndex,
      toIndex
    });

    // Early returns with logging
    if (!validCategories.includes(category)) {
      console.log('Invalid category, returning');
      return;
    }
    if (fromIndex === toIndex) {
      console.log('Same index, returning');
      return;
    }
    const categoryCards = categories[category] || [];
    if (!categoryCards[fromIndex]) {
      console.log('No card at fromIndex, returning');
      return;
    }

    // Get the card we're moving
    const cardToMove = categoryCards[fromIndex];

    // Create a new categories object with the updated order
    const updatedCategories = {
      ...categories
    };
    const newCards = [...categoryCards];
    newCards.splice(fromIndex, 1);
    newCards.splice(toIndex, 0, cardToMove);
    updatedCategories[category] = newCards;

    // Create single command for this move
    const command = new MoveCommand(cardToMove, category, category, fromIndex, toIndex);

    // Update state and save in a single operation
    try {
      setCategories(updatedCategories);
      await addCommand(command);
      await saveRoundData(command);
      console.log('Move completed successfully:', {
        card: cardToMove,
        from: fromIndex,
        to: toIndex,
        category
      });
    } catch (error) {
      console.error('Error in handleMoveCard:', error);
    }
  }, [categories, validCategories, setCategories, addCommand, saveRoundData]);
  const handleMoveBetweenCategories = useCallback(async (value: Value, fromCategory: CategoryName, toCategory: CategoryName): Promise<void> => {
    if (!activeCategories.includes(fromCategory)) return;
    if (!validCategories.includes(toCategory) && !activeCategories.includes(toCategory)) return;
    // Set first interaction to false when a card is dropped

    const fromCards = categories[fromCategory] || [];
    const toCards = categories[toCategory] || [];
    if (!fromCards.some(card => card.title === value.title)) return;
    const command = new MoveCommand(value, fromCategory, toCategory);
    const updatedCategories = {
      ...categories
    };
    updatedCategories[fromCategory] = fromCards.filter(card => card.title !== value.title);
    updatedCategories[toCategory] = [...toCards, value];
    setCategories(updatedCategories);
    await addCommand(command);
    await saveRoundData(command);
  }, [categories, validCategories, activeCategories, setCategories, addCommand, saveRoundData]);
  return {
    handleMoveCard,
    handleDrop,
    handleMoveBetweenCategories,
    saveRoundData
  };
};

================
File: src/components/features/Round/hooks/useRoundState.ts
================
import { useMemo } from 'react';
import { Categories, CategoryName, Value } from "@/lib/types";
export const useRoundState = (categories: Categories, remainingCards: Value[], targetCoreValues: number) => {
  const hasTargetCoreValuesInVeryImportant = categories['Very Important']?.length === targetCoreValues;

  // Calculate active cards (excluding Not Important)
  const activeCards = Object.entries(categories).filter(([category]) => category !== 'Not Important').reduce((sum, [_, cards]) => sum + (cards?.length || 0), 0);

  // Calculate total active including remaining cards
  const totalActiveCards = activeCards + remainingCards.length;
  const validCategories = useMemo(() => {
    return Object.keys(categories).filter(category => categories[category] !== undefined) as CategoryName[];
  }, [categories]);
  const activeCategories = useMemo(() => {
    return Object.entries(categories).filter(([_, cards]) => cards && cards.length > 0).map(([category]) => category as CategoryName);
  }, [categories]);
  const visibleCategories = useMemo(() => {
    const allCategories = [...validCategories, ...activeCategories].filter((category, index, self) => self.indexOf(category) === index);
    return allCategories.reduce((acc, category) => {
      acc[category] = categories[category] || [];
      return acc;
    }, {} as Categories);
  }, [validCategories, activeCategories, categories]);
  const veryImportantCount = categories['Very Important']?.length || 0;
  const notImportantCount = categories['Not Important']?.length || 0;
  const isNearingCompletion = validCategories.length === 2;
  const hasEnoughCards = totalActiveCards >= targetCoreValues;
  const hasMinimumNotImportant = (totalActiveCards === targetCoreValues && hasTargetCoreValuesInVeryImportant) || (notImportantCount >= 1);
  const hasTooManyImportantCards = isNearingCompletion && veryImportantCount > targetCoreValues;
  const hasNotEnoughImportantCards = isNearingCompletion && veryImportantCount < targetCoreValues;

  // New calculation for found core values
  const hasFoundCoreValues = Object.entries(categories).some(([category, cards]) => category !== 'Not Important' && cards?.length === targetCoreValues);
  const isEndGameReady = isNearingCompletion && veryImportantCount === targetCoreValues && totalActiveCards === targetCoreValues && hasMinimumNotImportant
    || hasFoundCoreValues || hasTargetCoreValuesInVeryImportant;
  return {
    activeCards,
    totalActiveCards,
    validCategories,
    activeCategories,
    visibleCategories,
    veryImportantCount,
    notImportantCount,
    isNearingCompletion,
    hasEnoughCards,
    hasMinimumNotImportant,
    hasTooManyImportantCards,
    hasNotEnoughImportantCards,
    isEndGameReady,
    hasFoundCoreValues,
    hasTargetCoreValuesInVeryImportant,
    categories
  };
};

================
File: src/components/features/Round/hooks/useRoundStatus.ts
================
// src/components/Round/hooks/useRoundStatus.ts
import { useCallback } from 'react';
import { useMobile } from '@/lib/contexts/MobileContext';
import {StatusState, Status, StatusType} from '@/components/features/Round/types';

export const useRoundStatus = (state: StatusState) => {
  const {
    isMobile
  } = useMobile();
  return useCallback((): Status => {
    if (state.remainingCards.length > 0) {
      if (isMobile) {
        return {
          text: `Tap the yellow card to select it, then tap a category to place it`,
          type: 'info',
          isEndGame: false
        };
      }
      return {
        text: `Drag the remaining ${state.remainingCards.length === 1 ? "" : state.remainingCards.length} ${state.remainingCards.length === 1 ? "value" : "values"} to a category`,
        type: 'info',
        isEndGame: false
      };
    }
    if (!state.hasMinimumNotImportant) {
      return {
        text: 'You need to place at least one value in Not Important before you can continue',
        type: 'warning',
        isEndGame: false
      };
    }
    const activeCardsCount = Object.entries(state.categories).filter(([category]) => category !== 'Not Important').reduce((sum, [_, cards]) => sum + (cards?.length || 0), 0);
    if (activeCardsCount < state.targetCoreValues) {
      return {
        text: `You need at least ${state.targetCoreValues} values outside of Not Important to continue`,
        type: 'warning',
        isEndGame: false
      };
    }
    if (state.veryImportantCount === state.targetCoreValues) {
      return {
        text: 'Perfect! Click End Game to complete the exercise.',
        type: 'success',
        isEndGame: true
      };
    }
    return {
      text: 'You can continue to the next round or keep refining your choices',
      type: 'info',
      isEndGame: false
    };
  }, [state, isMobile]);
};

================
File: src/components/features/Round/hooks/useRoundValidation.ts
================
import { useCallback } from 'react';
import { Value, Categories } from "@/lib/types";
export type ValidationState = {
  remainingCards: Value[];
  hasMinimumNotImportant: boolean;
  hasEnoughCards: boolean;
  isNearingCompletion: boolean;
  veryImportantCount: number;
  targetCoreValues: number;
  totalActiveCards: number;
  categories: Categories;
};
export const useRoundValidation = (state: ValidationState) => {
  return () => {
    // Can't proceed if there are remaining cards
    if (state.remainingCards.length > 0) {
      return false;
    }

    // Must have at least one card in Not Important
    if (!state.hasMinimumNotImportant) {
      return false;
    }

    // Calculate total cards in non-Not Important categories
    const activeCardsCount = Object.entries(state.categories).filter(([category]) => category !== 'Not Important').reduce((sum, [_, cards]) => sum + (cards?.length || 0), 0);

    // Allow next round if we have enough active cards for the target
    return activeCardsCount >= state.targetCoreValues;
  };
};

================
File: src/components/features/Round/index.ts
================
export { default as RoundUI } from './RoundUI';

================
File: src/components/features/Round/RoundActions.tsx
================
// src/components/Round/RoundActions.tsx
import { CategoryName } from "@/lib/types";
import { Card } from "@/components/features/Cards/components";
import { RoundActionsPropsWithActiveZone } from './types';
import { useMobile } from "@/lib/contexts/MobileContext";

export function RoundActions({
  remainingCards,
  canProceedToNextRound,
  onNextRound,
  onDrop,
  isEndGame,
  onActiveDropZoneChange,
  selectedMobileCard,
  onMobileCardSelect,
  setShowDetails
}: RoundActionsPropsWithActiveZone) {
  const {
    isMobile
  } = useMobile();
  const currentCard = remainingCards.length > 0 ? remainingCards[0] : null;
  const handleCardClick = () => {
    if (isMobile) {
      setShowDetails?.(false);
      onMobileCardSelect?.(currentCard);
    }
  };
  if (!currentCard) {
    return <div className="h-24 sm:h-48 flex items-center justify-center" role="region" aria-label="Round progression">
        <div className="flex justify-center mt-4">
          <button onClick={onNextRound} disabled={!canProceedToNextRound} className={`
              ${isMobile ? 'px-3 py-1.5 text-sm' : 'px-6 py-2 text-base'}
              rounded-md text-white font-medium
              ${canProceedToNextRound ? 'bg-blue-600 hover:bg-blue-700' : 'bg-gray-400 cursor-not-allowed'}
              focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2
            `} aria-label={isEndGame ? 'Complete exercise' : 'Proceed to next round'}>
            {isEndGame ? 'Finish' : 'Next Round'}
          </button>
        </div>
      </div>;
  }
  if (isMobile) {
    return <div className="flex flex-col items-center h-32 mb-2" role="region" aria-label="Current value card">
        <div className={`
            flex items-center justify-center cursor-pointer
            transform transition-all duration-200
            scale-[0.7]
          `} role="button" tabIndex={0} onClick={handleCardClick} onKeyPress={e => {
        if (e.key === 'Enter' || e.key === ' ') {
          handleCardClick();
        }
      }} aria-label={`${selectedMobileCard ? 'Selected card' : 'Select card'}: ${currentCard.title}`}>
          <Card value={currentCard} onClick={handleCardClick} selectedMobileCard={!!selectedMobileCard} // Add this line
        />
        </div>
      </div>;
  }
  return <div className="flex flex-col items-center h-48" role="region" aria-label="Current value card">
      <div className="flex items-center justify-center h-full" aria-live="polite">
        <Card value={currentCard} onDrop={value => onDrop(value, value.sourceCategory as CategoryName)} onActiveDropZoneChange={onActiveDropZoneChange} />
      </div>
    </div>;
}

================
File: src/components/features/Round/RoundHeader.tsx
================
import { RoundHeaderProps } from '@/features/Round/types';


export function RoundHeader({
  targetCoreValues,
  roundNumber,
  remainingCardsCount
}: RoundHeaderProps) {
  return (
    <div className="container mx-auto">
      <div className="grid grid-cols-3 gap-2 sm:gap-4 p-2 sm:p-4">
        {/* Both Mobile and Desktop use the same lozenge style */}
        <div>
          <div className="bg-blue-100 rounded-full px-3 py-1.5 text-center shadow-sm">
            <h2 className="text-xs sm:text-sm font-semibold text-blue-700 uppercase tracking-wide">
              Target
            </h2>
            <p className="text-lg sm:text-2xl font-bold text-blue-900">
              {targetCoreValues}
            </p>
          </div>
        </div>
        <div>
          <div className="bg-purple-100 rounded-full px-3 py-1.5 text-center shadow-sm">
            <h2 className="text-xs sm:text-sm font-semibold text-purple-700 uppercase tracking-wide">
              Round
            </h2>
            <p className="text-lg sm:text-2xl font-bold text-purple-900">
              {roundNumber}
            </p>
          </div>
        </div>
        <div>
          <div className="bg-green-100 rounded-full px-3 py-1.5 text-center shadow-sm">
            <h2 className="text-xs sm:text-sm font-semibold text-green-700 uppercase tracking-wide">
              Cards
            </h2>
            <p className="text-lg sm:text-2xl font-bold text-green-900">
              {remainingCardsCount}
            </p>
          </div>
        </div>
      </div>
    </div>
  );
}

================
File: src/components/features/Round/RoundUI.tsx
================
'use client';

import { useState, useEffect, memo, useMemo, useCallback } from 'react';
import { saveRound, updateSession, saveCompletedSession } from "@/lib/db/indexedDB";
import Results from "@/components/features/Exercise/components/Results";
import { useSession } from "@/components/features/Exercise/hooks/useSession";
import { useGameState } from "@/components/features/Exercise/hooks/useGameState";
import { useCommands } from "@/components/features/Exercise/hooks/useCommands";
import { RoundHeader } from './RoundHeader';
import { RoundActions } from './RoundActions';
import { CategoryGrid } from './CategoryGrid';
import { getImportantCards } from "@/components/features/Categories/utils/categoryUtils";
import { useRoundState } from './hooks/useRoundState';
import { useRoundHandlers } from './hooks/useRoundHandlers';
import { useRoundValidation } from './hooks/useRoundValidation';
import { useRoundStatus } from './hooks/useRoundStatus';
import { getRandomValues } from "@/components/features/Home/utils";
import { Categories, CategoryName, Value, ValueWithReason } from "@/lib/types";
import { StatusMessage } from './components/StatusMessage';
import { getCategoriesForRound } from "@/components/features/Categories/utils/categoryUtils";
import { MobileCategoryList } from './components/MobileCategoryList';
import { CoreValueReasoning } from "@/components/features/Exercise/components/CoreValueReasoning";
import { logRender, logStateUpdate, logEffect } from "@/lib/utils";

import { useMobile } from "@/lib/contexts/MobileContext";
import { Card } from "@/components/features/Cards/components";
import { motion } from 'framer-motion';
import { MoveCommand } from "@/components/features/Exercise/commands/MoveCommand";

const RoundUI = memo(function RoundUI() {
  logRender('RoundUI');

  // State
  const [activeDropZone, setActiveDropZone] = useState<CategoryName | null>(null);
  const [showResults, setShowResults] = useState<boolean>(false);
  const [shouldEndGame, setShouldEndGame] = useState<boolean>(false);
  const [showReasoning, setShowReasoning] = useState<boolean>(false);
  const [finalValuesWithoutReasons, setFinalValuesWithoutReasons] = useState<Value[]>([]);
  const [selectedMobileCard, setSelectedMobileCard] = useState<Value | null>(null);
  const [hasShownInstruction, setHasShownInstruction] = useState<boolean>(false);
  const [showStatusDetails, setShowStatusDetails] = useState(true); // New state for status message visibility

  // Hooks
  const {
    sessionId,
    roundNumber,
    targetCoreValues,
    setRoundNumber
  } = useSession();
  const {
    remainingCards,
    categories,
    setCategories,
    setRemainingCards
  } = useGameState();
  const {
    currentRoundCommands,
    addCommand,
    clearCommands
  } = useCommands();
  const {
    isMobile
  } = useMobile();

  // Memoized calculations
  const activeCards = useMemo(() => {
    logEffect('Calculate activeCards', [categories]);
    return Object.entries(categories).filter(([category]) => category !== 'Not Important').reduce((sum, [_, cards]) => {
      return sum + ((cards as Array<any>)?.length || 0); // Replace `any` with the appropriate type if known
    }, 0);
  }, [categories]);
  const roundState = useRoundState(categories, remainingCards, targetCoreValues);
  const validateRound = useRoundValidation({
    remainingCards,
    targetCoreValues,
    hasMinimumNotImportant: roundState.hasMinimumNotImportant,
    hasEnoughCards: roundState.hasEnoughCards,
    isNearingCompletion: roundState.isNearingCompletion,
    veryImportantCount: roundState.veryImportantCount,
    totalActiveCards: roundState.totalActiveCards,
    categories
  });
  
  const hasTargetCoreValuesInVeryImportant = useMemo(() => {
    return roundState.veryImportantCount === targetCoreValues;
  }, [roundState.veryImportantCount, targetCoreValues]);
  const status = useRoundStatus({
    remainingCards,
    targetCoreValues,
    hasMinimumNotImportant: roundState.hasMinimumNotImportant,
    hasEnoughCards: roundState.hasEnoughCards,
    isNearingCompletion: roundState.isNearingCompletion,
    veryImportantCount: roundState.veryImportantCount,
    totalActiveCards: activeCards,
    hasTargetCoreValuesInVeryImportant,
    categories
  });

  // Handlers
  const {
    handleMoveCard,
    handleDrop,
    handleMoveBetweenCategories
  } = useRoundHandlers(categories, setCategories, remainingCards, setRemainingCards, roundState.validCategories, roundState.activeCategories, sessionId, roundNumber, currentRoundCommands, addCommand, clearCommands, targetCoreValues, setRoundNumber, setShowResults, setShowStatusDetails);
  const handleMobileDropWithZone = useCallback((card: Value, category: CategoryName) => {
    logStateUpdate('handleMobileDropWithZone', {
      card,
      category
    }, 'RoundUI');
    setActiveDropZone(category);
    handleDrop(card, category);
    setSelectedMobileCard(null);
    setHasShownInstruction(true); // Add this line
    setTimeout(() => setActiveDropZone(null), 1000);
  }, [handleDrop]);
  const handleNextRound = useCallback(async () => {
    try {
      logStateUpdate('handleNextRound', {
        roundNumber
      }, 'RoundUI');
      if (!validateRound()) {
        console.error('Cannot proceed: round validation failed');
        return;
      }
      if (sessionId) {
        await saveRound(sessionId, roundNumber, currentRoundCommands, categories);
      }

      // Check if we have exactly the target number in Very Important
      const hasExactTargetInVeryImportant = (categories['Very Important']?.length || 0) === targetCoreValues;
      if (shouldEndGame) {
        if (sessionId) {
          const finalValues = categories['Very Important'] || [];
          setFinalValuesWithoutReasons(finalValues);
          setShowReasoning(true);
          return;
        }
      }

      // If not ending game, prepare for next round
      clearCommands();
      const nextRound = roundNumber + 1;

      if (sessionId) {
        await updateSession(sessionId, {
          currentRound: nextRound
        });
      }
      // Get all cards from non-Not Important categories
      const cardsForNextRound = Object.entries(categories).filter(([category]) => category !== 'Not Important').flatMap(([_, cards]) => cards || []);
      if (cardsForNextRound.length < targetCoreValues) {
        console.error('Not enough cards to proceed');
        return;
      }
      const nextCategories = getCategoriesForRound(cardsForNextRound.length, targetCoreValues);
      if (sessionId) {
        await saveRound(sessionId, nextRound, [], nextCategories);
      }
      setRoundNumber(nextRound);
      setCategories(nextCategories);
      setRemainingCards(getRandomValues(cardsForNextRound as Value[]));
    } catch (error) {
      console.error('Failed to handle next round:', error);
    }
  }, [validateRound, sessionId, roundNumber, currentRoundCommands, categories, shouldEndGame, targetCoreValues, clearCommands, setRoundNumber, setCategories, setRemainingCards]);
  const handleReasoningComplete = useCallback(async (valuesWithReasons: ValueWithReason[]) => {
    logStateUpdate('handleReasoningComplete', {
      valuesWithReasons
    }, 'RoundUI');
    if (sessionId) {
      const session = {
        timestamp: Date.now(),
        targetCoreValues,
        currentRound: roundNumber,
        completed: true
      };
      await updateSession(sessionId, session);
      await saveCompletedSession(sessionId, valuesWithReasons);
    }
    const finalCategories = Object.entries(categories).filter(([category]) => category !== 'Not Important').reduce((acc, [category, cards]) => {
      acc[category] = cards as Value[] | undefined;
      return acc;
    }, {} as Categories);
    setCategories(finalCategories);
    setShowReasoning(false);
    setShowResults(true);
  }, [sessionId, targetCoreValues, roundNumber, categories, setCategories]);

  // Effects
  useEffect(() => {
    // Only end game if we have exactly the target number in Very Important
    const hasExactTargetInVeryImportant = (categories['Very Important']?.length || 0) === targetCoreValues;
    setShouldEndGame(hasExactTargetInVeryImportant && remainingCards.length === 0);
  }, [categories, targetCoreValues, remainingCards.length]);

  // Conditional rendering
  if (showReasoning) {
    return <CoreValueReasoning values={finalValuesWithoutReasons} onComplete={handleReasoningComplete} />;
  }
  if (showResults) {
    return <Results />;
  }
  return <div className={`
        flex flex-col h-full overflow-hidden
        ${isMobile && selectedMobileCard ? 'bg-gray-100' : ''}
        transition-colors duration-200
      `} role="application" aria-label="Core Values Sorting Exercise">
    {/* Game Header - Stays visible but faded when card selected */}
    <div className="flex-shrink-0 relative" // Added relative positioning
      role="banner">
      {/* Selection instruction overlay */}
      {isMobile && selectedMobileCard && !hasShownInstruction && <div className="absolute inset-x-0 top-1/2 -translate-y-1/2 z-10 text-center" aria-live="polite">
        <p className="text-sm text-blue-700 font-medium bg-white/90 py-1 px-2 rounded-full inline-block">
          Tap a category to place this card
        </p>
      </div>}

      <div className={`
        transition-opacity duration-200
        ${isMobile && selectedMobileCard ? 'opacity-30' : 'opacity-100'}
      `}>
        <RoundHeader targetCoreValues={targetCoreValues} roundNumber={roundNumber} remainingCardsCount={remainingCards.length} />
      </div>
    </div>

    {/* Game Actions - Card remains visible when selected */}
    <div className={`
          flex-shrink-0
          ${isMobile && selectedMobileCard ? 'relative z-20' : ''}
        `} role="region" aria-label="Game controls">
      {isMobile ? <div className="px-2 py-1 mb-4">
        <div className="flex items-center justify-center gap-4"> {/* Changed to horizontal layout with center alignment */}
          <div className="flex-1" /> {/* Spacer */}
          <RoundActions remainingCards={remainingCards} canProceedToNextRound={validateRound() && roundState.hasMinimumNotImportant} onNextRound={handleNextRound} onDrop={handleDrop} isEndGame={shouldEndGame} selectedMobileCard={selectedMobileCard} onMobileCardSelect={setSelectedMobileCard} setShowDetails={setShowStatusDetails} />
          <div role="status" aria-live="polite" className={`
          transition-opacity duration-200 flex-1 flex justify-end
          ${selectedMobileCard ? 'opacity-30' : 'opacity-100'}
        `}>
            <StatusMessage status={status()} isNearingCompletion={roundState.isNearingCompletion} 
            hasTooManyImportantCards={roundState.hasTooManyImportantCards} hasNotEnoughImportantCards={roundState.hasNotEnoughImportantCards} 
            hasEnoughCards={roundState.hasEnoughCards} targetCoreValues={targetCoreValues} canProceedToNextRound={validateRound()} 
            remainingCards={remainingCards} showDetails={showStatusDetails} setShowDetails={setShowStatusDetails} 
            totalActiveCards={activeCards} hasTargetCoreValuesInVeryImportant={hasTargetCoreValuesInVeryImportant} />
          </div>
        </div>
      </div> : <div className="container mx-auto">
        <div className="grid grid-cols-3 gap-2 sm:gap-4 p-2 sm:p-4" role="region" aria-label="Game controls and status">
          <div /> {/* Empty first column */}
          <div> {/* Middle column */}
            <RoundActions remainingCards={remainingCards} canProceedToNextRound={validateRound() && roundState.hasMinimumNotImportant} onNextRound={handleNextRound} onDrop={handleDrop} isEndGame={shouldEndGame} />
          </div>
          <div> {/* Third column */}
            <StatusMessage status={status()} totalActiveCards={activeCards} hasTargetCoreValuesInVeryImportant={hasTargetCoreValuesInVeryImportant} isNearingCompletion={roundState.isNearingCompletion} hasTooManyImportantCards={roundState.hasTooManyImportantCards} hasNotEnoughImportantCards={roundState.hasNotEnoughImportantCards} hasEnoughCards={roundState.hasEnoughCards} targetCoreValues={targetCoreValues} canProceedToNextRound={validateRound()} remainingCards={remainingCards} />
          </div>
        </div>
      </div>}
    </div>

    {/* Scrollable Game Content */}
    <div className="flex-1 overflow-auto" role="region" aria-label="Value categories">
      {isMobile ? <div className="h-full flex flex-col pb-16 pt-4"> {/* Added pt-2 for top padding */}
        <MobileCategoryList categories={roundState.visibleCategories} activeDropZone={activeDropZone} onDrop={handleMobileDropWithZone} onMoveWithinCategory={handleMoveCard} onMoveBetweenCategories={handleMoveBetweenCategories} selectedCard={selectedMobileCard} onCardSelect={setSelectedMobileCard} />
      </div> : <div className="w-full">
        <CategoryGrid categories={roundState.visibleCategories} onDrop={handleDrop} onMoveWithinCategory={handleMoveCard} onMoveBetweenCategories={handleMoveBetweenCategories} />
      </div>}
    </div>
  </div>;
});
export default RoundUI;

================
File: src/components/features/Round/RoundUIDebug.tsx
================
// src/components/Round/RoundUIDebug.tsx
'use client'

import { Profiler, ProfilerOnRenderCallback } from 'react';
import RoundUI from './RoundUI';

// Explicitly type the callback using the React type
const onRender: ProfilerOnRenderCallback = function(
  id: string,
  phase: 'mount' | 'update' | 'nested-update',
  actualDuration: number,
  baseDuration: number,
  startTime: number,
  commitTime: number
) {
  if (process.env.NODE_ENV === 'development') {
    console.group(`[Profiler] ${id} - ${phase}`);
    console.log(`Actual duration: ${actualDuration.toFixed(2)}ms`);
    console.log(`Base duration: ${baseDuration.toFixed(2)}ms`);
    console.log(`Start time: ${startTime.toFixed(2)}ms`);
    console.log(`Commit time: ${commitTime.toFixed(2)}ms`);
    console.groupEnd();
  }
};

export default function RoundUIDebug() {
  // Only render profiler in development
  if (process.env.NODE_ENV !== 'development') {
    return <RoundUI />;
  }

  return (
    <div> {/* Hide profiler wrapper from screen readers */}
      <Profiler 
        id="RoundUI" 
        onRender={onRender}
      >
        <RoundUI />
      </Profiler>
    </div>
  );
}

================
File: src/components/features/Round/types.ts
================
// Generated types file

import { Categories, CategoryName, Value } from "@/lib/types";

export interface MobileCardControlsProps {
  canMoveUp: boolean;
  canMoveDown: boolean;
  onMoveUp: () => void;
  onMoveDown: () => void;
  canMoveToPrevCategory: boolean;
  canMoveToNextCategory: boolean;
  onMoveToPrevCategory: () => void;
  onMoveToNextCategory: () => void;
}


export interface MobileCategoryRowProps {
  category: CategoryName;
  cards: Value[];
  availableCategories: CategoryName[];
  isActive: boolean;
  isExpanded: boolean;
  onCategoryTap: (category: CategoryName) => void;
  onCategorySelect: (category: CategoryName) => void;
  showingCardSelection: boolean;
  onMoveWithinCategory?: (fromIndex: number, toIndex: number) => void;
  onMoveBetweenCategories?: (value: Value, fromCategory: CategoryName, toCategory: CategoryName) => Promise<void>;
  lastDroppedCategory: CategoryName | null; // Add this line
}

export interface MobileSelectionOverlayProps {
  isVisible: boolean;
}

export interface MobileCardViewProps {
  cards: Value[];
  categorizedCards: Categories;
  onCardPlace: (card: Value, category: CategoryName) => void;
}


export interface MobileCategoryListProps {
  categories: Categories;
  activeDropZone: CategoryName | null;
  onDrop: (card: Value, category: CategoryName) => void;
  onMoveWithinCategory: (category: CategoryName, fromIndex: number, toIndex: number) => Promise<void>;
  onMoveBetweenCategories: (value: Value, fromCategory: CategoryName, toCategory: CategoryName) => Promise<void>;
  selectedCard: Value | null;
  onCardSelect: (card: Value | null) => void;
}

export interface StatusMessageProps {
  status: {
    text: string;
    type: 'info' | 'warning' | 'success';
    isEndGame?: boolean;
  };
  isNearingCompletion: boolean;
  hasTooManyImportantCards: boolean;
  hasNotEnoughImportantCards: boolean;
  hasEnoughCards: boolean;
  targetCoreValues: number;
  canProceedToNextRound: boolean;
  remainingCards: any[];
  showDetails?: boolean;
  setShowDetails?: (show: boolean) => void;
  totalActiveCards: number,
  hasTargetCoreValuesInVeryImportant: boolean,
}

export interface CategoryGridProps {
  categories: Categories;
  onDrop: (value: Value, category: CategoryName) => Promise<void>;
  onMoveWithinCategory: (category: CategoryName, fromIndex: number, toIndex: number) => Promise<void>;
  onMoveBetweenCategories: (value: Value, fromCategory: CategoryName, toCategory: CategoryName) => Promise<void>;
}

export interface RoundActionsProps {
  remainingCards: Value[];
  canProceedToNextRound: boolean;
  onNextRound: () => void;
  onDrop: (card: Value, category: CategoryName) => void;
  isEndGame: boolean;
  setShowDetails?: (show: boolean) => void;
}

export interface RoundHeaderProps {
  targetCoreValues: number;
  roundNumber: number;
  remainingCardsCount: number;
}

export interface RoundUIProps {
  maxCards: number;
  showResults: boolean;
  sessionId?: string;
  roundNumber: number;
  targetCoreValues: number;
  remainingCards: Value[];
  categories: Categories;
  currentRoundCommands: any[]; // Consider creating a specific type for commands
  canProceedToNextRound: boolean;
  isEndGameReady: boolean;
  onMoveCard: (category: CategoryName, fromIndex: number, toIndex: number) => Promise<void>;
  onMoveBetweenCategories: (value: Value, fromCategory: CategoryName, toCategory: CategoryName) => Promise<void>;
  onDrop: (value: Value, category: CategoryName) => Promise<void>;
  onNextRound: () => Promise<void>;
}


export interface RoundActionsPropsWithActiveZone extends RoundActionsProps {
  onActiveDropZoneChange?: (category: CategoryName | null) => void;
  selectedMobileCard?: Value | null;
  onMobileCardSelect?: (card: Value | null) => void;
  setShowDetails?: (show: boolean) => void;
}

export interface StatusState {
  remainingCards: Value[];
  targetCoreValues: number;
  categories: Categories;
  hasMinimumNotImportant: boolean;
  hasEnoughCards: boolean;
  isNearingCompletion: boolean;
  veryImportantCount: number;
  totalActiveCards: number;
  hasTargetCoreValuesInVeryImportant : boolean;
}

export interface CategoryGridProps {
  categories: Categories;
  onDrop: (value: Value, category: CategoryName) => Promise<void>;
  onMoveWithinCategory: (category: CategoryName, fromIndex: number, toIndex: number) => Promise<void>;
  onMoveBetweenCategories: (value: Value, fromCategory: CategoryName, toCategory: CategoryName) => Promise<void>;
}

export type StatusType = 'info' | 'warning' | 'success';

export interface Status {
  text: string;
  type: StatusType;
  isEndGame?: boolean;
}

================
File: src/components/features/Round/utils/categoryUtils.ts
================
import { CategoryName } from "@/lib/types";
export const getCategories = (activeCardCount: number, targetValue: number): CategoryName[] => {
  const ratio = activeCardCount / targetValue;
  if (ratio <= 1.5) {
    return ['Very Important', 'Not Important'];
  } else if (ratio <= 2) {
    return ['Very Important', 'Quite Important', 'Not Important'];
  } else if (ratio <= 3) {
    return ['Very Important', 'Quite Important', 'Important', 'Not Important'];
  }
  return ['Very Important', 'Quite Important', 'Important', 'Of Some Importance', 'Not Important'];
};

================
File: src/config/config.json
================
{
    "debug": false,
    "maxCards": 35,
    "numCoreValues": 5
}

================
File: src/data/values.json
================
{
    "values": [
        {
            "id" : "1",
            "title": "BEING EXPERT",
            "description": "You like being known as someone with special knowledge or skills."
        },
        {
            "id" : "2",
            "title": "FAST PACE",
            "description": "You enjoy working rapidly at a high pace."
        },
        {
            "id" : "3",
            "title": "MONEY",
            "description": "Earning a large amount of money is important to you."
        },
        {
            "id" : "4",
            "title": "PRESSURE",
            "description": "You like working to deadlines."
        },
        {
            "id" : "5",
            "title": "WORK ALONE",
            "description": "You like to work on your own."
        },
        {
            "id" : "6",
            "title": "COMPETITION",
            "description": "You enjoy competing against other people or groups."
        },
        {
            "id" : "7",
            "title": "PRECISE WORK",
            "description": "You like working on things which involve great care and concentration."
        },
        {
            "id" : "8",
            "title": "ARTISTIC",
            "description": "You enjoy making music, making designs, writing poetry, making models etc."
        },
        {
            "id" : "9",
            "title": "PHYSICAL CHALLENGE",
            "description": "You enjoy doing something that is physically demanding."
        },
        {
            "id" : "10",
            "title": "A WELL-KNOWN ORGANISATION",
            "description": "You like being part of a well-known organisation."
        },
        {
            "id" : "11",
            "title": "STATUS",
            "description": "You enjoy being in a position which leads other people to respect you."
        },
        {
            "id" : "12",
            "title": "VARIETY",
            "description": "You enjoy having lots of different things to do."
        },
        {
            "id" : "13",
            "title": "ROUTINE",
            "description": "You like having a routine which is fairly predictable."
        },
        {
            "id" : "14",
            "title": "CONTACT WITH PEOPLE",
            "description": "You enjoy having a lot of contact with people."
        },
        {
            "id" : "15",
            "title": "TIME FREEDOM",
            "description": "You prefer to decide how to use your own time, rather than having a rigid daily routine."
        },
        {
            "id" : "16",
            "title": "COMMUNICATION",
            "description": "You enjoy being able to express ideas or feelings to other people."
        },
        {
            "id" : "17",
            "title": "PERSUADING PEOPLE",
            "description": "You enjoy persuading people to buy something or change their minds about something."
        },
        {
            "id" : "18",
            "title": "PROMOTION",
            "description": "You like to work where there is a good chance of promotion."
        },
        {
            "id" : "19",
            "title": "SECURITY",
            "description": "It is important to know your work will always be there for you."
        },
        {
            "id" : "20",
            "title": "FRIENDSHIP",
            "description": "You would or do like close friendships with people at work."
        },
        {
            "id" : "21",
            "title": "SUPERVISION",
            "description": "You enjoy being responsible for work done by others."
        },
        {
            "id" : "22",
            "title": "RISK",
            "description": "You like to take risks."
        },
        {
            "id" : "23",
            "title": "RECOGNITION",
            "description": "You do like people to appreciate you for the work you do."
        },
        {
            "id" : "24",
            "title": "HELP SOCIETY",
            "description": "You like to think that your work is producing something worthwhile for society."
        },
        {
            "id" : "25",
            "title": "PLACE OF WORK",
            "description": "It is important that you work in the right part of the country for you."
        },
        {
            "id" : "26",
            "title": "EXCITEMENT",
            "description": "It is important for you to have a lot of excitement in your work."
        },
        {
            "id" : "27",
            "title": "MAKING DECISIONS",
            "description": "It is important to you to have to make decisions about how things should be done, who should do it and when it should be done."
        },
        {
            "id" : "28",
            "title": "CHALLENGE",
            "description": "You enjoy being 'stretched' and given new problems to work on."
        },
        {
            "id" : "29",
            "title": "HELPING OTHERS",
            "description": "It is important to you to help other people either individually or in groups, as part of your work."
        },
        {
            "id" : "30",
            "title": "COMMUNITY",
            "description": "You like to live in a place where you can get involved in the community."
        },
        {
            "id" : "31",
            "title": "INDEPENDENCE",
            "description": "You like being able to work in the way you want, without others telling you what to do."
        },
        {
            "id" : "32",
            "title": "WORK WITH OTHERS",
            "description": "You like to work in a team alongside others."
        },
        {
            "id" : "33",
            "title": "PEACE",
            "description": "You prefer to have few pressures and uncomfortable demands."
        },
        {
            "id" : "34",
            "title": "LEARNING",
            "description": "It is important for you to learn new things."
        },
        {
            "id" : "35",
            "title": "CREATIVITY",
            "description": "Thinking up new ideas and ways of doing things is important to you."
        }
    ]
  }

================
File: src/hooks/useSessionReconstruction.ts
================
import { useState, useEffect } from 'react';
import { Categories, Command, Round, Value, CategoryName, DropCommandPayload, MoveCommandPayload } from "@/lib/types";
import { getRoundsBySession } from "@/lib/db/indexedDB";
import valuesData from '@/data/values.json';
import {ReconstructedState} from '@/lib/types'

export function useSessionReconstruction(sessionId: string | null) {
  const [reconstructedState, setReconstructedState] = useState<ReconstructedState | null>(null);
  useEffect(() => {
    if (!sessionId) return;
    const reconstructState = async () => {
      const rounds = await getRoundsBySession(sessionId);

      // Initialize categories
      let categories: Categories = {
        'Very Important': [],
        'Quite Important': [],
        'Important': [],
        'Of Some Importance': [],
        'Not Important': []
      };

      // Create a map of all possible values from values.json
      const allValues = new Map<string, Value>(valuesData.values.map(value => [value.id, value]));

      // Second pass: reconstruct categories
      for (const round of rounds) {
        for (const command of round.commands) {
          if (command.type === 'DROP') {
            const dropPayload = command.payload as DropCommandPayload;
            const value = allValues.get(dropPayload.cardId);
            if (value && dropPayload.category in categories) {
              categories[dropPayload.category] = [...(categories[dropPayload.category] ?? []), value];
            }
          } else if (command.type === 'MOVE') {
            const movePayload = command.payload as MoveCommandPayload;
            const value = allValues.get(movePayload.cardId);
            if (value && movePayload.fromCategory in categories && movePayload.toCategory in categories) {
              // Remove from source
              const sourceCategory = categories[movePayload.fromCategory] ?? [];
              categories[movePayload.fromCategory] = sourceCategory.filter(v => v.id !== movePayload.cardId);

              // Add to target
              const targetCategory = categories[movePayload.toCategory] ?? [];
              categories[movePayload.toCategory] = [...targetCategory, value];
            }
          }
        }
      }

      // Calculate remaining cards
      const usedCardIds = new Set(Object.values(categories).flatMap(cards => cards?.map(card => card.id) ?? []));
      const remainingCards = valuesData.values.filter(value => !usedCardIds.has(value.id));
      setReconstructedState({
        categories,
        currentRound: rounds.length,
        remainingCards
      });
    };
    reconstructState();
  }, [sessionId]);
  return reconstructedState;
}

================
File: src/lib/contexts/MobileContext.tsx
================
'use client'

import { createContext, useContext, useState, useEffect, ReactNode } from 'react';

interface MobileContextType {
  isMobile: boolean;
}

const MobileContext = createContext<MobileContextType | undefined>(undefined);

export function MobileProvider({ children }: { children: ReactNode }) {
  const [isMobile, setIsMobile] = useState(false);

  useEffect(() => {
    const checkMobile = () => {
      setIsMobile(window.innerWidth < 768);
    };
    
    // Initial check
    checkMobile();
    
    // Add event listener
    window.addEventListener('resize', checkMobile);
    
    // Cleanup
    return () => window.removeEventListener('resize', checkMobile);
  }, []);

  return (
    <MobileContext.Provider value={{ isMobile }}>
      {children}
    </MobileContext.Provider>
  );
}

export function useMobile() {
  const context = useContext(MobileContext);
  if (context === undefined) {
    throw new Error('useMobile must be used within a MobileProvider');
  }
  return context;
}

================
File: src/lib/db/indexedDB.ts
================
'use client';

import { getEnvBoolean } from '@/lib/utils/config';
import { generateSessionName } from '@/components/features/Exercise/utils';
import { openDB, IDBPDatabase } from 'idb';
import { Session } from "@/lib/types/Session";
import { Round } from "@/lib/types/Round";
import { Command } from "@/lib/types/Command";
import { Value, CompletedSession, Categories } from "@/lib/types";
const isBrowser = typeof window !== 'undefined';
const dbName = 'coreValuesData';
const dbVersion = 3;
const storeNames = {
  sessions: 'sessions',
  rounds: 'rounds',
  completedSessions: 'completedSessions'
};
const debug = getEnvBoolean('debug', false);

// Database initialization
export async function initDB(): Promise<IDBPDatabase> {
  if (debug) console.log('🔵 Initializing IndexedDB');
  try {
    const db = await openDB(dbName, dbVersion, {
      upgrade(db, oldVersion, newVersion) {
        if (debug) console.log('🆙 Upgrading IndexedDB schema');

        // Create stores
        if (!db.objectStoreNames.contains(storeNames.sessions)) {
          db.createObjectStore(storeNames.sessions, {
            keyPath: 'id'
          });
        }

        // Handle rounds store
        if (!db.objectStoreNames.contains(storeNames.rounds)) {
          // Create new store with index
          const store = db.createObjectStore(storeNames.rounds, {
            keyPath: ['sessionId', 'roundNumber']
          });
          try {
            store.createIndex('sessionId', 'sessionId');
          } catch (e) {
            console.warn('Failed to create index:', e);
          }
        }
        if (!db.objectStoreNames.contains(storeNames.completedSessions)) {
          db.createObjectStore(storeNames.completedSessions, {
            keyPath: 'sessionId'
          }); // Single string, not array
        }
      }
    });
    if (debug) console.log('✅ IndexedDB initialized successfully');
    return db;
  } catch (error) {
    console.error('❌ Error initializing IndexedDB:', error);
    throw error;
  }
}

// Session operations
export async function getSession(sessionId: string): Promise<Session | undefined> {
  if (debug) console.log('🔍 Fetching session:', sessionId);
  try {
    const db = await initDB();
    const session = await db.get(storeNames.sessions, sessionId);
    if (debug) console.log('✅ Session fetched successfully:', session);
    return session;
  } catch (error) {
    console.error('❌ Error fetching session:', error);
    throw error;
  }
}

export async function addSession(session: Omit<Session, 'id'>, initialCategories: Categories): Promise<string> {
  if (debug) console.log('💾 Saving session:', session);
  try {
    const db = await initDB();
    const sessionId = await generateSessionName(db);
    
    // Start a transaction that includes both stores
    const tx = db.transaction([storeNames.sessions, storeNames.rounds], 'readwrite');
    
    // Save the session
    await tx.objectStore(storeNames.sessions).put({
      ...session,
      id: sessionId
    });

    // Create initial round
    const initialRound: Round = {
      sessionId,
      roundNumber: 1,
      commands: [],
      availableCategories : initialCategories,
      timestamp: Date.now()
    };

    // Save the initial round
    await tx.objectStore(storeNames.rounds).add(initialRound);

    // Wait for the transaction to complete
    await tx.done;

    if (debug) console.log('✅ Session and initial round saved successfully');
    return sessionId;
  } catch (error) {
    console.error('❌ Error saving session:', error);
    throw error;
  }
}
export async function getSessions(): Promise<Session[]> {
  if (debug) console.log('🔍 Fetching all sessions');
  try {
    const db = await initDB();
    const sessions = await db.getAll(storeNames.sessions);
    if (debug) console.log('✅ Sessions fetched successfully:', sessions);
    return sessions;
  } catch (error) {
    console.error('❌ Error fetching sessions:', error);
    throw error;
  }
}
export async function updateSession(sessionId: string, updates: Partial<Session>) {
  if (debug) console.log('🔄 Updating session:', {
    sessionId,
    updates
  });
  try {
    const db = await initDB();
    const tx = db.transaction(storeNames.sessions, 'readwrite');
    const store = tx.objectStore(storeNames.sessions);
    const session = await store.get(sessionId);
    if (session) {
      await store.put({
        ...session,
        ...updates
      });
      if (debug) console.log('✅ Session updated successfully');
    }
    await tx.done;
  } catch (error) {
    console.error('❌ Error updating session:', error);
    throw error;
  }
}

// Round operations
export async function saveRound(sessionId: string, roundNumber: number, commands: Command[], availableCategories: Categories // Add this parameter
): Promise<void> {
  if (debug) console.log('💾 Saving round:', {
    sessionId,
    roundNumber,
    commands
  });
  try {
    if (!sessionId) return;
    const db = await initDB();
    const existingRound = await db.get(storeNames.rounds, [sessionId, roundNumber]);
    const round: Round = {
      sessionId,
      roundNumber,
      commands,
      availableCategories,
      timestamp: Date.now()
    };
    if (existingRound) {
      if (debug) console.log('🔄 Updating existing round');
      await db.put(storeNames.rounds, {
        ...existingRound,
        commands: round.commands,
        availableCategories: round.availableCategories,
        timestamp: round.timestamp
      });
    } else {
      if (debug) console.log('➕ Creating new round');
      await db.add(storeNames.rounds, round);
    }
    if (debug) console.log('✅ Round saved successfully');
  } catch (error) {
    console.error('❌ Error saving round:', error);
    throw error;
  }
}
export async function getRound(sessionId: string, roundNumber: number): Promise<Round | undefined> {
  if (debug) console.log('🔍 Fetching round:', {
    sessionId,
    roundNumber
  });
  try {
    const db = await initDB();
    const round = await db.get(storeNames.rounds, [sessionId, roundNumber]);
    if (debug) console.log('✅ Round fetched successfully:', round);
    return round;
  } catch (error) {
    console.error('❌ Error fetching round:', error);
    throw error;
  }
}
export async function getRoundsBySession(sessionId: string): Promise<Round[]> {
  if (debug) console.log('🔍 Fetching all rounds for session:', sessionId);
  try {
    const db = await initDB();
    const rounds = await db.getAllFromIndex(storeNames.rounds, 'sessionId', sessionId);
    if (debug) console.log('✅ Rounds fetched successfully:', rounds);
    return rounds;
  } catch (error) {
    console.error('❌ Error fetching rounds:', error);
    throw error;
  }
}

// Completed sessions operations
export async function saveCompletedSession(sessionId: string, finalValues: Value[]) {
  if (debug) console.log('💾 Saving completed session:', {
    sessionId,
    valuesCount: finalValues.length
  });
  try {
    const db = await initDB();
    await db.put(storeNames.completedSessions, {
      sessionId,
      // This needs to be included since it's the keyPath
      finalValues,
      timestamp: Date.now()
    }); // No need for second argument since sessionId is in the object as keyPath
    if (debug) console.log('✅ Completed session saved successfully');
  } catch (error) {
    console.error('❌ Error saving completed session:', error);
    throw error;
  }
}
export async function getCompletedSession(sessionId: string): Promise<CompletedSession | undefined> {
  if (debug) console.log('🔍 Fetching completed session:', sessionId);
  try {
    const db = await initDB();
    const completedSession = await db.get(storeNames.completedSessions, sessionId);
    if (debug) console.log('✅ Completed session fetched successfully:', completedSession);
    return completedSession;
  } catch (error) {
    console.error('❌ Error fetching completed session:', error);
    throw error;
  }
}

export const deleteSession = async (sessionId: string): Promise<void> => {
  if (debug) console.log('🗑️ Deleting session and associated rounds:', sessionId);
  try {
    const db = await initDB();
    
    // Start a transaction that includes both stores
    const tx = db.transaction([storeNames.sessions, storeNames.rounds, storeNames.completedSessions], 'readwrite');
    
    // Delete the session
    await tx.objectStore(storeNames.sessions).delete(sessionId);
    await tx.objectStore(storeNames.completedSessions).delete(sessionId);
    // Delete all rounds for this session using the index
    const roundsStore = tx.objectStore(storeNames.rounds);
    const sessionRoundsIndex = roundsStore.index('sessionId');
    const roundsToDelete = await sessionRoundsIndex.getAllKeys(sessionId);
    
    // Delete each round
    for (const roundKey of roundsToDelete) {
      await roundsStore.delete(roundKey);
    }

    // Wait for the transaction to complete
    await tx.done;

    if (debug) console.log('✅ Successfully deleted session and rounds');
  } catch (error) {
    console.error('❌ Error deleting session and rounds:', error);
    throw error;
  }
};

================
File: src/lib/hooks/useAnimation.ts
================
import { useEffect, useState } from 'react';
import { useMotionValue, useSpring, MotionValue } from 'framer-motion';
import { Position,AnimationConfig } from "@/lib/types";

export const useAnimation = (initialPosition: Position, config: AnimationConfig = {}) => {
  const x = useMotionValue(initialPosition.x);
  const y = useMotionValue(initialPosition.y);
  const springX = useSpring(x, {
    stiffness: config.stiffness ?? 300,
    damping: config.damping ?? 30,
    mass: config.mass ?? 1
  });
  const springY = useSpring(y, {
    stiffness: config.stiffness ?? 300,
    damping: config.damping ?? 30,
    mass: config.mass ?? 1
  });
  return {
    x: springX,
    y: springY
  };
};

================
File: src/lib/hooks/usePWA.ts
================
'use client';

import { useState, useEffect } from 'react';
import { PWAStatus } from "@/lib/types";

export function usePWA() {
  const [status, setStatus] = useState<PWAStatus>({
    needsUpdate: false,
    isOffline: false // Default to false, will update in useEffect
  });

  useEffect(() => {
    // Update initial offline status
    setStatus(prev => ({
      ...prev,
      isOffline: !window.navigator.onLine
    }));

    const handleStatusChange = () => {
      setStatus(prevStatus => ({
        ...prevStatus,
        isOffline: !window.navigator.onLine
      }));
    };

    window.addEventListener('online', handleStatusChange);
    window.addEventListener('offline', handleStatusChange);

    return () => {
      window.removeEventListener('online', handleStatusChange);
      window.removeEventListener('offline', handleStatusChange);
    };
  }, []);

  useEffect(() => {
    if (typeof window !== 'undefined' && 'serviceWorker' in window.navigator) {
      window.navigator.serviceWorker.ready.then(registration => {
        registration.addEventListener('controllerchange', () => {
          setStatus(prevStatus => ({
            ...prevStatus,
            needsUpdate: true
          }));
        });
      });
    }
  }, []);

  const updateServiceWorker = async () => {
    if (typeof window !== 'undefined' && 'serviceWorker' in window.navigator) {
      const registration = await window.navigator.serviceWorker.ready;
      await registration.update();
      setStatus(prevStatus => ({
        ...prevStatus,
        needsUpdate: false
      }));
      window.location.reload();
    }
  };

  return {
    ...status,
    updateServiceWorker
  };
}

================
File: src/lib/store/store.ts
================
'use client';

import { createWithEqualityFn } from 'zustand/traditional';
import { devtools } from 'zustand/middleware';
import { emptyCategories } from "@/components/features/Categories/constants/categories";
import { saveRound } from "@/lib/db/indexedDB";
import { StoreState } from "@/lib/types";
import { shallow } from 'zustand/shallow';
import { SessionData } from '../types/StoreState';

export const useStore = createWithEqualityFn<StoreState>()(devtools((set, get) => ({
  // Initial state
  sessionId: '',
  roundNumber: 1,
  targetCoreValues: 10,
  remainingCards: [],
  categories: emptyCategories,
  isGameStarted: false,
  showInstructions: false,
  commands: [],
  currentRound: null,
  currentRoundCommands: [],
  // Session methods
  setSession: (session: SessionData) => set({
    sessionId: session.sessionId,
    targetCoreValues: session.targetCoreValues,
    roundNumber: session.roundNumber
  }),
  setSessionId: id => set({
    sessionId: id
  }),
  setRoundNumber: round => set({
    roundNumber: round
  }),
  setTargetCoreValues: count => set({
    targetCoreValues: count
  }),
  clearSession: () => set({
    sessionId: '',
    targetCoreValues: 10,
    roundNumber: 1
  }),
  // Game methods
  setRemainingCards: cards => set({
    remainingCards: cards
  }),
  setCategories: categories => set({
    categories
  }),
  setGameStarted: started => set({
    isGameStarted: started
  }),
  setShowInstructions: show => set({
    showInstructions: show
  }),
  resetGame: () => set({
    roundNumber: 1,
    remainingCards: [],
    categories: emptyCategories,
    isGameStarted: false,
    showInstructions: false,
    commands: [],
    currentRound: null,
    currentRoundCommands: []
  }),
  // Command methods
  addCommand: async command => {
    set(state => ({
      commands: [...state.commands, command],
      currentRoundCommands: [...state.currentRoundCommands, command]
    }));
    const {
      currentRound,
      commands
    } = get();
    if (currentRound) {
      await saveRound(currentRound.sessionId, currentRound.roundNumber, commands, currentRound.availableCategories);
    }
  },
  clearCommands: () => set({
    commands: [],
    currentRoundCommands: []
  })
}), {
  name: 'Game Store'
}), shallow);

================
File: src/lib/types/Animation.ts
================
// src/lib/types/Animation.ts
import { MotionValue } from 'framer-motion';
import { Position } from './Position';

export interface AnimationConfig {
  stiffness?: number;
  damping?: number;
  mass?: number;
  duration?: number;
}

================
File: src/lib/types/BaseCommand.ts
================
import { Position } from './Position';

export interface BaseCommand {
  sourcePosition?: Position;
  targetPosition?: Position;
}

================
File: src/lib/types/Categories.ts
================
import { Value } from "./Value";
import { CategoryName } from "./CategoryName";

// In src/types/Categories.ts
export interface Categories {
  'Very Important': Value[];
  'Not Important': Value[];
  'Quite Important'?: Value[];
  'Important'?: Value[];
  'Of Some Importance'?: Value[];
  [key: string]: Value[] | undefined;  // Add index signature
}
// These types can be used for type checking in specific rounds
export type Round1And2Categories = Required<Categories>;

export type Round3Categories = Required<Omit<Categories, 'Of Some Importance'>>;

export type Round4Categories = Pick<Categories, 'Very Important' | 'Not Important'>;

================
File: src/lib/types/Category.ts
================
export enum Category {
    VERY_IMPORTANT = "Very Important",
    QUITE_IMPORTANT = "Quite Important",
    IMPORTANT = "Important",
    OF_SOME_IMPORTANCE = "Of Some Importance",
    NOT_IMPORTANT = "Not Important"
}

================
File: src/lib/types/CategoryName.ts
================
export type CategoryName = 
  | "Very Important"
  | "Quite Important"
  | "Important"
  | "Of Some Importance"
  | "Not Important";

================
File: src/lib/types/Command.ts
================
import { Position } from './Position';

export interface Command {
    type: string;
    payload: unknown;
    timestamp: number;
    sourcePosition?: Position;
    targetPosition?: Position;
    setPositions(source?: Position, target?: Position): Command;
}

================
File: src/lib/types/CompletedSession.ts
================
import { Value } from './Value';

export interface ValueWithReason extends Value {
    reason?: string;
  }

export interface CompletedSession {
    sessionId: string;
    finalValues: ValueWithReason[];
    timestamp: number;
}

================
File: src/lib/types/Context.ts
================
// src/lib/types/Context.ts
export interface MobileContextType {
  isMobile: boolean;
}

================
File: src/lib/types/DropCommandPayload.ts
================
import { CategoryName } from "./CategoryName";
export interface DropCommandPayload {
    cardId: string;
    cardTitle: string; // Add this
    category: CategoryName;
}

================
File: src/lib/types/index.ts
================
// Animation related exports
export type { AnimationConfig } from './Animation';
export type { Position } from './Position';

// Context related exports
export type { MobileContextType } from './Context';

// PWA related exports
export type { PWAStatus } from './PWA';

// Session related exports
export type { ReconstructedState } from './Session';

// Store related exports
export type { StoreState } from './StoreState';

// Existing exports (keeping these as they are)
export type { CompletedSession, ValueWithReason } from './CompletedSession';
export type { Categories } from './Categories';
export type { Category } from './Category';
export type { CategoryName } from './CategoryName';
export type { Command } from './Command';
export type { DropCommandPayload } from './DropCommandPayload';
export type { MoveCommandPayload } from './MoveCommandPayload';
export type { Round } from './Round';
export type { Session } from './Session';
export type { SessionReconstruction } from './SessionReconstruction';
export type { Value } from './Value';

================
File: src/lib/types/MoveCommandPayload.ts
================
import { CategoryName } from "./CategoryName";

export interface MoveCommandPayload {
    cardId: string;
    cardTitle: string; // Add this
    fromCategory: CategoryName;
    toCategory: CategoryName;
    fromIndex?: number;
    toIndex?: number;
}

================
File: src/lib/types/Position.ts
================
export interface Position {
  x: number;
  y: number;
}

================
File: src/lib/types/PWA.ts
================
// src/lib/types/PWA.ts
export interface PWAStatus {
  needsUpdate: boolean;
  isOffline: boolean;
}

================
File: src/lib/types/Round.ts
================
import { Categories } from "./Categories";
import { Command } from "./Command";


export interface Round {
    sessionId: string;
    roundNumber: number;
    commands: Command[];
    availableCategories: Categories; // Add this to store the calculated categories for the round
    timestamp: number;
}

================
File: src/lib/types/serviceWorker.d.ts
================
// Extend the existing Window interface
interface Window {
  workbox: any;
}

// Define ServiceWorkerGlobalScope
interface ServiceWorkerGlobalScope extends WorkerGlobalScope {
  __WB_MANIFEST: any[];
  skipWaiting(): Promise<void>;
  clients: Clients;
}

================
File: src/lib/types/Session.ts
================
// src/types/Session.ts
import { Categories } from './Categories';
import { Value } from './Value';

export interface Session {
  id: string;
  timestamp: number;
  targetCoreValues: number;
  currentRound: number;
  completed: boolean;
  initialValues: Value[];
}

export interface ReconstructedState {
  categories: Categories;
  currentRound: number;
  remainingCards: Value[];
}

================
File: src/lib/types/SessionReconstruction.ts
================
import { Categories, Value } from "@/lib/types";
export interface SessionReconstruction {
  categories: Categories;
  currentRound: number;
  remainingCards: Value[];
}

================
File: src/lib/types/StoreState.ts
================
// src/lib/types/Store.ts
import { Categories, Value, Command, Round } from './index';

export interface SessionData {
  sessionId: string;
  targetCoreValues: number;
  roundNumber: number;
}
export interface StoreState {
  sessionId: string;
  roundNumber: number;
  targetCoreValues: number;
  remainingCards: Value[];
  categories: Categories;
  isGameStarted: boolean;
  showInstructions: boolean;
  commands: Command[];
  currentRound: Round | null;
  currentRoundCommands: Command[];
  
  setSession: (session: SessionData) => void;
  setSessionId: (id: string) => void;
  setRoundNumber: (round: number) => void;
  setTargetCoreValues: (count: number) => void;
  clearSession: () => void;
  setRemainingCards: (cards: Value[]) => void;
  setCategories: (categories: Categories) => void;
  setGameStarted: (started: boolean) => void;
  setShowInstructions: (show: boolean) => void;
  resetGame: () => void;
  addCommand: (command: Command) => Promise<void>;
  clearCommands: () => void;
}

================
File: src/lib/types/Value.ts
================
import { Category } from "./Category";


export type Value = {
    id: string;
    title: string;
    description: string;
    category?: Category;
};

================
File: src/lib/utils/animation/index.ts
================
export * from './transitions';
export * from './variants';

================
File: src/lib/utils/animation/transitions.ts
================
import { Transition } from "framer-motion";

export const springTransition: Transition = {
  type: "spring",
  stiffness: 300,
  damping: 30
};

export const easeTransition: Transition = {
  type: "tween",
  ease: "easeInOut",
  duration: 0.3
};

export const cardTransition: Transition = {
  type: "spring",
  stiffness: 500,
  damping: 35,
  mass: 1
};

================
File: src/lib/utils/animation/variants.ts
================
import { Variants } from "framer-motion";

export const cardVariants: Variants = {
  initial: { 
    scale: 1.0, 
    opacity: 0 
  },
  animate: { 
    scale: 1, 
    opacity: 1 
  },
  exit: { 
    scale: 1.0, 
    opacity: 0 
  },
  hover: { 
    scale: 1.00,
    transition: {
      duration: 0.2
    }
  }
};

export const categoryVariants: Variants = {
  initial: { 
    y: 20, 
    opacity: 0 
  },
  animate: { 
    y: 0, 
    opacity: 1 
  },
  exit: { 
    y: -20, 
    opacity: 0 
  }
};

================
File: src/lib/utils/cache/index.ts
================
// src/utils/cache.ts
export const forceReload = () => {
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistrations().then(function(registrations) {
        for(let registration of registrations) {
          registration.unregister();
        }
        window.location.reload();
      });
    } else {
      window.location.reload();
    }
  };

================
File: src/lib/utils/config/envUtils.ts
================
export function getEnvNumber(key: string, defaultValue: number): number {
  // In development, return default values
  if (process.env.NODE_ENV === 'development') {
    if (key === 'maxCards') {
      return 10;
    }
    if (key === 'numCoreValues') {
      return 5;
    }
    return defaultValue;
  }

  // In production, use environment variables
  const value = process.env[key];
  if (value === undefined) {
    return defaultValue;
  }
  
  const numberValue = Number(value);
  return isNaN(numberValue) ? defaultValue : numberValue;
}

export function getEnvBoolean(key: string, defaultValue: boolean): boolean {
  // In development, return default values
  if (process.env.NODE_ENV === 'development') {
    return defaultValue;
  }

  // In production, use environment variables
  const value = process.env[key];
  if (value === undefined) {
    return defaultValue;
  }
  
  return value.toLowerCase() === 'true';
}

================
File: src/lib/utils/config/gameConfig.ts
================
import { getEnvNumber } from './envUtils';

export const getGameConfig = () => ({
  maxCards: getEnvNumber('maxCards', 35),
  defaultCoreValues: getEnvNumber('numCoreValues', 5),
  minNotImportant: 1,  // Minimum cards that must be in Not Important
  ratioThresholds: {
    final: 1.5,     // Ratio for final round (2 categories)
    reduced: 2,     // Ratio for reduced categories (3 categories)
    standard: 3,    // Ratio for standard categories (4 categories)
    // Above standard ratio shows all categories
  }
});

export const validateGameConstraints = (
  activeCards: number,
  targetCoreValues: number,
  notImportantCount: number
) => {
  const config = getGameConfig();
  
  return {
    hasMinimumNotImportant: notImportantCount >= config.minNotImportant,
    hasEnoughCards: activeCards >= targetCoreValues,
    isTooManyCards: activeCards > config.maxCards
  };
};

================
File: src/lib/utils/config/index.ts
================
// Export all environment utilities
export * from './envUtils';

// Export all game configuration utilities
export * from './gameConfig';

================
File: src/lib/utils/debug/index.ts
================
const DEBUG = process.env.NODE_ENV === 'development';

export const logRender = (componentName: string, props?: any) => {
  if (DEBUG) {
    console.log(`[Render] ${componentName}`, props ? { props } : '');
  }
};

export const logStateUpdate = (name: string, value: any, source: string) => {
  if (DEBUG) {
    console.group(`[State Update] ${name}`);
    console.log('Value:', value);
    console.log('Source:', source);
    console.trace('Stack trace');
    console.groupEnd();
  }
};

export const logEffect = (effectName: string, dependencies?: any[]) => {
  if (DEBUG) {
    console.log(`[Effect] ${effectName}`, dependencies ? { dependencies } : '');
  }
};

================
File: src/lib/utils/dom/index.ts
================
import { Position } from "@/lib/types";
export const getElementCenter = (element: HTMLElement): Position => {
  const rect = element.getBoundingClientRect();
  return {
    x: rect.left + rect.width / 2,
    y: rect.top + rect.height / 2
  };
};
export const getCardPosition = (cardId: string): Position | undefined => {
  const element = document.getElementById(`card-${cardId}`);
  return element ? getElementCenter(element) : undefined;
};
export const getCategoryPosition = (categoryName: string): Position | undefined => {
  const element = document.getElementById(`category-${categoryName}`);
  return element ? getElementCenter(element) : undefined;
};

================
File: src/lib/utils/email/emailUtils.ts
================
import { Value, ValueWithReason } from "@/lib/types";
export function generateEmailContent(values: ValueWithReason[]): string {
  const emailSubject = 'My Core Values Results';
  const htmlContent = `
    <html>
      <body style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">
        <h1 style="color: #2563eb;">My Core Values</h1>
        <p>Here are my selected core values and their significance:</p>
        ${values.map(value => `
          <div style="margin-bottom: 20px; padding: 15px; background-color: #fef9c3; border-radius: 8px;">
            <h2 style="margin: 0; color: #1f2937; font-size: 18px;">${value.title}</h2>
            <p style="margin: 8px 0; color: #4b5563;">${value.description}</p>
            ${value.reason ? `
              <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #d1d5db;">
                <p style="margin: 0; font-style: italic; color: #4b5563;">
                  <strong>Why it's meaningful:</strong> ${value.reason}
                </p>
              </div>
            ` : ''}
          </div>
        `).join('')}
      </body>
    </html>
  `;

  // Remove any newlines and extra spaces to make the mailto link cleaner
  const cleanHtmlContent = htmlContent.replace(/\s+/g, ' ').trim();

  // Create the mailto link
  const mailtoLink = `mailto:?subject=${encodeURIComponent(emailSubject)}&body=${encodeURIComponent(cleanHtmlContent)}`;
  return mailtoLink;
}
export function shareViaEmail(values: Value[]) {
  const mailtoLink = generateEmailContent(values);
  window.location.href = mailtoLink;
}

================
File: src/lib/utils/index.ts
================
// Animation utilities
export * from './animation';

// Cache utilities
export * from './cache';

// Config utilities
export * from './config';

// DOM utilities
export * from './dom';

// Email utilities
export * from './email/emailUtils';

// Storage utilities
export * from './storage/cacheUtils';
export * from './storage/storeUtils';
export * from './storage';

export * from './debug';

// Note: Removed the default exports since the utilities aren't exported as defaults
// Instead, they're already being exported through their respective index files

================
File: src/lib/utils/storage/cacheUtils.ts
================
export const cacheUtils = {
  async getCachedData<T>(key: string): Promise<T | null> {
    try {
      const cache = await caches.open('core-values-dynamic-v1');
      const response = await cache.match(`/api/${key}`);
      if (response) {
        return response.json();
      }
      return null;
    } catch (error) {
      console.error('Error getting cached data:', error);
      return null;
    }
  },

  async setCachedData<T>(key: string, data: T): Promise<void> {
    try {
      const cache = await caches.open('core-values-dynamic-v1');
      const response = new Response(JSON.stringify(data));
      await cache.put(`/api/${key}`, response);
    } catch (error) {
      console.error('Error setting cached data:', error);
    }
  },

  async clearCache(): Promise<void> {
    try {
      const cache = await caches.open('core-values-dynamic-v1');
      await cache.keys().then(keys => {
        keys.forEach(key => {
          cache.delete(key);
        });
      });
    } catch (error) {
      console.error('Error clearing cache:', error);
    }
  }
};

================
File: src/lib/utils/storage/index.ts
================
import { cacheUtils } from './cacheUtils';
import { initializeGameState, clearGameState } from './storeUtils';

export {
    cacheUtils,
    initializeGameState,
    clearGameState
};

================
File: src/lib/utils/storage/storeUtils.ts
================
import { useStore } from "@/lib/store/store";
import { Value, Categories } from "@/lib/types";
import { emptyCategories } from "@/components/features/Categories/constants/categories";
export const initializeGameState = (sessionId: string, currentRound: number, targetCoreValues: number, initialCards: Value[], initialCategories: Categories = emptyCategories) => {
  const store = useStore.getState();

  // Session state
  store.setSession({
    sessionId,
    targetCoreValues,
    roundNumber: currentRound // updated from currentRound
  });

  // Game state
  store.setRemainingCards(initialCards);
  store.setCategories(initialCategories);
  store.setGameStarted(true);
  store.setShowInstructions(true);

  // Commands state
  store.clearCommands();
};
export const clearGameState = () => {
  const store = useStore.getState();

  // Clear all state
  store.setSession({
    sessionId: '',
    targetCoreValues: 10,
    roundNumber: 1 // updated from currentRound
  });
  store.resetGame();
  store.clearCommands();
};

================
File: src/lib/worker/index.ts
================
/// <reference lib="webworker" />
import { cacheNames, clientsClaim } from 'workbox-core'
import { ExpirationPlugin } from 'workbox-expiration'
import { NetworkFirst, StaleWhileRevalidate, CacheFirst } from 'workbox-strategies'
import { registerRoute } from 'workbox-routing'
import { CacheableResponsePlugin } from 'workbox-cacheable-response'

declare const self: ServiceWorkerGlobalScope

// Use the injected cache version from next.config.js
const CACHE_VERSION = process.env.CACHE_VERSION || Date.now().toString()

// Customize cache names with version
const customCacheNames = {
  runtime: `runtime-${CACHE_VERSION}`,
  static: `static-${CACHE_VERSION}`,
  image: `images-${CACHE_VERSION}`,
  api: `api-${CACHE_VERSION}`
}

clientsClaim()

// Cache static assets
registerRoute(
  ({ request }) => request.destination === 'style' || 
                   request.destination === 'script' || 
                   request.destination === 'worker',
  new StaleWhileRevalidate({
    cacheName: customCacheNames.static,
    plugins: [
      new CacheableResponsePlugin({
        statuses: [0, 200]
      })
    ]
  })
)

// Cache images
registerRoute(
  ({ request }) => request.destination === 'image',
  new CacheFirst({
    cacheName: customCacheNames.image,
    plugins: [
      new CacheableResponsePlugin({
        statuses: [0, 200]
      }),
      new ExpirationPlugin({
        maxEntries: 60,
        maxAgeSeconds: 30 * 24 * 60 * 60 // 30 days
      })
    ]
  })
)

// Cache API requests
registerRoute(
  ({ url }) => url.pathname.startsWith('/api/'),
  new NetworkFirst({
    cacheName: customCacheNames.api,
    plugins: [
      new CacheableResponsePlugin({
        statuses: [0, 200]
      }),
      new ExpirationPlugin({
        maxEntries: 50,
        maxAgeSeconds: 5 * 60 // 5 minutes
      })
    ]
  })
)

// Clean up old caches
self.addEventListener('activate', (event: ExtendableEvent) => {
  event.waitUntil(
    caches.keys().then((cacheNames) => {
      return Promise.all(
        cacheNames.map((cacheName) => {
          // Delete old versioned caches
          if (!Object.values(customCacheNames).includes(cacheName)) {
            return caches.delete(cacheName)
          }
          return Promise.resolve()
        })
      )
    })
  )
})

// Ensure TypeScript treats this as a module
export {}

================
File: src/styles/globals.css
================
@tailwind base;
@tailwind components;
@tailwind utilities;
:root {
  /* High contrast background/text combinations */
  --background-primary: #ffffff;
  --text-primary: #1a1a1a;     /* Contrast ratio: 14.5:1 */
  --text-secondary: #2d2d2d;   /* Contrast ratio: 11.1:1 */
  
  /* Button colors that meet AAA compliance */
  --button-primary: #005ab3;    /* For blue buttons */
  --button-text: #ffffff;       /* Contrast ratio: 8.1:1 with button-primary */
  
  /* Accent colors that meet AAA compliance */
  --accent-primary: #006e4a;    /* For success/positive states */
  --accent-warning: #944a00;    /* For warning states */
  --accent-error: #ab0000;      /* For error states */
  
  /* Link colors */
  --link-color: #0051a3;        /* Contrast ratio: 7.3:1 against white */
  --link-hover: #003b7a;        /* Darker shade for hover states */
}

/* Base styles */
@layer base {
  /* Optimize text rendering */
  body {
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
  }
  
  /* Ensure text remains visible during webfont load */
  h1, p {
    font-display: swap;
  }
}

/* Background with a diagonal gradient */
/* body {
  background-color: var(--background-primary);
  color: var(--text-primary);
  line-height: 1.5;
} */

body {
  background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
  color: var(--text-primary);
  background-size: cover;
  background-repeat: no-repeat;
  background-attachment: fixed;
  line-height: 1.5;
}

/* Ensure all interactive elements have sufficient contrast */
button, 
.button {
  background-color: var(--button-primary);
  color: var(--button-text);
  padding: 0.5rem 1rem;
  border-radius: 0.25rem;
  font-weight: 500;
}

button:hover,
.button:hover {
  background-color: #004890;
}

/* Links */
a {
  color: var(--link-color);
  text-decoration: underline;
}

a:hover {
  color: var(--link-hover);
}

/* Form elements */
input, 
textarea, 
select {
  border: 2px solid var(--text-secondary);
  color: var(--text-primary);
  background-color: var(--background-primary);
  padding: 0.5rem;
}

/* Status messages */
.error {
  color: var(--accent-error);
}

.warning {
  color: var(--accent-warning);
}

.success {
  color: var(--accent-primary);
}

/* Focus styles for accessibility */
*:focus {
  outline: 3px solid var(--button-primary);
  outline-offset: 2px;
}

/* Large text styles */
h1, h2, h3, h4, h5, h6 {
  color: var(--text-primary);
  font-weight: bold;
  line-height: 1.2;
}

/* Helper classes for text contrast */
.text-high-contrast {
  color: var(--text-primary);
}

.text-secondary {
  color: var(--text-secondary);
}

/* Tailwind utility classes */
.card {
  @apply transition-all duration-200 ease-in-out;
}

.card:hover {
  @apply shadow-md;
}

.category-column {
  @apply transition-colors duration-200 ease-in-out;
}

@media print {
  /* Remove any background images/effects from post-it notes */
  [class*="postit-"] {
    background-image: none !important;
    transform: none !important;
    box-shadow: none !important;
  }

  /* Ensure text is black for printing */
  * {
    color: black !important;
  }

  /* Hide unnecessary elements when printing */
  .print:hidden {
    display: none !important;
  }
}

================
File: tailwind.config.ts
================
import type { Config } from 'tailwindcss'

const config: Config = {
  content: [
    './src/pages/**/*.{js,ts,jsx,tsx,mdx}',
    './src/components/**/*.{js,ts,jsx,tsx,mdx}',
    './src/app/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    extend: {
      colors: {
        'theme-blue': '#1d4ed8',
        // AAA-compliant colors
        primary: {
          bg: '#ffffff',
          text: '#1a1a1a',    // 14.5:1 contrast ratio
          button: '#005ab3',  // 8.1:1 contrast ratio with white
        },
        secondary: {
          text: '#2d2d2d',    // 11.1:1 contrast ratio
          button: '#004890',  // Button hover state
        },
        accent: {
          success: '#006e4a',
          warning: '#944a00',
          error: '#ab0000',
        },
        link: {
          DEFAULT: '#0051a3', // 7.3:1 contrast ratio
          hover: '#003b7a',
        },
      },
      fontFamily: {
        'handwritten': ['var(--font-kalam)']
      },
      rotate: {
        '1': '1deg',
      },
    },
  },
  variants: {
    extend: {
      transform: ['hover', 'print'],
      translate: ['hover', 'print'],
      backgroundColor: ['print'],
      borderWidth: ['print'],
      borderColor: ['print'],
      textColor: ['print'],
    },
  },
  plugins: [],
  darkMode: 'class',
  prefix: '',
  important: false,
}

export default config

================
File: tests/components/Card.test.tsx
================
// in Card.test.tsx
import { createMockValue, resetMockIdCounter } from '../utils/mockData';

describe('Card Component', () => {
  beforeEach(() => {
    resetMockIdCounter(); // Optional: reset ID counter before each test
  });

  it('renders card content correctly', () => {
    const testValue = createMockValue({
      title: 'Test Title',
      description: 'Test Description'
    });
    // testValue.id will be 1
    // ... rest of the test
  });

  it('other test case', () => {
    const testValue = createMockValue({
      title: 'Another Title',
      description: 'Another Description'
    });
    // testValue.id will be 2
    // ... rest of the test
  });

  it('can override id if needed', () => {
    const testValue = createMockValue({
      id: 35,
      title: 'Specific ID Test',
      description: 'Test Description'
    });
    // testValue.id will be 35
  });
});

================
File: tests/lighthouse/localhost_3000-20241207T170739.json
================
{
  "lighthouseVersion": "12.2.1",
  "requestedUrl": "http://localhost:3000/",
  "mainDocumentUrl": "http://localhost:3000/",
  "finalDisplayedUrl": "http://localhost:3000/",
  "finalUrl": "http://localhost:3000/",
  "fetchTime": "2024-12-07T17:07:39.370Z",
  "gatherMode": "navigation",
  "runWarnings": [
    "There may be stored data affecting loading performance in this location: IndexedDB. Audit this page in an incognito window to prevent those resources from affecting your scores."
  ],
  "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36 Edg/131.0.0.0",
  "environment": {
    "networkUserAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36",
    "hostUserAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36 Edg/131.0.0.0",
    "benchmarkIndex": 2206.5,
    "credits": {
      "axe-core": "4.10.0"
    }
  },
  "audits": {
    "accesskeys": {
      "id": "accesskeys",
      "title": "`[accesskey]` values are unique",
      "description": "Access keys let users quickly focus a part of the page. For proper navigation, each access key must be unique. [Learn more about access keys](https://dequeuniversity.com/rules/axe/4.10/accesskeys).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "aria-allowed-attr": {
      "id": "aria-allowed-attr",
      "title": "`[aria-*]` attributes match their roles",
      "description": "Each ARIA `role` supports a specific subset of `aria-*` attributes. Mismatching these invalidates the `aria-*` attributes. [Learn how to match ARIA attributes to their roles](https://dequeuniversity.com/rules/axe/4.10/aria-allowed-attr).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "aria-allowed-role": {
      "id": "aria-allowed-role",
      "title": "Uses ARIA roles only on compatible elements",
      "description": "Many HTML elements can only be assigned certain ARIA roles. Using ARIA roles where they are not allowed can interfere with the accessibility of the web page. [Learn more about ARIA roles](https://dequeuniversity.com/rules/axe/4.10/aria-allowed-role).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "aria-command-name": {
      "id": "aria-command-name",
      "title": "`button`, `link`, and `menuitem` elements have accessible names",
      "description": "When an element doesn't have an accessible name, screen readers announce it with a generic name, making it unusable for users who rely on screen readers. [Learn how to make command elements more accessible](https://dequeuniversity.com/rules/axe/4.10/aria-command-name).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "aria-conditional-attr": {
      "id": "aria-conditional-attr",
      "title": "ARIA attributes are used as specified for the element's role",
      "description": "Some ARIA attributes are only allowed on an element under certain conditions. [Learn more about conditional ARIA attributes](https://dequeuniversity.com/rules/axe/4.10/aria-conditional-attr).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "aria-deprecated-role": {
      "id": "aria-deprecated-role",
      "title": "Deprecated ARIA roles were not used",
      "description": "Deprecated ARIA roles may not be processed correctly by assistive technology. [Learn more about deprecated ARIA roles](https://dequeuniversity.com/rules/axe/4.10/aria-deprecated-role).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "aria-dialog-name": {
      "id": "aria-dialog-name",
      "title": "Elements with `role=\"dialog\"` or `role=\"alertdialog\"` have accessible names.",
      "description": "ARIA dialog elements without accessible names may prevent screen readers users from discerning the purpose of these elements. [Learn how to make ARIA dialog elements more accessible](https://dequeuniversity.com/rules/axe/4.10/aria-dialog-name).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "aria-hidden-body": {
      "id": "aria-hidden-body",
      "title": "`[aria-hidden=\"true\"]` is not present on the document `<body>`",
      "description": "Assistive technologies, like screen readers, work inconsistently when `aria-hidden=\"true\"` is set on the document `<body>`. [Learn how `aria-hidden` affects the document body](https://dequeuniversity.com/rules/axe/4.10/aria-hidden-body).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "aria-hidden-focus": {
      "id": "aria-hidden-focus",
      "title": "`[aria-hidden=\"true\"]` elements do not contain focusable descendents",
      "description": "Focusable descendents within an `[aria-hidden=\"true\"]` element prevent those interactive elements from being available to users of assistive technologies like screen readers. [Learn how `aria-hidden` affects focusable elements](https://dequeuniversity.com/rules/axe/4.10/aria-hidden-focus).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "aria-input-field-name": {
      "id": "aria-input-field-name",
      "title": "ARIA input fields have accessible names",
      "description": "When an input field doesn't have an accessible name, screen readers announce it with a generic name, making it unusable for users who rely on screen readers. [Learn more about input field labels](https://dequeuniversity.com/rules/axe/4.10/aria-input-field-name).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "aria-meter-name": {
      "id": "aria-meter-name",
      "title": "ARIA `meter` elements have accessible names",
      "description": "When a meter element doesn't have an accessible name, screen readers announce it with a generic name, making it unusable for users who rely on screen readers. [Learn how to name `meter` elements](https://dequeuniversity.com/rules/axe/4.10/aria-meter-name).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "aria-progressbar-name": {
      "id": "aria-progressbar-name",
      "title": "ARIA `progressbar` elements have accessible names",
      "description": "When a `progressbar` element doesn't have an accessible name, screen readers announce it with a generic name, making it unusable for users who rely on screen readers. [Learn how to label `progressbar` elements](https://dequeuniversity.com/rules/axe/4.10/aria-progressbar-name).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "aria-prohibited-attr": {
      "id": "aria-prohibited-attr",
      "title": "Elements use only permitted ARIA attributes",
      "description": "Using ARIA attributes in roles where they are prohibited can mean that important information is not communicated to users of assistive technologies. [Learn more about prohibited ARIA roles](https://dequeuniversity.com/rules/axe/4.10/aria-prohibited-attr).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "aria-required-attr": {
      "id": "aria-required-attr",
      "title": "`[role]`s have all required `[aria-*]` attributes",
      "description": "Some ARIA roles have required attributes that describe the state of the element to screen readers. [Learn more about roles and required attributes](https://dequeuniversity.com/rules/axe/4.10/aria-required-attr).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "aria-required-children": {
      "id": "aria-required-children",
      "title": "Elements with an ARIA `[role]` that require children to contain a specific `[role]` have all required children.",
      "description": "Some ARIA parent roles must contain specific child roles to perform their intended accessibility functions. [Learn more about roles and required children elements](https://dequeuniversity.com/rules/axe/4.10/aria-required-children).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "aria-required-parent": {
      "id": "aria-required-parent",
      "title": "`[role]`s are contained by their required parent element",
      "description": "Some ARIA child roles must be contained by specific parent roles to properly perform their intended accessibility functions. [Learn more about ARIA roles and required parent element](https://dequeuniversity.com/rules/axe/4.10/aria-required-parent).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "aria-roles": {
      "id": "aria-roles",
      "title": "`[role]` values are valid",
      "description": "ARIA roles must have valid values in order to perform their intended accessibility functions. [Learn more about valid ARIA roles](https://dequeuniversity.com/rules/axe/4.10/aria-roles).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "aria-text": {
      "id": "aria-text",
      "title": "Elements with the `role=text` attribute do not have focusable descendents.",
      "description": "Adding `role=text` around a text node split by markup enables VoiceOver to treat it as one phrase, but the element's focusable descendents will not be announced. [Learn more about the `role=text` attribute](https://dequeuniversity.com/rules/axe/4.10/aria-text).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "aria-toggle-field-name": {
      "id": "aria-toggle-field-name",
      "title": "ARIA toggle fields have accessible names",
      "description": "When a toggle field doesn't have an accessible name, screen readers announce it with a generic name, making it unusable for users who rely on screen readers. [Learn more about toggle fields](https://dequeuniversity.com/rules/axe/4.10/aria-toggle-field-name).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "aria-tooltip-name": {
      "id": "aria-tooltip-name",
      "title": "ARIA `tooltip` elements have accessible names",
      "description": "When a tooltip element doesn't have an accessible name, screen readers announce it with a generic name, making it unusable for users who rely on screen readers. [Learn how to name `tooltip` elements](https://dequeuniversity.com/rules/axe/4.10/aria-tooltip-name).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "aria-treeitem-name": {
      "id": "aria-treeitem-name",
      "title": "ARIA `treeitem` elements have accessible names",
      "description": "When a `treeitem` element doesn't have an accessible name, screen readers announce it with a generic name, making it unusable for users who rely on screen readers. [Learn more about labeling `treeitem` elements](https://dequeuniversity.com/rules/axe/4.10/aria-treeitem-name).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "aria-valid-attr-value": {
      "id": "aria-valid-attr-value",
      "title": "`[aria-*]` attributes have valid values",
      "description": "Assistive technologies, like screen readers, can't interpret ARIA attributes with invalid values. [Learn more about valid values for ARIA attributes](https://dequeuniversity.com/rules/axe/4.10/aria-valid-attr-value).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "aria-valid-attr": {
      "id": "aria-valid-attr",
      "title": "`[aria-*]` attributes are valid and not misspelled",
      "description": "Assistive technologies, like screen readers, can't interpret ARIA attributes with invalid names. [Learn more about valid ARIA attributes](https://dequeuniversity.com/rules/axe/4.10/aria-valid-attr).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "button-name": {
      "id": "button-name",
      "title": "Buttons have an accessible name",
      "description": "When a button doesn't have an accessible name, screen readers announce it as \"button\", making it unusable for users who rely on screen readers. [Learn how to make buttons more accessible](https://dequeuniversity.com/rules/axe/4.10/button-name).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "bypass": {
      "id": "bypass",
      "title": "The page contains a heading, skip link, or landmark region",
      "description": "Adding ways to bypass repetitive content lets keyboard users navigate the page more efficiently. [Learn more about bypass blocks](https://dequeuniversity.com/rules/axe/4.10/bypass).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "color-contrast": {
      "id": "color-contrast",
      "title": "Background and foreground colors do not have a sufficient contrast ratio.",
      "description": "Low-contrast text is difficult or impossible for many users to read. [Learn how to provide sufficient color contrast](https://dequeuniversity.com/rules/axe/4.10/color-contrast).",
      "score": 0,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [
          {
            "key": "node",
            "valueType": "node",
            "subItemsHeading": {
              "key": "relatedNode",
              "valueType": "node"
            },
            "label": "Failing Elements"
          }
        ],
        "items": [
          {
            "node": {
              "type": "node",
              "lhId": "1-0-A",
              "path": "1,HTML,1,BODY,0,DIV,0,HEADER,0,DIV,0,NAV,1,DIV,1,A",
              "selector": "div.max-w-7xl > nav.flex > div.hidden > a.text-white",
              "boundingRect": {
                "top": 8,
                "bottom": 52,
                "left": 1236,
                "right": 1317,
                "width": 81,
                "height": 44
              },
              "snippet": "<a class=\"text-white hover:bg-white/20 rounded-md transition-colors text-lg px-4 py-2\" role=\"menuitem\" href=\"/about\">",
              "nodeLabel": "About",
              "explanation": "Fix any of the following:\n  Element has insufficient color contrast of 3.67 (foreground color: #ffffff, background color: #3b82f6, font size: 13.5pt (18px), font weight: normal). Expected contrast ratio of 4.5:1"
            },
            "subItems": {
              "type": "subitems",
              "items": [
                {
                  "relatedNode": {
                    "type": "node",
                    "lhId": "1-1-HEADER",
                    "path": "1,HTML,1,BODY,0,DIV,0,HEADER",
                    "selector": "body.bg-gray-50 > div.min-h-screen > header.bg-blue-700",
                    "boundingRect": {
                      "top": 0,
                      "bottom": 60,
                      "left": 0,
                      "right": 1659,
                      "width": 1659,
                      "height": 60
                    },
                    "snippet": "<header class=\"bg-blue-700 text-white shadow-md flex-shrink-0\" role=\"banner\" aria-label=\"Site header\">",
                    "nodeLabel": "Core Values\nHome\nAbout\nHistory"
                  }
                }
              ]
            }
          },
          {
            "node": {
              "type": "node",
              "lhId": "1-2-A",
              "path": "1,HTML,1,BODY,0,DIV,0,HEADER,0,DIV,0,NAV,1,DIV,2,A",
              "selector": "div.max-w-7xl > nav.flex > div.hidden > a.text-white",
              "boundingRect": {
                "top": 8,
                "bottom": 52,
                "left": 1333,
                "right": 1422,
                "width": 88,
                "height": 44
              },
              "snippet": "<a class=\"text-white hover:bg-white/20 rounded-md transition-colors text-lg px-4 py-2\" role=\"menuitem\" href=\"/history\">",
              "nodeLabel": "History",
              "explanation": "Fix any of the following:\n  Element has insufficient color contrast of 3.67 (foreground color: #ffffff, background color: #3b82f6, font size: 13.5pt (18px), font weight: normal). Expected contrast ratio of 4.5:1"
            },
            "subItems": {
              "type": "subitems",
              "items": [
                {
                  "relatedNode": {
                    "type": "node",
                    "lhId": "1-1-HEADER",
                    "path": "1,HTML,1,BODY,0,DIV,0,HEADER",
                    "selector": "body.bg-gray-50 > div.min-h-screen > header.bg-blue-700",
                    "boundingRect": {
                      "top": 0,
                      "bottom": 60,
                      "left": 0,
                      "right": 1659,
                      "width": 1659,
                      "height": 60
                    },
                    "snippet": "<header class=\"bg-blue-700 text-white shadow-md flex-shrink-0\" role=\"banner\" aria-label=\"Site header\">",
                    "nodeLabel": "Core Values\nHome\nAbout\nHistory"
                  }
                }
              ]
            }
          },
          {
            "node": {
              "type": "node",
              "lhId": "1-3-P",
              "path": "1,HTML,1,BODY,0,DIV,2,FOOTER,0,DIV,0,P",
              "selector": "div.min-h-screen > footer.bg-blue-700 > div.max-w-7xl > p.text-center",
              "boundingRect": {
                "top": 1328,
                "bottom": 1348,
                "left": 222,
                "right": 1438,
                "width": 1216,
                "height": 20
              },
              "snippet": "<p class=\"text-center text-white text-sm\">",
              "nodeLabel": "© 2024 Core Values App",
              "explanation": "Fix any of the following:\n  Element has insufficient color contrast of 3.28 (foreground color: #ebf3fe, background color: #3b82f6, font size: 10.5pt (14px), font weight: normal). Expected contrast ratio of 4.5:1"
            },
            "subItems": {
              "type": "subitems",
              "items": [
                {
                  "relatedNode": {
                    "type": "node",
                    "lhId": "1-4-FOOTER",
                    "path": "1,HTML,1,BODY,0,DIV,2,FOOTER",
                    "selector": "body.bg-gray-50 > div.min-h-screen > footer.bg-blue-700",
                    "boundingRect": {
                      "top": 1312,
                      "bottom": 1364,
                      "left": 0,
                      "right": 1659,
                      "width": 1659,
                      "height": 52
                    },
                    "snippet": "<footer class=\"bg-blue-700 text-white md:flex-shrink-0\" role=\"contentinfo\" aria-label=\"Site footer\">",
                    "nodeLabel": "© 2024 Core Values App"
                  }
                }
              ]
            }
          }
        ],
        "debugData": {
          "type": "debugdata",
          "impact": "serious",
          "tags": [
            "cat.color",
            "wcag2aa",
            "wcag143",
            "TTv5",
            "TT13.c",
            "EN-301-549",
            "EN-9.1.4.3",
            "ACT"
          ]
        }
      }
    },
    "definition-list": {
      "id": "definition-list",
      "title": "`<dl>`'s contain only properly-ordered `<dt>` and `<dd>` groups, `<script>`, `<template>` or `<div>` elements.",
      "description": "When definition lists are not properly marked up, screen readers may produce confusing or inaccurate output. [Learn how to structure definition lists correctly](https://dequeuniversity.com/rules/axe/4.10/definition-list).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "dlitem": {
      "id": "dlitem",
      "title": "Definition list items are wrapped in `<dl>` elements",
      "description": "Definition list items (`<dt>` and `<dd>`) must be wrapped in a parent `<dl>` element to ensure that screen readers can properly announce them. [Learn how to structure definition lists correctly](https://dequeuniversity.com/rules/axe/4.10/dlitem).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "document-title": {
      "id": "document-title",
      "title": "Document has a `<title>` element",
      "description": "The title gives screen reader users an overview of the page, and search engine users rely on it heavily to determine if a page is relevant to their search. [Learn more about document titles](https://dequeuniversity.com/rules/axe/4.10/document-title).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "duplicate-id-aria": {
      "id": "duplicate-id-aria",
      "title": "ARIA IDs are unique",
      "description": "The value of an ARIA ID must be unique to prevent other instances from being overlooked by assistive technologies. [Learn how to fix duplicate ARIA IDs](https://dequeuniversity.com/rules/axe/4.10/duplicate-id-aria).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "empty-heading": {
      "id": "empty-heading",
      "title": "All heading elements contain content.",
      "description": "A heading with no content or inaccessible text prevent screen reader users from accessing information on the page's structure. [Learn more about headings](https://dequeuniversity.com/rules/axe/4.10/empty-heading).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "form-field-multiple-labels": {
      "id": "form-field-multiple-labels",
      "title": "No form fields have multiple labels",
      "description": "Form fields with multiple labels can be confusingly announced by assistive technologies like screen readers which use either the first, the last, or all of the labels. [Learn how to use form labels](https://dequeuniversity.com/rules/axe/4.10/form-field-multiple-labels).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "frame-title": {
      "id": "frame-title",
      "title": "`<frame>` or `<iframe>` elements have a title",
      "description": "Screen reader users rely on frame titles to describe the contents of frames. [Learn more about frame titles](https://dequeuniversity.com/rules/axe/4.10/frame-title).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "heading-order": {
      "id": "heading-order",
      "title": "Heading elements appear in a sequentially-descending order",
      "description": "Properly ordered headings that do not skip levels convey the semantic structure of the page, making it easier to navigate and understand when using assistive technologies. [Learn more about heading order](https://dequeuniversity.com/rules/axe/4.10/heading-order).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "html-has-lang": {
      "id": "html-has-lang",
      "title": "`<html>` element has a `[lang]` attribute",
      "description": "If a page doesn't specify a `lang` attribute, a screen reader assumes that the page is in the default language that the user chose when setting up the screen reader. If the page isn't actually in the default language, then the screen reader might not announce the page's text correctly. [Learn more about the `lang` attribute](https://dequeuniversity.com/rules/axe/4.10/html-has-lang).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "html-lang-valid": {
      "id": "html-lang-valid",
      "title": "`<html>` element has a valid value for its `[lang]` attribute",
      "description": "Specifying a valid [BCP 47 language](https://www.w3.org/International/questions/qa-choosing-language-tags#question) helps screen readers announce text properly. [Learn how to use the `lang` attribute](https://dequeuniversity.com/rules/axe/4.10/html-lang-valid).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "html-xml-lang-mismatch": {
      "id": "html-xml-lang-mismatch",
      "title": "`<html>` element has an `[xml:lang]` attribute with the same base language as the `[lang]` attribute.",
      "description": "If the webpage does not specify a consistent language, then the screen reader might not announce the page's text correctly. [Learn more about the `lang` attribute](https://dequeuniversity.com/rules/axe/4.10/html-xml-lang-mismatch).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "identical-links-same-purpose": {
      "id": "identical-links-same-purpose",
      "title": "Identical links have the same purpose.",
      "description": "Links with the same destination should have the same description, to help users understand the link's purpose and decide whether to follow it. [Learn more about identical links](https://dequeuniversity.com/rules/axe/4.10/identical-links-same-purpose).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "image-alt": {
      "id": "image-alt",
      "title": "Image elements have `[alt]` attributes",
      "description": "Informative elements should aim for short, descriptive alternate text. Decorative elements can be ignored with an empty alt attribute. [Learn more about the `alt` attribute](https://dequeuniversity.com/rules/axe/4.10/image-alt).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "image-redundant-alt": {
      "id": "image-redundant-alt",
      "title": "Image elements do not have `[alt]` attributes that are redundant text.",
      "description": "Informative elements should aim for short, descriptive alternative text. Alternative text that is exactly the same as the text adjacent to the link or image is potentially confusing for screen reader users, because the text will be read twice. [Learn more about the `alt` attribute](https://dequeuniversity.com/rules/axe/4.10/image-redundant-alt).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "input-button-name": {
      "id": "input-button-name",
      "title": "Input buttons have discernible text.",
      "description": "Adding discernable and accessible text to input buttons may help screen reader users understand the purpose of the input button. [Learn more about input buttons](https://dequeuniversity.com/rules/axe/4.10/input-button-name).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "input-image-alt": {
      "id": "input-image-alt",
      "title": "`<input type=\"image\">` elements have `[alt]` text",
      "description": "When an image is being used as an `<input>` button, providing alternative text can help screen reader users understand the purpose of the button. [Learn about input image alt text](https://dequeuniversity.com/rules/axe/4.10/input-image-alt).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "label-content-name-mismatch": {
      "id": "label-content-name-mismatch",
      "title": "Elements with visible text labels do not have matching accessible names.",
      "description": "Visible text labels that do not match the accessible name can result in a confusing experience for screen reader users. [Learn more about accessible names](https://dequeuniversity.com/rules/axe/4.10/label-content-name-mismatch).",
      "score": 0,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [
          {
            "key": "node",
            "valueType": "node",
            "subItemsHeading": {
              "key": "relatedNode",
              "valueType": "node"
            },
            "label": "Failing Elements"
          }
        ],
        "items": [
          {
            "node": {
              "type": "node",
              "lhId": "1-5-BUTTON",
              "path": "1,HTML,1,BODY,0,DIV,1,MAIN,0,DIV,1,DIV,0,DIV,2,FORM,1,DIV,1,BUTTON",
              "selector": "div.max-w-4xl > form.flex > div.flex > button.px-4",
              "boundingRect": {
                "top": 280,
                "bottom": 328,
                "left": 1021,
                "right": 1181,
                "width": 160,
                "height": 48
              },
              "snippet": "<button type=\"submit\" class=\"px-4 sm:px-8 py-2 sm:py-3 bg-blue-600 text-white font-medium rounded-md ho…\" aria-label=\"Begin the core values exercise\">",
              "nodeLabel": "Start Exercise",
              "explanation": "Fix any of the following:\n  Text inside the element is not included in the accessible name"
            }
          },
          {
            "node": {
              "type": "node",
              "lhId": "1-6-A",
              "path": "1,HTML,1,BODY,0,DIV,1,MAIN,0,DIV,1,DIV,0,DIV,3,DIV,1,A",
              "selector": "div.h-[calc(100vh-4rem)] > div.max-w-4xl > div.mt-6 > a.text-blue-600",
              "boundingRect": {
                "top": 392,
                "bottom": 424,
                "left": 716,
                "right": 943,
                "width": 228,
                "height": 32
              },
              "snippet": "<a class=\"text-blue-600 hover:text-blue-800 underline font-medium text-sm sm:text-ba…\" aria-label=\"View your previous exercise results\" href=\"/history\">",
              "nodeLabel": "View Your Previous Results\n→",
              "explanation": "Fix any of the following:\n  Text inside the element is not included in the accessible name"
            }
          }
        ],
        "debugData": {
          "type": "debugdata",
          "impact": "serious",
          "tags": [
            "cat.semantics",
            "wcag21a",
            "wcag253",
            "EN-301-549",
            "EN-9.2.5.3",
            "experimental"
          ]
        }
      }
    },
    "label": {
      "id": "label",
      "title": "Form elements have associated labels",
      "description": "Labels ensure that form controls are announced properly by assistive technologies, like screen readers. [Learn more about form element labels](https://dequeuniversity.com/rules/axe/4.10/label).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "landmark-one-main": {
      "id": "landmark-one-main",
      "title": "Document has a main landmark.",
      "description": "One main landmark helps screen reader users navigate a web page. [Learn more about landmarks](https://dequeuniversity.com/rules/axe/4.10/landmark-one-main).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "link-name": {
      "id": "link-name",
      "title": "Links have a discernible name",
      "description": "Link text (and alternate text for images, when used as links) that is discernible, unique, and focusable improves the navigation experience for screen reader users. [Learn how to make links accessible](https://dequeuniversity.com/rules/axe/4.10/link-name).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "link-in-text-block": {
      "id": "link-in-text-block",
      "title": "Links are distinguishable without relying on color.",
      "description": "Low-contrast text is difficult or impossible for many users to read. Link text that is discernible improves the experience for users with low vision. [Learn how to make links distinguishable](https://dequeuniversity.com/rules/axe/4.10/link-in-text-block).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "list": {
      "id": "list",
      "title": "Lists contain only `<li>` elements and script supporting elements (`<script>` and `<template>`).",
      "description": "Screen readers have a specific way of announcing lists. Ensuring proper list structure aids screen reader output. [Learn more about proper list structure](https://dequeuniversity.com/rules/axe/4.10/list).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "listitem": {
      "id": "listitem",
      "title": "List items (`<li>`) are contained within `<ul>`, `<ol>` or `<menu>` parent elements",
      "description": "Screen readers require list items (`<li>`) to be contained within a parent `<ul>`, `<ol>` or `<menu>` to be announced properly. [Learn more about proper list structure](https://dequeuniversity.com/rules/axe/4.10/listitem).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "meta-refresh": {
      "id": "meta-refresh",
      "title": "The document does not use `<meta http-equiv=\"refresh\">`",
      "description": "Users do not expect a page to refresh automatically, and doing so will move focus back to the top of the page. This may create a frustrating or confusing experience. [Learn more about the refresh meta tag](https://dequeuniversity.com/rules/axe/4.10/meta-refresh).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "meta-viewport": {
      "id": "meta-viewport",
      "title": "`[user-scalable=\"no\"]` is used in the `<meta name=\"viewport\">` element or the `[maximum-scale]` attribute is less than 5.",
      "description": "Disabling zooming is problematic for users with low vision who rely on screen magnification to properly see the contents of a web page. [Learn more about the viewport meta tag](https://dequeuniversity.com/rules/axe/4.10/meta-viewport).",
      "score": 0,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [
          {
            "key": "node",
            "valueType": "node",
            "subItemsHeading": {
              "key": "relatedNode",
              "valueType": "node"
            },
            "label": "Failing Elements"
          }
        ],
        "items": [
          {
            "node": {
              "type": "node",
              "lhId": "1-7-META",
              "path": "1,HTML,0,HEAD,2,META",
              "selector": "head > meta",
              "boundingRect": {
                "top": 0,
                "bottom": 0,
                "left": 0,
                "right": 0,
                "width": 0,
                "height": 0
              },
              "snippet": "<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">",
              "nodeLabel": "head > meta",
              "explanation": "Fix any of the following:\n  maximum-scale on <meta> tag disables zooming on mobile devices"
            }
          }
        ],
        "debugData": {
          "type": "debugdata",
          "impact": "critical",
          "tags": [
            "cat.sensory-and-visual-cues",
            "wcag2aa",
            "wcag144",
            "EN-301-549",
            "EN-9.1.4.4",
            "ACT"
          ]
        }
      }
    },
    "object-alt": {
      "id": "object-alt",
      "title": "`<object>` elements have alternate text",
      "description": "Screen readers cannot translate non-text content. Adding alternate text to `<object>` elements helps screen readers convey meaning to users. [Learn more about alt text for `object` elements](https://dequeuniversity.com/rules/axe/4.10/object-alt).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "select-name": {
      "id": "select-name",
      "title": "Select elements have associated label elements.",
      "description": "Form elements without effective labels can create frustrating experiences for screen reader users. [Learn more about the `select` element](https://dequeuniversity.com/rules/axe/4.10/select-name).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "skip-link": {
      "id": "skip-link",
      "title": "Skip links are focusable.",
      "description": "Including a skip link can help users skip to the main content to save time. [Learn more about skip links](https://dequeuniversity.com/rules/axe/4.10/skip-link).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "tabindex": {
      "id": "tabindex",
      "title": "No element has a `[tabindex]` value greater than 0",
      "description": "A value greater than 0 implies an explicit navigation ordering. Although technically valid, this often creates frustrating experiences for users who rely on assistive technologies. [Learn more about the `tabindex` attribute](https://dequeuniversity.com/rules/axe/4.10/tabindex).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "table-duplicate-name": {
      "id": "table-duplicate-name",
      "title": "Tables have different content in the summary attribute and `<caption>`.",
      "description": "The summary attribute should describe the table structure, while `<caption>` should have the onscreen title. Accurate table mark-up helps users of screen readers. [Learn more about summary and caption](https://dequeuniversity.com/rules/axe/4.10/table-duplicate-name).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "table-fake-caption": {
      "id": "table-fake-caption",
      "title": "Tables use `<caption>` instead of cells with the `[colspan]` attribute to indicate a caption.",
      "description": "Screen readers have features to make navigating tables easier. Ensuring that tables use the actual caption element instead of cells with the `[colspan]` attribute may improve the experience for screen reader users. [Learn more about captions](https://dequeuniversity.com/rules/axe/4.10/table-fake-caption).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "target-size": {
      "id": "target-size",
      "title": "Touch targets have sufficient size and spacing.",
      "description": "Touch targets with sufficient size and spacing help users who may have difficulty targeting small controls to activate the targets. [Learn more about touch targets](https://dequeuniversity.com/rules/axe/4.10/target-size).",
      "score": 1,
      "scoreDisplayMode": "binary",
      "details": {
        "type": "table",
        "headings": [],
        "items": []
      }
    },
    "td-has-header": {
      "id": "td-has-header",
      "title": "`<td>` elements in a large `<table>` have one or more table headers.",
      "description": "Screen readers have features to make navigating tables easier. Ensuring that `<td>` elements in a large table (3 or more cells in width and height) have an associated table header may improve the experience for screen reader users. [Learn more about table headers](https://dequeuniversity.com/rules/axe/4.10/td-has-header).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "td-headers-attr": {
      "id": "td-headers-attr",
      "title": "Cells in a `<table>` element that use the `[headers]` attribute refer to table cells within the same table.",
      "description": "Screen readers have features to make navigating tables easier. Ensuring `<td>` cells using the `[headers]` attribute only refer to other cells in the same table may improve the experience for screen reader users. [Learn more about the `headers` attribute](https://dequeuniversity.com/rules/axe/4.10/td-headers-attr).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "th-has-data-cells": {
      "id": "th-has-data-cells",
      "title": "`<th>` elements and elements with `[role=\"columnheader\"/\"rowheader\"]` have data cells they describe.",
      "description": "Screen readers have features to make navigating tables easier. Ensuring table headers always refer to some set of cells may improve the experience for screen reader users. [Learn more about table headers](https://dequeuniversity.com/rules/axe/4.10/th-has-data-cells).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "valid-lang": {
      "id": "valid-lang",
      "title": "`[lang]` attributes have a valid value",
      "description": "Specifying a valid [BCP 47 language](https://www.w3.org/International/questions/qa-choosing-language-tags#question) on elements helps ensure that text is pronounced correctly by a screen reader. [Learn how to use the `lang` attribute](https://dequeuniversity.com/rules/axe/4.10/valid-lang).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "video-caption": {
      "id": "video-caption",
      "title": "`<video>` elements contain a `<track>` element with `[kind=\"captions\"]`",
      "description": "When a video provides a caption it is easier for deaf and hearing impaired users to access its information. [Learn more about video captions](https://dequeuniversity.com/rules/axe/4.10/video-caption).",
      "score": null,
      "scoreDisplayMode": "notApplicable"
    },
    "custom-controls-labels": {
      "id": "custom-controls-labels",
      "title": "Custom controls have associated labels",
      "description": "Custom interactive controls have associated labels, provided by aria-label or aria-labelledby. [Learn more about custom controls and labels](https://developer.chrome.com/docs/lighthouse/accessibility/custom-controls-labels/).",
      "score": null,
      "scoreDisplayMode": "manual"
    },
    "custom-controls-roles": {
      "id": "custom-controls-roles",
      "title": "Custom controls have ARIA roles",
      "description": "Custom interactive controls have appropriate ARIA roles. [Learn how to add roles to custom controls](https://developer.chrome.com/docs/lighthouse/accessibility/custom-control-roles/).",
      "score": null,
      "scoreDisplayMode": "manual"
    },
    "focus-traps": {
      "id": "focus-traps",
      "title": "User focus is not accidentally trapped in a region",
      "description": "A user can tab into and out of any control or region without accidentally trapping their focus. [Learn how to avoid focus traps](https://developer.chrome.com/docs/lighthouse/accessibility/focus-traps/).",
      "score": null,
      "scoreDisplayMode": "manual"
    },
    "focusable-controls": {
      "id": "focusable-controls",
      "title": "Interactive controls are keyboard focusable",
      "description": "Custom interactive controls are keyboard focusable and display a focus indicator. [Learn how to make custom controls focusable](https://developer.chrome.com/docs/lighthouse/accessibility/focusable-controls/).",
      "score": null,
      "scoreDisplayMode": "manual"
    },
    "interactive-element-affordance": {
      "id": "interactive-element-affordance",
      "title": "Interactive elements indicate their purpose and state",
      "description": "Interactive elements, such as links and buttons, should indicate their state and be distinguishable from non-interactive elements. [Learn how to decorate interactive elements with affordance hints](https://developer.chrome.com/docs/lighthouse/accessibility/interactive-element-affordance/).",
      "score": null,
      "scoreDisplayMode": "manual"
    },
    "logical-tab-order": {
      "id": "logical-tab-order",
      "title": "The page has a logical tab order",
      "description": "Tabbing through the page follows the visual layout. Users cannot focus elements that are offscreen. [Learn more about logical tab ordering](https://developer.chrome.com/docs/lighthouse/accessibility/logical-tab-order/).",
      "score": null,
      "scoreDisplayMode": "manual"
    },
    "managed-focus": {
      "id": "managed-focus",
      "title": "The user's focus is directed to new content added to the page",
      "description": "If new content, such as a dialog, is added to the page, the user's focus is directed to it. [Learn how to direct focus to new content](https://developer.chrome.com/docs/lighthouse/accessibility/managed-focus/).",
      "score": null,
      "scoreDisplayMode": "manual"
    },
    "offscreen-content-hidden": {
      "id": "offscreen-content-hidden",
      "title": "Offscreen content is hidden from assistive technology",
      "description": "Offscreen content is hidden with display: none or aria-hidden=true. [Learn how to properly hide offscreen content](https://developer.chrome.com/docs/lighthouse/accessibility/offscreen-content-hidden/).",
      "score": null,
      "scoreDisplayMode": "manual"
    },
    "use-landmarks": {
      "id": "use-landmarks",
      "title": "HTML5 landmark elements are used to improve navigation",
      "description": "Landmark elements (`<main>`, `<nav>`, etc.) are used to improve the keyboard navigation of the page for assistive technology. [Learn more about landmark elements](https://developer.chrome.com/docs/lighthouse/accessibility/use-landmarks/).",
      "score": null,
      "scoreDisplayMode": "manual"
    },
    "visual-order-follows-dom": {
      "id": "visual-order-follows-dom",
      "title": "Visual order on the page follows DOM order",
      "description": "DOM order matches the visual order, improving navigation for assistive technology. [Learn more about DOM and visual ordering](https://developer.chrome.com/docs/lighthouse/accessibility/visual-order-follows-dom/).",
      "score": null,
      "scoreDisplayMode": "manual"
    }
  },
  "configSettings": {
    "output": "json",
    "maxWaitForFcp": 30000,
    "maxWaitForLoad": 45000,
    "pauseAfterFcpMs": 1000,
    "pauseAfterLoadMs": 1000,
    "networkQuietThresholdMs": 1000,
    "cpuQuietThresholdMs": 1000,
    "formFactor": "desktop",
    "throttling": {
      "rttMs": 40,
      "throughputKbps": 10240,
      "requestLatencyMs": 0,
      "downloadThroughputKbps": 0,
      "uploadThroughputKbps": 0,
      "cpuSlowdownMultiplier": 1
    },
    "throttlingMethod": "simulate",
    "screenEmulation": {
      "mobile": true,
      "width": 412,
      "height": 823,
      "deviceScaleFactor": 1.75,
      "disabled": true
    },
    "emulatedUserAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36",
    "auditMode": false,
    "gatherMode": false,
    "clearStorageTypes": [
      "file_systems",
      "shader_cache",
      "service_workers",
      "cache_storage"
    ],
    "disableStorageReset": false,
    "debugNavigation": false,
    "channel": "devtools",
    "usePassiveGathering": false,
    "disableFullPageScreenshot": false,
    "skipAboutBlank": false,
    "blankPage": "about:blank",
    "ignoreStatusCode": true,
    "locale": "en-US",
    "blockedUrlPatterns": null,
    "additionalTraceCategories": "",
    "extraHeaders": null,
    "precomputedLanternData": null,
    "onlyAudits": null,
    "onlyCategories": [
      "accessibility"
    ],
    "skipAudits": null
  },
  "categories": {
    "accessibility": {
      "title": "Accessibility",
      "description": "These checks highlight opportunities to [improve the accessibility of your web app](https://developer.chrome.com/docs/lighthouse/accessibility/). Automatic detection can only detect a subset of issues and does not guarantee the accessibility of your web app, so [manual testing](https://web.dev/articles/how-to-review) is also encouraged.",
      "manualDescription": "These items address areas which an automated testing tool cannot cover. Learn more in our guide on [conducting an accessibility review](https://web.dev/articles/how-to-review).",
      "supportedModes": [
        "navigation",
        "snapshot"
      ],
      "auditRefs": [
        {
          "id": "accesskeys",
          "weight": 0,
          "group": "a11y-navigation"
        },
        {
          "id": "aria-allowed-attr",
          "weight": 10,
          "group": "a11y-aria"
        },
        {
          "id": "aria-allowed-role",
          "weight": 1,
          "group": "a11y-aria"
        },
        {
          "id": "aria-command-name",
          "weight": 0,
          "group": "a11y-aria"
        },
        {
          "id": "aria-conditional-attr",
          "weight": 7,
          "group": "a11y-aria"
        },
        {
          "id": "aria-deprecated-role",
          "weight": 1,
          "group": "a11y-aria"
        },
        {
          "id": "aria-dialog-name",
          "weight": 0,
          "group": "a11y-aria"
        },
        {
          "id": "aria-hidden-body",
          "weight": 10,
          "group": "a11y-aria"
        },
        {
          "id": "aria-hidden-focus",
          "weight": 7,
          "group": "a11y-aria"
        },
        {
          "id": "aria-input-field-name",
          "weight": 0,
          "group": "a11y-aria"
        },
        {
          "id": "aria-meter-name",
          "weight": 0,
          "group": "a11y-aria"
        },
        {
          "id": "aria-progressbar-name",
          "weight": 0,
          "group": "a11y-aria"
        },
        {
          "id": "aria-prohibited-attr",
          "weight": 7,
          "group": "a11y-aria"
        },
        {
          "id": "aria-required-attr",
          "weight": 10,
          "group": "a11y-aria"
        },
        {
          "id": "aria-required-children",
          "weight": 10,
          "group": "a11y-aria"
        },
        {
          "id": "aria-required-parent",
          "weight": 10,
          "group": "a11y-aria"
        },
        {
          "id": "aria-roles",
          "weight": 7,
          "group": "a11y-aria"
        },
        {
          "id": "aria-text",
          "weight": 0,
          "group": "a11y-aria"
        },
        {
          "id": "aria-toggle-field-name",
          "weight": 0,
          "group": "a11y-aria"
        },
        {
          "id": "aria-tooltip-name",
          "weight": 0,
          "group": "a11y-aria"
        },
        {
          "id": "aria-treeitem-name",
          "weight": 0,
          "group": "a11y-aria"
        },
        {
          "id": "aria-valid-attr-value",
          "weight": 10,
          "group": "a11y-aria"
        },
        {
          "id": "aria-valid-attr",
          "weight": 10,
          "group": "a11y-aria"
        },
        {
          "id": "button-name",
          "weight": 10,
          "group": "a11y-names-labels"
        },
        {
          "id": "bypass",
          "weight": 0,
          "group": "a11y-navigation"
        },
        {
          "id": "color-contrast",
          "weight": 7,
          "group": "a11y-color-contrast"
        },
        {
          "id": "definition-list",
          "weight": 0,
          "group": "a11y-tables-lists"
        },
        {
          "id": "dlitem",
          "weight": 0,
          "group": "a11y-tables-lists"
        },
        {
          "id": "document-title",
          "weight": 7,
          "group": "a11y-names-labels"
        },
        {
          "id": "duplicate-id-aria",
          "weight": 0,
          "group": "a11y-aria"
        },
        {
          "id": "form-field-multiple-labels",
          "weight": 0,
          "group": "a11y-names-labels"
        },
        {
          "id": "frame-title",
          "weight": 0,
          "group": "a11y-names-labels"
        },
        {
          "id": "heading-order",
          "weight": 3,
          "group": "a11y-navigation"
        },
        {
          "id": "html-has-lang",
          "weight": 7,
          "group": "a11y-language"
        },
        {
          "id": "html-lang-valid",
          "weight": 7,
          "group": "a11y-language"
        },
        {
          "id": "html-xml-lang-mismatch",
          "weight": 0,
          "group": "a11y-language"
        },
        {
          "id": "image-alt",
          "weight": 0,
          "group": "a11y-names-labels"
        },
        {
          "id": "image-redundant-alt",
          "weight": 0,
          "group": "a11y-names-labels"
        },
        {
          "id": "input-button-name",
          "weight": 0,
          "group": "a11y-names-labels"
        },
        {
          "id": "input-image-alt",
          "weight": 0,
          "group": "a11y-names-labels"
        },
        {
          "id": "label",
          "weight": 7,
          "group": "a11y-names-labels"
        },
        {
          "id": "link-in-text-block",
          "weight": 7,
          "group": "a11y-color-contrast"
        },
        {
          "id": "link-name",
          "weight": 7,
          "group": "a11y-names-labels"
        },
        {
          "id": "list",
          "weight": 0,
          "group": "a11y-tables-lists"
        },
        {
          "id": "listitem",
          "weight": 0,
          "group": "a11y-tables-lists"
        },
        {
          "id": "meta-refresh",
          "weight": 0,
          "group": "a11y-best-practices"
        },
        {
          "id": "meta-viewport",
          "weight": 10,
          "group": "a11y-best-practices"
        },
        {
          "id": "object-alt",
          "weight": 0,
          "group": "a11y-names-labels"
        },
        {
          "id": "select-name",
          "weight": 0,
          "group": "a11y-names-labels"
        },
        {
          "id": "skip-link",
          "weight": 0,
          "group": "a11y-names-labels"
        },
        {
          "id": "tabindex",
          "weight": 0,
          "group": "a11y-navigation"
        },
        {
          "id": "table-duplicate-name",
          "weight": 0,
          "group": "a11y-tables-lists"
        },
        {
          "id": "target-size",
          "weight": 7,
          "group": "a11y-best-practices"
        },
        {
          "id": "td-headers-attr",
          "weight": 0,
          "group": "a11y-tables-lists"
        },
        {
          "id": "th-has-data-cells",
          "weight": 0,
          "group": "a11y-tables-lists"
        },
        {
          "id": "valid-lang",
          "weight": 0,
          "group": "a11y-language"
        },
        {
          "id": "video-caption",
          "weight": 0,
          "group": "a11y-audio-video"
        },
        {
          "id": "focusable-controls",
          "weight": 0
        },
        {
          "id": "interactive-element-affordance",
          "weight": 0
        },
        {
          "id": "logical-tab-order",
          "weight": 0
        },
        {
          "id": "visual-order-follows-dom",
          "weight": 0
        },
        {
          "id": "focus-traps",
          "weight": 0
        },
        {
          "id": "managed-focus",
          "weight": 0
        },
        {
          "id": "use-landmarks",
          "weight": 0
        },
        {
          "id": "offscreen-content-hidden",
          "weight": 0
        },
        {
          "id": "custom-controls-labels",
          "weight": 0
        },
        {
          "id": "custom-controls-roles",
          "weight": 0
        },
        {
          "id": "empty-heading",
          "weight": 0,
          "group": "hidden"
        },
        {
          "id": "identical-links-same-purpose",
          "weight": 0,
          "group": "hidden"
        },
        {
          "id": "landmark-one-main",
          "weight": 0,
          "group": "hidden"
        },
        {
          "id": "label-content-name-mismatch",
          "weight": 0,
          "group": "hidden"
        },
        {
          "id": "table-fake-caption",
          "weight": 0,
          "group": "hidden"
        },
        {
          "id": "td-has-header",
          "weight": 0,
          "group": "hidden"
        }
      ],
      "id": "accessibility",
      "score": 0.91
    }
  },
  "categoryGroups": {
    "metrics": {
      "title": "Metrics"
    },
    "diagnostics": {
      "title": "Diagnostics",
      "description": "More information about the performance of your application. These numbers don't [directly affect](https://developer.chrome.com/docs/lighthouse/performance/performance-scoring/) the Performance score."
    },
    "a11y-best-practices": {
      "title": "Best practices",
      "description": "These items highlight common accessibility best practices."
    },
    "a11y-color-contrast": {
      "title": "Contrast",
      "description": "These are opportunities to improve the legibility of your content."
    },
    "a11y-names-labels": {
      "title": "Names and labels",
      "description": "These are opportunities to improve the semantics of the controls in your application. This may enhance the experience for users of assistive technology, like a screen reader."
    },
    "a11y-navigation": {
      "title": "Navigation",
      "description": "These are opportunities to improve keyboard navigation in your application."
    },
    "a11y-aria": {
      "title": "ARIA",
      "description": "These are opportunities to improve the usage of ARIA in your application which may enhance the experience for users of assistive technology, like a screen reader."
    },
    "a11y-language": {
      "title": "Internationalization and localization",
      "description": "These are opportunities to improve the interpretation of your content by users in different locales."
    },
    "a11y-audio-video": {
      "title": "Audio and video",
      "description": "These are opportunities to provide alternative content for audio and video. This may improve the experience for users with hearing or vision impairments."
    },
    "a11y-tables-lists": {
      "title": "Tables and lists",
      "description": "These are opportunities to improve the experience of reading tabular or list data using assistive technology, like a screen reader."
    },
    "seo-mobile": {
      "title": "Mobile Friendly",
      "description": "Make sure your pages are mobile friendly so users don’t have to pinch or zoom in order to read the content pages. [Learn how to make pages mobile-friendly](https://developers.google.com/search/mobile-sites/)."
    },
    "seo-content": {
      "title": "Content Best Practices",
      "description": "Format your HTML in a way that enables crawlers to better understand your app’s content."
    },
    "seo-crawl": {
      "title": "Crawling and Indexing",
      "description": "To appear in search results, crawlers need access to your app."
    },
    "best-practices-trust-safety": {
      "title": "Trust and Safety"
    },
    "best-practices-ux": {
      "title": "User Experience"
    },
    "best-practices-browser-compat": {
      "title": "Browser Compatibility"
    },
    "best-practices-general": {
      "title": "General"
    },
    "hidden": {
      "title": ""
    }
  },
  "stackPacks": [],
  "fullPageScreenshot": {
    "screenshot": {
      "data": "data:image/webp;base64,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",
      "width": 1659,
      "height": 1443
    },
    "nodes": {
      "1-0-A": {
        "id": "",
        "top": 8,
        "bottom": 52,
        "left": 1236,
        "right": 1317,
        "width": 81,
        "height": 44
      },
      "1-1-HEADER": {
        "id": "",
        "top": 0,
        "bottom": 60,
        "left": 0,
        "right": 1659,
        "width": 1659,
        "height": 60
      },
      "1-2-A": {
        "id": "",
        "top": 8,
        "bottom": 52,
        "left": 1333,
        "right": 1422,
        "width": 88,
        "height": 44
      },
      "1-3-P": {
        "id": "",
        "top": 1455,
        "bottom": 1475,
        "left": 222,
        "right": 1438,
        "width": 1216,
        "height": 20
      },
      "1-4-FOOTER": {
        "id": "",
        "top": 1439,
        "bottom": 1491,
        "left": 0,
        "right": 1659,
        "width": 1659,
        "height": 52
      },
      "1-5-BUTTON": {
        "id": "",
        "top": 280,
        "bottom": 328,
        "left": 1021,
        "right": 1181,
        "width": 160,
        "height": 48
      },
      "1-6-A": {
        "id": "",
        "top": 392,
        "bottom": 424,
        "left": 716,
        "right": 943,
        "width": 228,
        "height": 32
      },
      "1-7-META": {
        "id": "",
        "top": 0,
        "bottom": 0,
        "left": 0,
        "right": 0,
        "width": 0,
        "height": 0
      },
      "1-8-DIV": {
        "id": "",
        "top": 60,
        "bottom": 1439,
        "left": 0,
        "right": 1659,
        "width": 1659,
        "height": 1379
      },
      "1-9-SPAN": {
        "id": "",
        "top": 84,
        "bottom": 148,
        "left": 519,
        "right": 863,
        "width": 344,
        "height": 64
      },
      "1-10-BODY": {
        "id": "",
        "top": 0,
        "bottom": 1491,
        "left": 0,
        "right": 1659,
        "width": 1659,
        "height": 1491
      }
    }
  },
  "timing": {
    "entries": [
      {
        "startTime": 146.2,
        "name": "lh:config",
        "duration": 203,
        "entryType": "measure"
      },
      {
        "startTime": 147.4,
        "name": "lh:config:resolveArtifactsToDefns",
        "duration": 1.1,
        "entryType": "measure"
      },
      {
        "startTime": 349.3,
        "name": "lh:runner:gather",
        "duration": 6169.1,
        "entryType": "measure"
      },
      {
        "startTime": 349.7,
        "name": "lh:driver:connect",
        "duration": 8.6,
        "entryType": "measure"
      },
      {
        "startTime": 358.5,
        "name": "lh:driver:navigate",
        "duration": 14.6,
        "entryType": "measure"
      },
      {
        "startTime": 373.3,
        "name": "lh:gather:getBenchmarkIndex",
        "duration": 1006.8,
        "entryType": "measure"
      },
      {
        "startTime": 1380.1,
        "name": "lh:gather:getVersion",
        "duration": 1.4,
        "entryType": "measure"
      },
      {
        "startTime": 1381.8,
        "name": "lh:prepare:navigationMode",
        "duration": 122.6,
        "entryType": "measure"
      },
      {
        "startTime": 1400.7,
        "name": "lh:storage:clearDataForOrigin",
        "duration": 31.7,
        "entryType": "measure"
      },
      {
        "startTime": 1432.6,
        "name": "lh:storage:clearBrowserCaches",
        "duration": 69,
        "entryType": "measure"
      },
      {
        "startTime": 1503.1,
        "name": "lh:gather:prepareThrottlingAndNetwork",
        "duration": 1.3,
        "entryType": "measure"
      },
      {
        "startTime": 1507.3,
        "name": "lh:driver:navigate",
        "duration": 3577.4,
        "entryType": "measure"
      },
      {
        "startTime": 5093.8,
        "name": "lh:computed:NetworkRecords",
        "duration": 2.1,
        "entryType": "measure"
      },
      {
        "startTime": 5096.6,
        "name": "lh:gather:getArtifact:DevtoolsLog",
        "duration": 0.3,
        "entryType": "measure"
      },
      {
        "startTime": 5096.9,
        "name": "lh:gather:getArtifact:Accessibility",
        "duration": 155,
        "entryType": "measure"
      },
      {
        "startTime": 5252,
        "name": "lh:gather:getArtifact:NetworkUserAgent",
        "duration": 0,
        "entryType": "measure"
      },
      {
        "startTime": 5252,
        "name": "lh:gather:getArtifact:Stacks",
        "duration": 13.4,
        "entryType": "measure"
      },
      {
        "startTime": 5252.1,
        "name": "lh:gather:collectStacks",
        "duration": 13.3,
        "entryType": "measure"
      },
      {
        "startTime": 5265.4,
        "name": "lh:gather:getArtifact:FullPageScreenshot",
        "duration": 1250.3,
        "entryType": "measure"
      },
      {
        "startTime": 6518.6,
        "name": "lh:runner:auditing",
        "duration": 145.7,
        "entryType": "measure"
      },
      {
        "startTime": 6518.6,
        "name": "lh:runner:audit",
        "duration": 146,
        "entryType": "measure"
      },
      {
        "startTime": 6519.5,
        "name": "lh:audit:accesskeys",
        "duration": 1.2,
        "entryType": "measure"
      },
      {
        "startTime": 6521,
        "name": "lh:audit:aria-allowed-attr",
        "duration": 5.5,
        "entryType": "measure"
      },
      {
        "startTime": 6526.8,
        "name": "lh:audit:aria-allowed-role",
        "duration": 3.8,
        "entryType": "measure"
      },
      {
        "startTime": 6530.9,
        "name": "lh:audit:aria-command-name",
        "duration": 0.7,
        "entryType": "measure"
      },
      {
        "startTime": 6531.8,
        "name": "lh:audit:aria-conditional-attr",
        "duration": 2.4,
        "entryType": "measure"
      },
      {
        "startTime": 6534.3,
        "name": "lh:audit:aria-deprecated-role",
        "duration": 2.3,
        "entryType": "measure"
      },
      {
        "startTime": 6536.7,
        "name": "lh:audit:aria-dialog-name",
        "duration": 0.7,
        "entryType": "measure"
      },
      {
        "startTime": 6537.7,
        "name": "lh:audit:aria-hidden-body",
        "duration": 2.4,
        "entryType": "measure"
      },
      {
        "startTime": 6540.2,
        "name": "lh:audit:aria-hidden-focus",
        "duration": 2.5,
        "entryType": "measure"
      },
      {
        "startTime": 6542.8,
        "name": "lh:audit:aria-input-field-name",
        "duration": 0.9,
        "entryType": "measure"
      },
      {
        "startTime": 6543.8,
        "name": "lh:audit:aria-meter-name",
        "duration": 2.8,
        "entryType": "measure"
      },
      {
        "startTime": 6546.8,
        "name": "lh:audit:aria-progressbar-name",
        "duration": 0.9,
        "entryType": "measure"
      },
      {
        "startTime": 6547.8,
        "name": "lh:audit:aria-prohibited-attr",
        "duration": 2.6,
        "entryType": "measure"
      },
      {
        "startTime": 6550.6,
        "name": "lh:audit:aria-required-attr",
        "duration": 2.4,
        "entryType": "measure"
      },
      {
        "startTime": 6553.2,
        "name": "lh:audit:aria-required-children",
        "duration": 2.6,
        "entryType": "measure"
      },
      {
        "startTime": 6556,
        "name": "lh:audit:aria-required-parent",
        "duration": 4.1,
        "entryType": "measure"
      },
      {
        "startTime": 6560.3,
        "name": "lh:audit:aria-roles",
        "duration": 2.1,
        "entryType": "measure"
      },
      {
        "startTime": 6562.6,
        "name": "lh:audit:aria-text",
        "duration": 0.9,
        "entryType": "measure"
      },
      {
        "startTime": 6563.6,
        "name": "lh:audit:aria-toggle-field-name",
        "duration": 0.9,
        "entryType": "measure"
      },
      {
        "startTime": 6564.6,
        "name": "lh:audit:aria-tooltip-name",
        "duration": 0.9,
        "entryType": "measure"
      },
      {
        "startTime": 6565.7,
        "name": "lh:audit:aria-treeitem-name",
        "duration": 1,
        "entryType": "measure"
      },
      {
        "startTime": 6566.8,
        "name": "lh:audit:aria-valid-attr-value",
        "duration": 2.2,
        "entryType": "measure"
      },
      {
        "startTime": 6569.1,
        "name": "lh:audit:aria-valid-attr",
        "duration": 2.2,
        "entryType": "measure"
      },
      {
        "startTime": 6571.5,
        "name": "lh:audit:button-name",
        "duration": 2.2,
        "entryType": "measure"
      },
      {
        "startTime": 6573.9,
        "name": "lh:audit:bypass",
        "duration": 2.2,
        "entryType": "measure"
      },
      {
        "startTime": 6576.2,
        "name": "lh:audit:color-contrast",
        "duration": 3.6,
        "entryType": "measure"
      },
      {
        "startTime": 6579.9,
        "name": "lh:audit:definition-list",
        "duration": 1.1,
        "entryType": "measure"
      },
      {
        "startTime": 6581.2,
        "name": "lh:audit:dlitem",
        "duration": 1,
        "entryType": "measure"
      },
      {
        "startTime": 6582.3,
        "name": "lh:audit:document-title",
        "duration": 2.2,
        "entryType": "measure"
      },
      {
        "startTime": 6584.7,
        "name": "lh:audit:duplicate-id-aria",
        "duration": 2.1,
        "entryType": "measure"
      },
      {
        "startTime": 6587,
        "name": "lh:audit:empty-heading",
        "duration": 2.5,
        "entryType": "measure"
      },
      {
        "startTime": 6589.7,
        "name": "lh:audit:form-field-multiple-labels",
        "duration": 2.4,
        "entryType": "measure"
      },
      {
        "startTime": 6592.3,
        "name": "lh:audit:frame-title",
        "duration": 1,
        "entryType": "measure"
      },
      {
        "startTime": 6593.4,
        "name": "lh:audit:heading-order",
        "duration": 2.4,
        "entryType": "measure"
      },
      {
        "startTime": 6596,
        "name": "lh:audit:html-has-lang",
        "duration": 4.2,
        "entryType": "measure"
      },
      {
        "startTime": 6600.3,
        "name": "lh:audit:html-lang-valid",
        "duration": 2.2,
        "entryType": "measure"
      },
      {
        "startTime": 6602.6,
        "name": "lh:audit:html-xml-lang-mismatch",
        "duration": 1.3,
        "entryType": "measure"
      },
      {
        "startTime": 6604,
        "name": "lh:audit:identical-links-same-purpose",
        "duration": 2.2,
        "entryType": "measure"
      },
      {
        "startTime": 6606.3,
        "name": "lh:audit:image-alt",
        "duration": 1.2,
        "entryType": "measure"
      },
      {
        "startTime": 6607.6,
        "name": "lh:audit:image-redundant-alt",
        "duration": 1.4,
        "entryType": "measure"
      },
      {
        "startTime": 6609.1,
        "name": "lh:audit:input-button-name",
        "duration": 1.3,
        "entryType": "measure"
      },
      {
        "startTime": 6610.5,
        "name": "lh:audit:input-image-alt",
        "duration": 1.4,
        "entryType": "measure"
      },
      {
        "startTime": 6612,
        "name": "lh:audit:label-content-name-mismatch",
        "duration": 2.2,
        "entryType": "measure"
      },
      {
        "startTime": 6614.4,
        "name": "lh:audit:label",
        "duration": 3.9,
        "entryType": "measure"
      },
      {
        "startTime": 6618.5,
        "name": "lh:audit:landmark-one-main",
        "duration": 2.2,
        "entryType": "measure"
      },
      {
        "startTime": 6620.8,
        "name": "lh:audit:link-name",
        "duration": 2.2,
        "entryType": "measure"
      },
      {
        "startTime": 6623.1,
        "name": "lh:audit:link-in-text-block",
        "duration": 2.2,
        "entryType": "measure"
      },
      {
        "startTime": 6625.5,
        "name": "lh:audit:list",
        "duration": 1.4,
        "entryType": "measure"
      },
      {
        "startTime": 6627.1,
        "name": "lh:audit:listitem",
        "duration": 1.4,
        "entryType": "measure"
      },
      {
        "startTime": 6628.6,
        "name": "lh:audit:meta-refresh",
        "duration": 1.4,
        "entryType": "measure"
      },
      {
        "startTime": 6630.1,
        "name": "lh:audit:meta-viewport",
        "duration": 4.3,
        "entryType": "measure"
      },
      {
        "startTime": 6634.6,
        "name": "lh:audit:object-alt",
        "duration": 1.4,
        "entryType": "measure"
      },
      {
        "startTime": 6636.1,
        "name": "lh:audit:select-name",
        "duration": 1.5,
        "entryType": "measure"
      },
      {
        "startTime": 6637.7,
        "name": "lh:audit:skip-link",
        "duration": 1.7,
        "entryType": "measure"
      },
      {
        "startTime": 6639.6,
        "name": "lh:audit:tabindex",
        "duration": 1.8,
        "entryType": "measure"
      },
      {
        "startTime": 6641.6,
        "name": "lh:audit:table-duplicate-name",
        "duration": 1.7,
        "entryType": "measure"
      },
      {
        "startTime": 6643.4,
        "name": "lh:audit:table-fake-caption",
        "duration": 1.9,
        "entryType": "measure"
      },
      {
        "startTime": 6645.4,
        "name": "lh:audit:target-size",
        "duration": 4.7,
        "entryType": "measure"
      },
      {
        "startTime": 6650.4,
        "name": "lh:audit:td-has-header",
        "duration": 5.4,
        "entryType": "measure"
      },
      {
        "startTime": 6656,
        "name": "lh:audit:td-headers-attr",
        "duration": 1.9,
        "entryType": "measure"
      },
      {
        "startTime": 6658.1,
        "name": "lh:audit:th-has-data-cells",
        "duration": 1.9,
        "entryType": "measure"
      },
      {
        "startTime": 6660.1,
        "name": "lh:audit:valid-lang",
        "duration": 1.9,
        "entryType": "measure"
      },
      {
        "startTime": 6662.1,
        "name": "lh:audit:video-caption",
        "duration": 1.8,
        "entryType": "measure"
      },
      {
        "startTime": 6664,
        "name": "lh:audit:custom-controls-labels",
        "duration": 0,
        "entryType": "measure"
      },
      {
        "startTime": 6664,
        "name": "lh:audit:custom-controls-roles",
        "duration": 0,
        "entryType": "measure"
      },
      {
        "startTime": 6664.1,
        "name": "lh:audit:focus-traps",
        "duration": 0,
        "entryType": "measure"
      },
      {
        "startTime": 6664.1,
        "name": "lh:audit:focusable-controls",
        "duration": 0,
        "entryType": "measure"
      },
      {
        "startTime": 6664.1,
        "name": "lh:audit:interactive-element-affordance",
        "duration": 0,
        "entryType": "measure"
      },
      {
        "startTime": 6664.1,
        "name": "lh:audit:logical-tab-order",
        "duration": 0.1,
        "entryType": "measure"
      },
      {
        "startTime": 6664.2,
        "name": "lh:audit:managed-focus",
        "duration": 0,
        "entryType": "measure"
      },
      {
        "startTime": 6664.2,
        "name": "lh:audit:offscreen-content-hidden",
        "duration": 0,
        "entryType": "measure"
      },
      {
        "startTime": 6664.2,
        "name": "lh:audit:use-landmarks",
        "duration": 0,
        "entryType": "measure"
      },
      {
        "startTime": 6664.2,
        "name": "lh:audit:visual-order-follows-dom",
        "duration": 0.1,
        "entryType": "measure"
      },
      {
        "startTime": 6664.3,
        "name": "lh:runner:generate",
        "duration": 0.3,
        "entryType": "measure"
      }
    ],
    "total": 6315.1
  },
  "i18n": {
    "rendererFormattedStrings": {},
    "icuMessagePaths": {
      "core/gather/driver/storage.js | warningData": [
        {
          "values": {
            "locations": "IndexedDB",
            "locationCount": 1
          },
          "path": "runWarnings[0]"
        }
      ],
      "core/audits/accessibility/accesskeys.js | title": [
        "audits.accesskeys.title"
      ],
      "core/audits/accessibility/accesskeys.js | description": [
        "audits.accesskeys.description"
      ],
      "core/audits/accessibility/aria-allowed-attr.js | title": [
        "audits[aria-allowed-attr].title"
      ],
      "core/audits/accessibility/aria-allowed-attr.js | description": [
        "audits[aria-allowed-attr].description"
      ],
      "core/audits/accessibility/aria-allowed-role.js | title": [
        "audits[aria-allowed-role].title"
      ],
      "core/audits/accessibility/aria-allowed-role.js | description": [
        "audits[aria-allowed-role].description"
      ],
      "core/audits/accessibility/aria-command-name.js | title": [
        "audits[aria-command-name].title"
      ],
      "core/audits/accessibility/aria-command-name.js | description": [
        "audits[aria-command-name].description"
      ],
      "core/audits/accessibility/aria-conditional-attr.js | title": [
        "audits[aria-conditional-attr].title"
      ],
      "core/audits/accessibility/aria-conditional-attr.js | description": [
        "audits[aria-conditional-attr].description"
      ],
      "core/audits/accessibility/aria-deprecated-role.js | title": [
        "audits[aria-deprecated-role].title"
      ],
      "core/audits/accessibility/aria-deprecated-role.js | description": [
        "audits[aria-deprecated-role].description"
      ],
      "core/audits/accessibility/aria-dialog-name.js | title": [
        "audits[aria-dialog-name].title"
      ],
      "core/audits/accessibility/aria-dialog-name.js | description": [
        "audits[aria-dialog-name].description"
      ],
      "core/audits/accessibility/aria-hidden-body.js | title": [
        "audits[aria-hidden-body].title"
      ],
      "core/audits/accessibility/aria-hidden-body.js | description": [
        "audits[aria-hidden-body].description"
      ],
      "core/audits/accessibility/aria-hidden-focus.js | title": [
        "audits[aria-hidden-focus].title"
      ],
      "core/audits/accessibility/aria-hidden-focus.js | description": [
        "audits[aria-hidden-focus].description"
      ],
      "core/audits/accessibility/aria-input-field-name.js | title": [
        "audits[aria-input-field-name].title"
      ],
      "core/audits/accessibility/aria-input-field-name.js | description": [
        "audits[aria-input-field-name].description"
      ],
      "core/audits/accessibility/aria-meter-name.js | title": [
        "audits[aria-meter-name].title"
      ],
      "core/audits/accessibility/aria-meter-name.js | description": [
        "audits[aria-meter-name].description"
      ],
      "core/audits/accessibility/aria-progressbar-name.js | title": [
        "audits[aria-progressbar-name].title"
      ],
      "core/audits/accessibility/aria-progressbar-name.js | description": [
        "audits[aria-progressbar-name].description"
      ],
      "core/audits/accessibility/aria-prohibited-attr.js | title": [
        "audits[aria-prohibited-attr].title"
      ],
      "core/audits/accessibility/aria-prohibited-attr.js | description": [
        "audits[aria-prohibited-attr].description"
      ],
      "core/audits/accessibility/aria-required-attr.js | title": [
        "audits[aria-required-attr].title"
      ],
      "core/audits/accessibility/aria-required-attr.js | description": [
        "audits[aria-required-attr].description"
      ],
      "core/audits/accessibility/aria-required-children.js | title": [
        "audits[aria-required-children].title"
      ],
      "core/audits/accessibility/aria-required-children.js | description": [
        "audits[aria-required-children].description"
      ],
      "core/audits/accessibility/aria-required-parent.js | title": [
        "audits[aria-required-parent].title"
      ],
      "core/audits/accessibility/aria-required-parent.js | description": [
        "audits[aria-required-parent].description"
      ],
      "core/audits/accessibility/aria-roles.js | title": [
        "audits[aria-roles].title"
      ],
      "core/audits/accessibility/aria-roles.js | description": [
        "audits[aria-roles].description"
      ],
      "core/audits/accessibility/aria-text.js | title": [
        "audits[aria-text].title"
      ],
      "core/audits/accessibility/aria-text.js | description": [
        "audits[aria-text].description"
      ],
      "core/audits/accessibility/aria-toggle-field-name.js | title": [
        "audits[aria-toggle-field-name].title"
      ],
      "core/audits/accessibility/aria-toggle-field-name.js | description": [
        "audits[aria-toggle-field-name].description"
      ],
      "core/audits/accessibility/aria-tooltip-name.js | title": [
        "audits[aria-tooltip-name].title"
      ],
      "core/audits/accessibility/aria-tooltip-name.js | description": [
        "audits[aria-tooltip-name].description"
      ],
      "core/audits/accessibility/aria-treeitem-name.js | title": [
        "audits[aria-treeitem-name].title"
      ],
      "core/audits/accessibility/aria-treeitem-name.js | description": [
        "audits[aria-treeitem-name].description"
      ],
      "core/audits/accessibility/aria-valid-attr-value.js | title": [
        "audits[aria-valid-attr-value].title"
      ],
      "core/audits/accessibility/aria-valid-attr-value.js | description": [
        "audits[aria-valid-attr-value].description"
      ],
      "core/audits/accessibility/aria-valid-attr.js | title": [
        "audits[aria-valid-attr].title"
      ],
      "core/audits/accessibility/aria-valid-attr.js | description": [
        "audits[aria-valid-attr].description"
      ],
      "core/audits/accessibility/button-name.js | title": [
        "audits[button-name].title"
      ],
      "core/audits/accessibility/button-name.js | description": [
        "audits[button-name].description"
      ],
      "core/audits/accessibility/bypass.js | title": [
        "audits.bypass.title"
      ],
      "core/audits/accessibility/bypass.js | description": [
        "audits.bypass.description"
      ],
      "core/audits/accessibility/color-contrast.js | failureTitle": [
        "audits[color-contrast].title"
      ],
      "core/audits/accessibility/color-contrast.js | description": [
        "audits[color-contrast].description"
      ],
      "core/lib/i18n/i18n.js | columnFailingElem": [
        "audits[color-contrast].details.headings[0].label",
        "audits[label-content-name-mismatch].details.headings[0].label",
        "audits[meta-viewport].details.headings[0].label"
      ],
      "core/audits/accessibility/definition-list.js | title": [
        "audits[definition-list].title"
      ],
      "core/audits/accessibility/definition-list.js | description": [
        "audits[definition-list].description"
      ],
      "core/audits/accessibility/dlitem.js | title": [
        "audits.dlitem.title"
      ],
      "core/audits/accessibility/dlitem.js | description": [
        "audits.dlitem.description"
      ],
      "core/audits/accessibility/document-title.js | title": [
        "audits[document-title].title"
      ],
      "core/audits/accessibility/document-title.js | description": [
        "audits[document-title].description"
      ],
      "core/audits/accessibility/duplicate-id-aria.js | title": [
        "audits[duplicate-id-aria].title"
      ],
      "core/audits/accessibility/duplicate-id-aria.js | description": [
        "audits[duplicate-id-aria].description"
      ],
      "core/audits/accessibility/empty-heading.js | title": [
        "audits[empty-heading].title"
      ],
      "core/audits/accessibility/empty-heading.js | description": [
        "audits[empty-heading].description"
      ],
      "core/audits/accessibility/form-field-multiple-labels.js | title": [
        "audits[form-field-multiple-labels].title"
      ],
      "core/audits/accessibility/form-field-multiple-labels.js | description": [
        "audits[form-field-multiple-labels].description"
      ],
      "core/audits/accessibility/frame-title.js | title": [
        "audits[frame-title].title"
      ],
      "core/audits/accessibility/frame-title.js | description": [
        "audits[frame-title].description"
      ],
      "core/audits/accessibility/heading-order.js | title": [
        "audits[heading-order].title"
      ],
      "core/audits/accessibility/heading-order.js | description": [
        "audits[heading-order].description"
      ],
      "core/audits/accessibility/html-has-lang.js | title": [
        "audits[html-has-lang].title"
      ],
      "core/audits/accessibility/html-has-lang.js | description": [
        "audits[html-has-lang].description"
      ],
      "core/audits/accessibility/html-lang-valid.js | title": [
        "audits[html-lang-valid].title"
      ],
      "core/audits/accessibility/html-lang-valid.js | description": [
        "audits[html-lang-valid].description"
      ],
      "core/audits/accessibility/html-xml-lang-mismatch.js | title": [
        "audits[html-xml-lang-mismatch].title"
      ],
      "core/audits/accessibility/html-xml-lang-mismatch.js | description": [
        "audits[html-xml-lang-mismatch].description"
      ],
      "core/audits/accessibility/identical-links-same-purpose.js | title": [
        "audits[identical-links-same-purpose].title"
      ],
      "core/audits/accessibility/identical-links-same-purpose.js | description": [
        "audits[identical-links-same-purpose].description"
      ],
      "core/audits/accessibility/image-alt.js | title": [
        "audits[image-alt].title"
      ],
      "core/audits/accessibility/image-alt.js | description": [
        "audits[image-alt].description"
      ],
      "core/audits/accessibility/image-redundant-alt.js | title": [
        "audits[image-redundant-alt].title"
      ],
      "core/audits/accessibility/image-redundant-alt.js | description": [
        "audits[image-redundant-alt].description"
      ],
      "core/audits/accessibility/input-button-name.js | title": [
        "audits[input-button-name].title"
      ],
      "core/audits/accessibility/input-button-name.js | description": [
        "audits[input-button-name].description"
      ],
      "core/audits/accessibility/input-image-alt.js | title": [
        "audits[input-image-alt].title"
      ],
      "core/audits/accessibility/input-image-alt.js | description": [
        "audits[input-image-alt].description"
      ],
      "core/audits/accessibility/label-content-name-mismatch.js | failureTitle": [
        "audits[label-content-name-mismatch].title"
      ],
      "core/audits/accessibility/label-content-name-mismatch.js | description": [
        "audits[label-content-name-mismatch].description"
      ],
      "core/audits/accessibility/label.js | title": [
        "audits.label.title"
      ],
      "core/audits/accessibility/label.js | description": [
        "audits.label.description"
      ],
      "core/audits/accessibility/landmark-one-main.js | title": [
        "audits[landmark-one-main].title"
      ],
      "core/audits/accessibility/landmark-one-main.js | description": [
        "audits[landmark-one-main].description"
      ],
      "core/audits/accessibility/link-name.js | title": [
        "audits[link-name].title"
      ],
      "core/audits/accessibility/link-name.js | description": [
        "audits[link-name].description"
      ],
      "core/audits/accessibility/link-in-text-block.js | title": [
        "audits[link-in-text-block].title"
      ],
      "core/audits/accessibility/link-in-text-block.js | description": [
        "audits[link-in-text-block].description"
      ],
      "core/audits/accessibility/list.js | title": [
        "audits.list.title"
      ],
      "core/audits/accessibility/list.js | description": [
        "audits.list.description"
      ],
      "core/audits/accessibility/listitem.js | title": [
        "audits.listitem.title"
      ],
      "core/audits/accessibility/listitem.js | description": [
        "audits.listitem.description"
      ],
      "core/audits/accessibility/meta-refresh.js | title": [
        "audits[meta-refresh].title"
      ],
      "core/audits/accessibility/meta-refresh.js | description": [
        "audits[meta-refresh].description"
      ],
      "core/audits/accessibility/meta-viewport.js | failureTitle": [
        "audits[meta-viewport].title"
      ],
      "core/audits/accessibility/meta-viewport.js | description": [
        "audits[meta-viewport].description"
      ],
      "core/audits/accessibility/object-alt.js | title": [
        "audits[object-alt].title"
      ],
      "core/audits/accessibility/object-alt.js | description": [
        "audits[object-alt].description"
      ],
      "core/audits/accessibility/select-name.js | title": [
        "audits[select-name].title"
      ],
      "core/audits/accessibility/select-name.js | description": [
        "audits[select-name].description"
      ],
      "core/audits/accessibility/skip-link.js | title": [
        "audits[skip-link].title"
      ],
      "core/audits/accessibility/skip-link.js | description": [
        "audits[skip-link].description"
      ],
      "core/audits/accessibility/tabindex.js | title": [
        "audits.tabindex.title"
      ],
      "core/audits/accessibility/tabindex.js | description": [
        "audits.tabindex.description"
      ],
      "core/audits/accessibility/table-duplicate-name.js | title": [
        "audits[table-duplicate-name].title"
      ],
      "core/audits/accessibility/table-duplicate-name.js | description": [
        "audits[table-duplicate-name].description"
      ],
      "core/audits/accessibility/table-fake-caption.js | title": [
        "audits[table-fake-caption].title"
      ],
      "core/audits/accessibility/table-fake-caption.js | description": [
        "audits[table-fake-caption].description"
      ],
      "core/audits/accessibility/target-size.js | title": [
        "audits[target-size].title"
      ],
      "core/audits/accessibility/target-size.js | description": [
        "audits[target-size].description"
      ],
      "core/audits/accessibility/td-has-header.js | title": [
        "audits[td-has-header].title"
      ],
      "core/audits/accessibility/td-has-header.js | description": [
        "audits[td-has-header].description"
      ],
      "core/audits/accessibility/td-headers-attr.js | title": [
        "audits[td-headers-attr].title"
      ],
      "core/audits/accessibility/td-headers-attr.js | description": [
        "audits[td-headers-attr].description"
      ],
      "core/audits/accessibility/th-has-data-cells.js | title": [
        "audits[th-has-data-cells].title"
      ],
      "core/audits/accessibility/th-has-data-cells.js | description": [
        "audits[th-has-data-cells].description"
      ],
      "core/audits/accessibility/valid-lang.js | title": [
        "audits[valid-lang].title"
      ],
      "core/audits/accessibility/valid-lang.js | description": [
        "audits[valid-lang].description"
      ],
      "core/audits/accessibility/video-caption.js | title": [
        "audits[video-caption].title"
      ],
      "core/audits/accessibility/video-caption.js | description": [
        "audits[video-caption].description"
      ],
      "core/config/default-config.js | a11yCategoryTitle": [
        "categories.accessibility.title"
      ],
      "core/config/default-config.js | a11yCategoryDescription": [
        "categories.accessibility.description"
      ],
      "core/config/default-config.js | a11yCategoryManualDescription": [
        "categories.accessibility.manualDescription"
      ],
      "core/config/default-config.js | metricGroupTitle": [
        "categoryGroups.metrics.title"
      ],
      "core/config/default-config.js | diagnosticsGroupTitle": [
        "categoryGroups.diagnostics.title"
      ],
      "core/config/default-config.js | diagnosticsGroupDescription": [
        "categoryGroups.diagnostics.description"
      ],
      "core/config/default-config.js | a11yBestPracticesGroupTitle": [
        "categoryGroups[a11y-best-practices].title"
      ],
      "core/config/default-config.js | a11yBestPracticesGroupDescription": [
        "categoryGroups[a11y-best-practices].description"
      ],
      "core/config/default-config.js | a11yColorContrastGroupTitle": [
        "categoryGroups[a11y-color-contrast].title"
      ],
      "core/config/default-config.js | a11yColorContrastGroupDescription": [
        "categoryGroups[a11y-color-contrast].description"
      ],
      "core/config/default-config.js | a11yNamesLabelsGroupTitle": [
        "categoryGroups[a11y-names-labels].title"
      ],
      "core/config/default-config.js | a11yNamesLabelsGroupDescription": [
        "categoryGroups[a11y-names-labels].description"
      ],
      "core/config/default-config.js | a11yNavigationGroupTitle": [
        "categoryGroups[a11y-navigation].title"
      ],
      "core/config/default-config.js | a11yNavigationGroupDescription": [
        "categoryGroups[a11y-navigation].description"
      ],
      "core/config/default-config.js | a11yAriaGroupTitle": [
        "categoryGroups[a11y-aria].title"
      ],
      "core/config/default-config.js | a11yAriaGroupDescription": [
        "categoryGroups[a11y-aria].description"
      ],
      "core/config/default-config.js | a11yLanguageGroupTitle": [
        "categoryGroups[a11y-language].title"
      ],
      "core/config/default-config.js | a11yLanguageGroupDescription": [
        "categoryGroups[a11y-language].description"
      ],
      "core/config/default-config.js | a11yAudioVideoGroupTitle": [
        "categoryGroups[a11y-audio-video].title"
      ],
      "core/config/default-config.js | a11yAudioVideoGroupDescription": [
        "categoryGroups[a11y-audio-video].description"
      ],
      "core/config/default-config.js | a11yTablesListsVideoGroupTitle": [
        "categoryGroups[a11y-tables-lists].title"
      ],
      "core/config/default-config.js | a11yTablesListsVideoGroupDescription": [
        "categoryGroups[a11y-tables-lists].description"
      ],
      "core/config/default-config.js | seoMobileGroupTitle": [
        "categoryGroups[seo-mobile].title"
      ],
      "core/config/default-config.js | seoMobileGroupDescription": [
        "categoryGroups[seo-mobile].description"
      ],
      "core/config/default-config.js | seoContentGroupTitle": [
        "categoryGroups[seo-content].title"
      ],
      "core/config/default-config.js | seoContentGroupDescription": [
        "categoryGroups[seo-content].description"
      ],
      "core/config/default-config.js | seoCrawlingGroupTitle": [
        "categoryGroups[seo-crawl].title"
      ],
      "core/config/default-config.js | seoCrawlingGroupDescription": [
        "categoryGroups[seo-crawl].description"
      ],
      "core/config/default-config.js | bestPracticesTrustSafetyGroupTitle": [
        "categoryGroups[best-practices-trust-safety].title"
      ],
      "core/config/default-config.js | bestPracticesUXGroupTitle": [
        "categoryGroups[best-practices-ux].title"
      ],
      "core/config/default-config.js | bestPracticesBrowserCompatGroupTitle": [
        "categoryGroups[best-practices-browser-compat].title"
      ],
      "core/config/default-config.js | bestPracticesGeneralGroupTitle": [
        "categoryGroups[best-practices-general].title"
      ]
    }
  }
}

================
File: tests/setup.ts
================
import '@testing-library/jest-dom';

================
File: tests/utils/mockData.ts
================
import { Value } from "@/lib/types";

let currentMockId = 1;

export const createMockValue = (overrides?: Partial<Value>): Value => {
  // Ensure ID stays within 1-35 range, cycling back to 1 if exceeded
  const id = String(overrides?.id ?? currentMockId); // Convert to string
  currentMockId = (currentMockId % 35) + 1;

  return {
    title: 'Mock Title',
    description: 'Mock Description',
    ...overrides,
    // Ensure id stays within valid range even if provided in overrides
    id: typeof overrides?.id === 'number'
    ? String(Math.max(1, Math.min(35, overrides.id))) // Convert to string
    : id
  };
};

// Reset the mock ID counter (useful between test suites)
export const resetMockIdCounter = () => {
  currentMockId = 1;
};

================
File: tsconfig.json
================
{
  "compilerOptions": {
    "target": "es5",
    "lib": [
      "dom",
      "dom.iterable",
      "esnext",
      "webworker"
    ],
    "noImplicitAny" : true,
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "baseUrl": ".",
    "paths": {
      "@/*": [
        "./src/*"
      ],
      "@/components/*": [
        "./src/components/*"
      ],
      "@/features/*": [
        "./src/components/features/*"
      ],
      "@/common/*": [
        "./src/components/common/*"
      ],
      "@/lib/*": [
        "./src/lib/*"
      ],
      "@/styles/*": [
        "./src/styles/*"
      ],
      "@/assets/*": [
        "./src/assets/*"
      ]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts"
  ],
  "exclude": [
    "node_modules"
  ]
}
